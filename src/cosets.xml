<?xml version="1.0"?>
<!-- This file is part of the book                    -->
<!--                                                  -->
<!-- Abstract Algebra: Theory and Applications        -->
<!--                                                  -->
<!-- Text: Copyright (C) 1997-2024  Thomas W. Judson  -->
<!-- Sage: Copyright (C) 2010-2024  Robert A. Beezer  -->
<!-- See the file COPYING for copying conditions.     -->
<!-- This file is part of the book                    -->
<!--                                                  -->
<!-- See the file COPYING for copying conditions.     -->
<chapter xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="cosets">
  <title>Cosets and Lagrange's Theorem</title>
  <introduction>
    <p>
      Lagrange's Theorem,
      one of the most important results in finite group theory,
      states that the order of a subgroup must divide the order of the group.
      This theorem provides a powerful tool for analyzing finite groups;
      it gives us an idea of exactly what type of subgroups we might expect a finite group to possess.
      Central to understanding Lagranges's Theorem is the notion of a coset.
    </p>
  </introduction>

  <section xml:id="cosets-section-cosets">
    <title>Cosets</title>
    <p>
      Let <m>G</m> be a group and <m>H</m> a subgroup of <m>G</m>.
      Define a <term>left coset</term><idx><h>Coset</h><h>left</h></idx>
      of <m>H</m> with <term>representative</term><idx><h>Coset</h><h>representative</h></idx> <m>g \in G</m> to be the set
      <me>
        gH = \{ gh : h \in H \}
      </me>.
      <term>Right cosets</term><idx><h>Coset</h><h>right</h></idx>
      can be defined similarly by
      <me>
        Hg = \{ hg : h \in H \}
      </me>.
      If left and right cosets coincide or if it is clear from the context to which type of coset that we are referring,
      we will use the word <em>coset</em>
      without specifying left or right.
    </p>

    <example xml:id="cosets-example-z6-cosets">
      <p>
        Let <m>H</m> be the subgroup of
        <m>{\mathbb Z}_6</m> consisting of the elements <m>0</m> and <m>3</m>.
        The cosets are
        <md>
          <mrow>0 + H = 3 + H = \{ 0, 3 \}</mrow>
          <mrow>1 + H = 4 + H = \{ 1, 4 \}</mrow>
          <mrow>2 + H = 5 + H = \{ 2, 5 \}</mrow>
        </md>.
        We will always write the cosets of subgroups of <m>{\mathbb Z}</m> and
        <m>{\mathbb Z}_n</m> with the additive notation we have used for cosets here.
        In a commutative group, left and right cosets are always identical.
      </p>
    </example>

    <example xml:id="cosets-example-s3-cosets">
      <p>
        Let <m>H</m> be the subgroup of <m>S_3</m> defined by the permutations <m>\{(1), (1 \, 2 \, 3), (1 \, 3 \, 2) \}</m>.
        The left cosets of <m>H</m> are
        <md>
          <mrow>(1)H = (1 \,  2 \,  3)H =  (1 \, 3 \, 2)H = \{(1), (1 \,  2 \, 3), (1 \, 3 \, 2) \}</mrow>
          <mrow>(1 \,  2)H = (1 \,  3)H = (2 \,  3)H =  \{ (1 \,  2), (1 \,  3), (2 \,  3)  \}</mrow>
        </md>.
        The right cosets of <m>H</m> are exactly the same as the left cosets:
        <md>
          <mrow>H(1) = H(1 \,  2 \,  3) =  H(1 \, 3 \, 2) = \{(1), (1 \,  2 \, 3), (1 \, 3 \, 2) \}</mrow>
          <mrow>H(1 \, 2) = H(1 \,  3) = H(2 \,  3) =  \{ (1 \,  2), (1 \,  3), (2 \,  3)  \}</mrow>
        </md>.
      </p>

      <p>
        It is not always the case that a left coset is the same as a right coset.
        Let <m>K</m> be the subgroup of <m>S_3</m> defined by the permutations <m>\{(1), (1 \,  2)\}</m>.
        Then the left cosets of <m>K</m> are
        <md>
          <mrow>(1)K = (1 \,  2)K = \{(1), (1 \,  2)\}</mrow>
          <mrow>(1 \,  3)K = (1 \,  2 \,  3)K = \{(1 \,  3), (1 \,  2  \, 3)\}</mrow>
          <mrow>(2  \, 3)K = (1 \,  3 \,  2)K = \{(2 \,  3), (1 \,  3  \, 2)\};</mrow>
        </md>
        however, the right cosets of <m>K</m> are
        <md>
          <mrow>K(1) = K(1  \, 2) = \{(1), (1 \,  2)\}</mrow>
          <mrow>K(1 \,  3) = K(1 \,  3 \,  2) = \{(1 \,  3), (1 \,  3  \, 2)\}</mrow>
          <mrow>K(2 \,  3) = K(1 \, 2  \, 3) = \{(2 \,  3), (1 \,  2 \,  3)\}</mrow>
        </md>.
      </p>
    </example>

    <p>
      The following lemma is quite useful when dealing with cosets.
      (We leave its proof as an exercise.)
    </p>

    <lemma xml:id="cosets-lemma-theorem-1">
      <statement>
        <p>
          Let <m>H</m> be a subgroup of a group <m>G</m> and suppose that <m>g_1, g_2 \in G</m>.
          The following conditions are equivalent.

          <ol>
            <li>
              <p>
                <m>g_1 H = g_2 H</m>;
              </p>
            </li>

            <li>
              <p>
                <m>H g_1^{-1} = H g_2^{-1}</m>;
              </p>
            </li>

            <li>
              <p>
                <m>g_1 H \subset g_2 H</m>;
              </p>
            </li>

            <li>
              <p>
                <m>g_2 \in g_1 H</m>;
              </p>
            </li>

            <li>
              <p>
                <m>g_1^{-1} g_2 \in H</m>.
              </p>
            </li>
          </ol>
        </p>
      </statement>
    </lemma>

    <p>
      In all of our examples the cosets of a subgroup <m>H</m> partition the larger group <m>G</m>.
      The following theorem proclaims that this will always be the case.
    </p>

    <theorem xml:id="cosets-theorem-theorem-2">
      <statement>
        <p>
          Let <m>H</m> be a subgroup of a group <m>G</m>.
          Then the left cosets of <m>H</m> in <m>G</m> partition <m>G</m>.
          That is, the group <m>G</m> is the disjoint union of the left cosets of <m>H</m> in <m>G</m>.
        </p>
      </statement>

      <proof>
        <p>
          Let <m>g_1 H</m> and <m>g_2 H</m> be two cosets of <m>H</m> in <m>G</m>.
          We must show that either <m>g_1 H \cap g_2 H = \emptyset</m> or <m>g_1 H = g_2 H</m>.
          Suppose that <m>g_1 H \cap g_2 H \neq \emptyset</m> and <m>a \in g_1 H \cap g_2 H</m>.
          Then by the definition of a left coset,
          <m>a = g_1 h_1 = g_2 h_2</m> for some elements <m>h_1</m> and <m>h_2</m> in <m>H</m>.
          Hence, <m>g_1 = g_2 h_2 h_1^{-1}</m> or <m>g_1 \in g_2 H</m>.
          By <xref ref="cosets-lemma-theorem-1"/>, <m>g_1 H = g_2 H</m>.
        </p>
      </proof>
    </theorem>

    <remark>
      <p>
        There is nothing special in this theorem about left cosets.
        Right cosets also partition <m>G</m>;
        the proof of this fact is exactly the same as the proof for left cosets except that all group multiplications are done on the opposite side of <m>H</m>.
      </p>
    </remark>

    <p>
      Let <m>G</m> be a group and <m>H</m> be a subgroup of <m>G</m>.
      Define the <term>index</term><idx><h>Index of a subgroup</h></idx><idx><h>Subgroup</h><h>index of</h></idx>
      of <m>H</m> in <m>G</m> to be the number of left cosets of <m>H</m> in <m>G</m>.
      We will denote the index by <m>[G:H]</m>.

      <notation>
        <usage><m>[G:H]</m></usage>
        <description>index of a subgroup <m>H</m> in a group <m>G</m></description>
      </notation>

    </p>

    <example xml:id="cosets-example-z6-index">
      <p>
        Let <m>G= {\mathbb Z}_6</m> and <m>H = \{ 0, 3 \}</m>.
        Then <m>[G:H] = 3</m>.
      </p>
    </example>

    <example xml:id="cosets-example-s3-index">
      <p>
        Suppose that <m>G= S_3</m>,
        <m>H = \{ (1),(1 \, 2 \, 3), (1 \, 3 \, 2) \}</m>,
        and <m>K= \{ (1), (1 \, 2) \}</m>.
        Then <m>[G:H] = 2</m> and <m>[G:K] = 3</m>.
      </p>
    </example>

    <theorem xml:id="cosets-theorem-theorem-3">
      <statement>
        <p>
          Let <m>H</m> be a subgroup of a group <m>G</m>.
          The number of left cosets of <m>H</m> in <m>G</m> is the same as the number of right cosets of <m>H</m> in <m>G</m>.
        </p>
      </statement>

      <proof>
        <p>
          Let <m>{\mathcal L}_H</m> and
          <m>{\mathcal R}_H</m> denote the set of left and right cosets of <m>H</m> in <m>G</m>,
          respectively.

          <notation>
            <usage><m>\mathcal L_H</m></usage>
            <description>the set of left cosets of a subgroup <m>H</m> in a group <m>G</m></description>
          </notation>

          <notation>
            <usage><m>\mathcal R_H</m></usage>
            <description>the set of right cosets of a subgroup <m>H</m> in a group <m>G</m></description>
          </notation>

          If we can define a bijective map <m>\phi : {\mathcal L}_H \rightarrow {\mathcal R}_H</m>,
          then the theorem will be proved.
          If <m>gH \in {\mathcal L}_H</m>,
          let <m>\phi( gH ) = Hg^{-1}</m>.
          By <xref ref="cosets-lemma-theorem-1"/>, the map <m>\phi</m> is well-defined;
          that is, if <m>g_1 H = g_2 H</m>,
          then <m>H g_1^{-1} = H g_2^{-1}</m>.
          To show that <m>\phi</m> is one-to-one, suppose that
          <me>
            H g_1^{-1} = \phi( g_1 H ) = \phi( g_2 H ) = H g_2^{-1}
          </me>.
          Again by <xref ref="cosets-lemma-theorem-1"/>, <m>g_1 H = g_2 H</m>.
          The map <m>\phi</m> is onto since <m>\phi(g^{-1} H ) = H g</m>.
        </p>
      </proof>
    </theorem>
  </section>

  <section xml:id="cosets-section-lagranges-theorem">
    <title>Lagrange's Theorem</title>
    <proposition xml:id="cosets-theorem-4">
      <statement>
        <p>
          Let <m>H</m> be a subgroup of <m>G</m> with <m>g \in G</m> and define a map
          <m>\phi:H \rightarrow gH</m> by <m>\phi(h) = gh</m>.
          The map <m>\phi</m> is bijective;
          hence, the number of elements in <m>H</m> is the same as the number of elements in <m>gH</m>.
        </p>
      </statement>

      <proof>
        <p>
          We first show that the map <m>\phi</m> is one-to-one.
          Suppose that <m>\phi(h_1) = \phi(h_2)</m> for elements <m>h_1, h_2 \in H</m>.
          We must show that <m>h_1 = h_2</m>,
          but <m>\phi(h_1) = gh_1</m> and <m>\phi(h_2) = gh_2</m>.
          So <m>gh_1 = gh_2</m>, and by left cancellation <m>h_1= h_2</m>.
          To show that <m>\phi</m> is onto is easy.
          By definition every element of <m>gH</m> is of the form <m>gh</m> for some <m>h \in H</m> and <m>\phi(h) = gh</m>.
        </p>
      </proof>
    </proposition>

    <theorem xml:id="cosets-theorem-lagrange">
      <title>Lagrange</title>
      <idx>
      <h>Lagrange's Theorem</h>
      </idx>
      <statement>
        <p>
          Let <m>G</m> be a finite group and let <m>H</m> be a subgroup of <m>G</m>.
          Then <m>|G|/|H| = [G : H]</m> is the number of distinct left cosets of <m>H</m> in <m>G</m>.
          In particular,
          the number of elements in <m>H</m> must divide the number of elements in <m>G</m>.
        </p>
      </statement>

      <proof>
        <p>
          The group <m>G</m> is partitioned into <m>[G : H]</m> distinct left cosets.
          Each left coset has <m>|H|</m> elements;
          therefore, <m>|G| = [G : H] |H|</m>.
        </p>
      </proof>
    </theorem>

    <corollary xml:id="cosets-corollary-theorem-6">
      <statement>
        <p>
          Suppose that <m>G</m> is a finite group and <m>g \in G</m>.
          Then the order of <m>g</m> must divide the number of elements in <m>G</m>.
        </p>
      </statement>
    </corollary>

    <corollary xml:id="cosets-corollary-theorem-7">
      <statement>
        <p>
          Let <m>|G| = p</m> with <m>p</m> a prime number.
          Then <m>G</m> is cyclic and any <m>g \in G</m> such that <m>g \neq e</m> is a generator.
        </p>
      </statement>

      <proof>
        <p>
          Let <m>g</m> be in <m>G</m> such that <m>g \neq e</m>.
          Then by <xref ref="cosets-corollary-theorem-6"/>,
          the order of <m>g</m> must divide the order of the group.
          Since <m>|\langle g \rangle| \gt 1</m>, it must be <m>p</m>.
          Hence, <m>g</m> generates <m>G</m>.
        </p>
      </proof>
    </corollary>

    <p>
      <xref ref="cosets-corollary-theorem-7"/> suggests that groups of prime order <m>p</m> must somehow look like <m>{\mathbb Z}_p</m>.
    </p>

    <corollary xml:id="cosets-corollary-theorem-8">
      <statement>
        <p>
          Let <m>H</m> and <m>K</m> be subgroups of a finite group <m>G</m> such that <m>G \supset H \supset K</m>.
          Then
          <me>
            [G:K] = [G:H][H:K]
          </me>.
        </p>
      </statement>

      <proof>
        <p>
          Observe that
          <me>
            [G:K] = \frac{|G|}{|K|} = \frac{|G|}{|H|} \cdot \frac{|H|}{|K|} = [G:H][H:K]
          </me>.
        </p>
      </proof>
    </corollary>

    <remark>
      <title>The converse of Lagrange's Theorem is false</title>
      <p>
        The group <m>A_4</m> has order <m>12</m>;
        however, it can be shown that it does not possess a subgroup of order <m>6</m>.
        According to Lagrange's Theorem,
        subgroups of a group of order <m>12</m> can have orders of either <m>1</m>,
        <m>2</m>,
        <m>3</m>, <m>4</m>, or <m>6</m>.
        However, we are not guaranteed that subgroups of every possible order exist.
        To prove that <m>A_4</m> has no subgroup of order <m>6</m>,
        we will assume that it does have such a subgroup <m>H</m> and show that a contradiction must occur.
        Since <m>A_4</m> contains eight <m>3</m>-cycles,
        we know that <m>H</m> must contain a <m>3</m>-cycle.
        We will show that if <m>H</m> contains one <m>3</m>-cycle,
        then it must contain more than <m>6</m> elements.
      </p>
    </remark>
        <!-- % TWJ, 2011/11/20 -->
        <!-- % Fixed the proof that <m>A_4</m> contains no subgroup of order 6.  This mistake was -->
        <!-- % pointed out by Z. Teitler. -->
    <proposition xml:id="cosets-proposition-theorem-10">
      <statement>
        <p>
          The group <m>A_4</m> has no subgroup of order <m>6</m>.
        </p>
      </statement>

      <proof>
        <p>
          Since <m>[A_4 : H] = 2</m>,
          there are only two cosets of <m>H</m> in <m>A_4</m>.
          Inasmuch as one of the cosets is <m>H</m> itself,
          right and left cosets must coincide;
          therefore, <m>gH = Hg</m> or
          <m>g H g^{-1} = H</m> for every <m>g \in A_4</m>.
          Since there are eight <m>3</m>-cycles in <m>A_4</m>,
          at least one <m>3</m>-cycle must be in <m>H</m>.
          Without loss of generality, assume that <m>(1 \, 2 \, 3)</m> is in <m>H</m>.
          Then <m>(1 \, 2 \, 3)^{-1} = (1 \, 3 \, 2)</m> must also be in <m>H</m>.
          Since <m>g h g^{-1} \in H</m> for all
          <m>g \in A_4</m> and all <m>h \in H</m> and
          <md>
            <mrow>(1 \, 2 \, 4)(1 \, 2 \, 3)(1 \, 2 \, 4)^{-1} &amp; = (1 \, 2 \, 4)(1 \, 2 \, 3)(1 \, 4 \, 2)  = (2 \, 4 \, 3)</mrow>
            <mrow>(2 \, 4 \, 3)(1 \, 2 \, 3)(2 \, 4 \, 3)^{-1} &amp; = (2 \, 4 \, 3)(1 \, 2 \, 3)(2 \, 3 \, 4)  = (1 \, 4 \, 2)</mrow>
          </md>
          we can conclude that <m>H</m> must have at least seven elements
          <me>
            (1), (1 \, 2 \, 3), (1 \, 3 \, 2), (2 \, 4 \, 3), (2 \, 4 \, 3)^{-1} = (2 \, 3 \, 4), (1 \, 4 \, 2), (1 \, 4 \, 2)^{-1} = (1 \, 2 \, 4)
          </me>.
          Therefore, <m>A_4</m> has no subgroup of order <m>6</m>.
        </p>
      </proof>
    </proposition>

    <p>
      In fact, we can say more about when two cycles have the same length.
    </p>

    <theorem xml:id="cosets-theorem-cycle-length-theorem">
      <statement>
        <p>
          Two cycles <m>\tau</m> and <m>\mu</m> in <m>S_n</m> have the same length if and only if there exists a
          <m>\sigma \in S_n</m> such that <m>\mu = \sigma \tau \sigma^{-1}</m>.
        </p>
      </statement>

      <proof>
        <p>
          Suppose that
          <md>
            <mrow>\tau &amp; = (a_1, a_2, \ldots, a_k )</mrow>
            <mrow>\mu  &amp; = (b_1, b_2, \ldots, b_k )</mrow>
          </md>.
          Define <m>\sigma</m> to be the permutation
          <md>
            <mrow>\sigma( a_1 ) &amp; = b_1</mrow>
            <mrow>\sigma( a_2 ) &amp; = b_2</mrow>
            <mrow>&amp; \vdots</mrow>
            <mrow>\sigma( a_k ) &amp; = b_k</mrow>
          </md>.
          Then <m>\mu = \sigma \tau \sigma^{-1}</m>.
        </p>

        <p>
          Conversely, suppose that <m>\tau = (a_1, a_2, \ldots,
          a_k )</m> is a <m>k</m>-cycle and <m>\sigma \in S_n</m>.
          If <m>\sigma( a_i ) = b</m> and
          <m>\sigma( a_{(i \bmod k) + 1}) = b'</m>, then <m>\mu( b) = b'</m>.
          Hence,
          <me>
            \mu = ( \sigma(a_1), \sigma(a_2), \ldots, \sigma(a_k) )
          </me>.
          Since <m>\sigma</m> is one-to-one and onto,
          <m>\mu</m> is a cycle of the same length as <m>\tau</m>.
        </p>
      </proof>
    </theorem>
  </section>

  <section xml:id="cosets-section-fermat-euler">
    <title>Fermat's and Euler's Theorems</title>
    <introduction>
      <p>
        The <term>Euler</term> <m>\phi</m>-<term>function</term><idx><h>Euler <m>\phi</m>-function</h></idx> is the map <m>\phi : {\mathbb N } \rightarrow {\mathbb N}</m> defined by
        <m>\phi(n) = 1</m> for <m>n=1</m>, and, for <m>n \gt 1</m>,
        <m>\phi(n)</m> is the number of positive integers <m>m</m> with
        <m>1 \leq m \lt n</m> and <m>\gcd(m,n) = 1</m>.
      </p>

      <p>
        From <xref ref="groups-proposition-zn-equiv-classes"/>, we know that the order of <m>U(n)</m>,
        the group of units in <m>{\mathbb Z}_n</m>, is <m>\phi(n)</m>.
        For example,
        <m>|U(12)| = \phi(12) = 4</m> since the numbers that are relatively prime to 12 are 1, 5, 7, and 11.
        For any prime <m>p</m>, <m>\phi(p) = p-1</m>.
        We state these results in the following theorem.
      </p>

      <theorem xml:id="cosets-theorem-theorem-11">
        <statement>
          <p>
            Let <m>U(n)</m> be the group of units in <m>{\mathbb Z}_n</m>.
            Then <m>|U(n)| = \phi(n)</m>.
          </p>
        </statement>
      </theorem>

      <p>
        The following theorem is an important result in number theory,
        due to Leonhard Euler.
      </p>

      <theorem xml:id="cosets-theorem-eulers_theorem">
        <title>Euler's Theorem</title>
        <statement>
          <p>
            Let <m>a</m> and <m>n</m> be integers such that <m>n \gt 0</m> and <m>\gcd(a, n) = 1</m>.
            Then <m>a^{\phi(n)} \equiv 1 \pmod{n}</m>.
          </p>
        </statement>

        <proof>
          <p>
            By <xref ref="cosets-theorem-theorem-11"/> the order of <m>U(n)</m> is <m>\phi(n)</m>.
            Consequently, <m>a^{\phi(n)} = 1</m> for all <m>a \in U(n)</m>;
            or <m>a^{\phi(n)} - 1</m> is divisible by <m>n</m>.
            Therefore, <m>a^{\phi(n)} \equiv 1 \pmod{n}</m>.
          </p>
        </proof>
      </theorem>

      <p>
        If we consider the special case of Euler's Theorem in which <m>n = p</m> is prime and recall that <m>\phi(p) = p - 1</m>,
        we obtain the following result, due to <idx><h>Fermat, Pierre de</h></idx>Pierre de Fermat.  
      </p>

      <theorem xml:id="cosets-theorem-theorem-13">
        <title>Fermat's Little Theorem</title>
        <idx>
        <h>Fermat's Little Theorem</h>
        </idx>
        <statement>
          <p>
            Let <m>p</m> be any prime number and suppose that <m>p \notdivide a</m>
            (<m>p</m> does not divide <m>a</m>).

            <notation>
              <usage><m>a \notdivide b</m></usage>
              <description><m>a</m> does not divide <m>b</m></description>
            </notation>

            Then
            <me>
              a^{p-1} \equiv 1 \pmod{ p }
            </me>.
            Furthermore, for any integer <m>b</m>,
            <m>b^p \equiv b \pmod{ p}</m>.
          </p>
        </statement>
      </theorem>
      <paragraphs component="sage-blurb">
        <title>Sage</title>
        <p>
          Sage can create all the subgroups of a group,
          so long as the group is not too large.
          It can also create the cosets of a subgroup.
        </p>
      </paragraphs>

    </introduction>

    <subsection xml:id="cosets-subsection-historical-note">
      <title>Historical Note</title>
      <p>
        Joseph-Louis Lagrange<idx><h>Lagrange, Joseph-Louis</h></idx>
        (1736<ndash/>1813), born in Turin, Italy,
        was of French and Italian descent.
        His talent for mathematics became apparent at an early age.
        Leonhard Euler<idx><h>Euler, Leonhard</h></idx>
        recognized Lagrange's abilities when Lagrange, who was only 19,
        communicated to Euler some work that he had done in the calculus of variations.
        That year he was also named a professor at the Royal Artillery School in Turin.
        At the age of 23 he joined the Berlin Academy.
        Frederick the Great had written to Lagrange proclaiming that the
        <q>greatest king in Europe</q>
        should have the <q>greatest mathematician in Europe</q> at his court.
        For 20 years Lagrange held the position vacated by his mentor, Euler.
        His works include contributions to number theory,
        group theory, physics and mechanics,
        the calculus of variations,
        the theory of equations, and differential equations.
        Along with Laplace and Lavoisier, Lagrange was one of the people responsible for designing the metric system.
        During his life Lagrange profoundly influenced the development of mathematics,
        leaving much to the next generation of mathematicians in the form of examples and new problems to be solved.
      </p>
    </subsection>
  </section>

    <reading-questions>

    <exercise>
      <statement>
        <p>
          State Lagrange's Theorem in your own words.
        </p>
      </statement>
      <response/>
    </exercise>

    <exercise>
      <statement>
        <p>
          Determine the left cosets of
          <m>\langle 3 \rangle</m> in <m>\mathbb Z_9</m>.
        </p>
      </statement>
      <response/>
    </exercise>

    <exercise>
      <statement>
        <p>
          The set <m>\{(), (1\,2)(3\,4), (1\,3)(2\,4), (1\,4)(2\,3)\}</m> is a subgroup of <m>S_4</m>.
          What is its index in <m>S_4</m>?
        </p>
      </statement>
      <response/>
    </exercise>

    <exercise>
      <statement>
        <p>
          Suppose <m>G</m> is a group of order 29.
          Describe <m>G</m>.
        </p>
      </statement>
      <response/>
    </exercise>

    <exercise>
      <statement>
        <p>
          The number <m>p=137909</m> is prime.
          Explain how to compute <m>57^{137909}\pmod{137909}</m> without a calculator.
        </p>
      </statement>
      <response/>
    </exercise>

  </reading-questions>
    <!-- Exercises with Solutions  -->
    <!-- File: cosets.xml  -->
    <!-- Title: Cosets and Lagrange's Theorem -->
  <exercises xml:id="cosets-exercises" filenamebase="cosets">
    <title>Exercises</title>

    <exercise number="1" xml:id="cosets-exercise-order-35">
      <statement>
        <p>
          Suppose that <m>G</m> is a finite group with an element <m>g</m> of order <m>5</m> and an element <m>h</m> of order <m>7</m>.
          Why must <m>|G| \geq 35</m>?
        </p>
      </statement>
      <hint>
        <p>
          The order of <m>g</m> and the order <m>h</m> must both divide the order of <m>G</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="2" xml:id="cosets-exercise-order-60">
      <statement>
        <p>
          Suppose that <m>G</m> is a finite group with <m>60</m> elements.
          What are the orders of possible subgroups of <m>G</m>?
        </p>
      </statement>
      <hint>
        <p>
          The possible orders must divide <m>60</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="3" xml:id="cosets-exercise-integers-finite-index">
      <statement>
        <p>
          Prove or disprove: Every subgroup of the integers has finite index.
        </p>
      </statement>
      <hint>
        <p>
          This is true for every proper nontrivial subgroup.
        </p>
      </hint>
    </exercise>

    <exercise number="4" xml:id="cosets-exercise-integers-finite-order">
      <statement>
        <p>
          Prove or disprove: Every subgroup of the integers has finite order.
        </p>
      </statement>
      <hint>
        <p>
          False.
        </p>
      </hint>
    </exercise>

    <exercise number="5" xml:id="cosets-exercise-left-and-right-cosets">
      <statement>
        <p>
          List the left and right cosets of the subgroups in each of the following.

          <ol cols="2">
            <li>
              <p>
                <m>\langle 8 \rangle</m> in <m>{\mathbb Z}_{24}</m>
              </p>
            </li>

            <li>
              <p>
                <m>\langle 3 \rangle</m> in <m>U(8)</m>
              </p>
            </li>

            <li>
              <p>
                <m>3 {\mathbb Z}</m> in <m>{\mathbb Z}</m>
              </p>
            </li>

            <li>
              <p>
                <m>A_4</m> in <m>S_4</m>
              </p>
            </li>

            <li>
              <p>
                <m>A_n</m> in <m>S_n</m>
              </p>
            </li>

            <li>
              <p>
                <m>D_4</m> in <m>S_4</m>
              </p>
            </li>

            <li>
              <p>
                <m>{\mathbb T}</m> in <m>{\mathbb C}^\ast</m>
              </p>
            </li>

            <li>
              <p>
                <m>H = \{ (1), (1 \, 2 \, 3), (1 \, 3 \, 2) \}</m> in <m>S_4</m>
              </p>
            </li>
          </ol>
        </p>
      </statement>
      <hint>
        <p>
          (a) <m>\langle 8 \rangle</m>,
          <m>1 + \langle 8 \rangle</m>,
          <m>2 + \langle 8 \rangle</m>,
          <m>3 + \langle 8 \rangle</m>,
          <m>4 + \langle 8 \rangle</m>,
          <m>5 + \langle 8 \rangle</m>,
          <m>6 + \langle 8 \rangle</m>,
          and <m>7 + \langle 8 \rangle</m>; (c) <m>3 {\mathbb Z}</m>,
          <m>1 + 3 {\mathbb Z}</m>, and <m>2 + 3 {\mathbb Z}</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="6" xml:id="cosets-exercise-cosets-sl2">
      <statement>
        <p>
          Describe the left cosets of
          <m>SL_2( {\mathbb R} )</m> in <m>GL_2( {\mathbb R})</m>.
          What is the index of <m>SL_2( {\mathbb R} )</m> in <m>GL_2( {\mathbb R})</m>?
        </p>
      </statement>
    </exercise>

    <exercise number="7" xml:id="cosets-exercise-euler-n-15">
      <statement>
        <p>
          Verify Euler's Theorem for <m>n = 15</m> and <m>a = 4</m>.
        </p>
      </statement>
      <hint>
        <p>
          <m>4^{\phi(15)} \equiv 4^8 \equiv 1 \pmod{15}</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="8" xml:id="cosets-exercise-fermat-4n-plus-3">
      <statement>
        <p>
          Use Fermat's Little Theorem to show that if <m>p = 4n + 3</m> is prime,
          there is no solution to the equation <m>x^2 \equiv -1 \pmod{p}</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="9" xml:id="cosets-exercise-Z-infinite-in-Q">
      <statement>
        <p>
          Show that the integers have infinite index in the additive group of rational numbers.
        </p>
      </statement>
    </exercise>

    <exercise number="10" xml:id="cosets-exercise-R-in-C">
      <statement>
        <p>
          Show that the additive group of real numbers has infinite index in the additive group of the complex numbers.
        </p>
      </statement>
    </exercise>

    <exercise number="11" xml:id="cosets-exercise-equivalent-cosets">
      <statement>
        <p>
          Let <m>H</m> be a subgroup of a group <m>G</m> and suppose that <m>g_1, g_2 \in G</m>.
          Prove that the following conditions are equivalent.

          <ol>
            <li>
              <p>
                <m>g_1 H = g_2 H</m>
              </p>
            </li>

            <li>
              <p>
                <m>H g_1^{-1} = H g_2^{-1}</m>
              </p>
            </li>

            <li>
              <p>
                <m>g_1 H \subset g_2 H</m>
              </p>
            </li>

            <li>
              <p>
                <m>g_2 \in g_1 H</m>
              </p>
            </li>

            <li>
              <p>
                <m>g_1^{-1} g_2 \in H</m>
              </p>
            </li>
          </ol>
        </p>
      </statement>
    </exercise>

    <exercise number="12" xml:id="cosets-exercise-ghg-inverse-left-right-cosets">
      <statement>
        <p>
          If <m>ghg^{-1} \in H</m> for all <m>g \in G</m> and <m>h \in H</m>,
          show that right cosets are identical to left cosets.
          That is, show that <m>gH = Hg</m> for all <m>g \in G</m>.
        </p>
      </statement>
      <hint>
        <p>
          Let <m>g_1 \in gH</m>.
          Show that <m>g_1 \in Hg</m> and thus <m>gH \subset Hg</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="13" xml:id="cosets-exercise-counterexample-proof">
      <statement>
        <p>
          What fails in the proof of <xref ref="cosets-theorem-theorem-3"/> if
          <m>\phi : {\mathcal L}_H \rightarrow {\mathcal R}_H</m> is defined by <m>\phi( gH ) = Hg</m>?
        </p>
      </statement>
    </exercise>

    <exercise number="14" xml:id="cosets-exercise-order-g-divides-n">
      <statement>
        <p>
          Suppose that <m>g^n = e</m>.
          Show that the order of <m>g</m> divides <m>n</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="15" xml:id="cosets-exercise-cycle-structure">
      <statement>
        <p>
          The <term>cycle structure</term><idx><h>Permutation</h><h>cycle structure of</h></idx> of a permutation <m>\sigma</m> is defined as the unordered list of the sizes of the cycles in the cycle decomposition <m>\sigma</m>. For example, the permutation <m>\sigma = (1 \, 2)(3 \, 4 \, 5)(7 \, 8)(9)</m> has cycle structure <m>(2,3,2,1)</m> which can also be written as <m>(1, 2, 2, 3)</m>.
        </p>

        <p>
          Show that any two permutations
          <m>\alpha, \beta \in S_n</m> have the same cycle structure if and only if there exists a permutation <m>\gamma</m> such that <m>\beta = \gamma \alpha \gamma^{-1}</m>.
          If <m>\beta = \gamma \alpha \gamma^{-1}</m> for some <m>\gamma \in S_n</m>,
          then <m>\alpha</m> and <m>\beta</m> are <term>conjugate</term>.
        </p>
      </statement>
    </exercise>

    <exercise number="16" xml:id="cosets-exercise-elements-of-order-2">
      <statement>
        <p>
          If <m>|G| = 2n</m>,
          prove that the number of elements of order <m>2</m> is odd.
          Use this result to show that <m>G</m> must contain a subgroup of order 2.
        </p>
      </statement>
    </exercise>

    <exercise number="17" xml:id="cosets-exercise-index-2-ab-in-H">
      <statement>
        <p>
          Suppose that <m>[G : H] = 2</m>.
          If <m>a</m> and <m>b</m> are not in <m>H</m>,
          show that <m>ab \in H</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="18" xml:id="cosets-exercise-index-2-left-right-cosets">
      <statement>
        <p>
          If <m>[G : H] = 2</m>, prove that <m>gH = Hg</m> for all <m>g \in G</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="19" xml:id="cosets-exercise-coset-intersection">
      <statement>
        <p>
          Let <m>H</m> and <m>K</m> be subgroups of a group <m>G</m>.
          Prove that <m>gH \cap gK</m> is a coset of <m>H \cap K</m> in <m>G</m>.
        </p>
      </statement>
      <hint>
        <p>
          Show that <m>g(H \cap K) = gH \cap gK</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="20" xml:id="cosets-exercise-double-cosets">
      <statement>
        <p>
          Let <m>H</m> and <m>K</m> be subgroups of a group <m>G</m>.
          Define a relation <m>\sim</m> on <m>G</m> by
          <m>a \sim b</m> if there exists an <m>h \in H</m> and a <m>k \in K</m> such that <m>hak = b</m>.
          Show that this relation is an equivalence relation.
          The corresponding equivalence classes are called
          <term>double cosets</term>.
          Compute the double cosets of <m>H = \{ (1),(1 \, 2 \, 3), (1 \, 3 \, 2) \}</m> in <m>A_4</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="21" xml:id="cosets-exercise-number-generators-cyclic-group">
      <statement>
        <p>
          Let <m>G</m> be a cyclic group of order <m>n</m>.
          Show that there are exactly <m>\phi(n)</m> generators for <m>G</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="22" xml:id="cosets-exercise-euler-phi-formula">
      <statement>
        <p>
          Let <m>n = p_1^{e_1} p_2^{e_2} \cdots p_k^{e_k}</m>,
          where <m>p_1, p_2, \ldots, p_k</m> are distinct primes.
          Prove that
          <me>
            \phi(n) =  n \left( 1 - \frac{1}{p_1} \right) \left( 1 - \frac{1}{p_2} \right)\cdots \left( 1 - \frac{1}{p_k} \right)
          </me>.
        </p>
      </statement>
      <hint>
        <p>
          If <m>\gcd(m,n) = 1</m>,
          then <m>\phi(mn) = \phi(m)\phi(n)</m> (<xref ref="integers-exercise-gcd-products"/> in <xref ref="integers"/>).
        </p>
      </hint>
    </exercise>

    <exercise number="23" xml:id="cosets-exercise-euler-phi-sum">
      <statement>
        <p>
          Show that
          <me>
            n = \sum_{d \mid n} \phi(d)
          </me>
          for all positive integers <m>n</m>.
        </p>
      </statement>
    </exercise>

  </exercises>



  <section xml:id="cosets-sage" component="sage-info">
    <title>Sage</title>
    <introduction>
      <p>
        Sage can create all of the cosets of a subgroup,
        and all of the subgroups of a group.
        While these methods can be somewhat slow, they are in many,
        many ways much better than experimenting with pencil and paper,
        and can greatly assist us in understanding the structure of finite groups.
      </p>
    </introduction>

    <subsection>
      <title>Cosets</title>
      <p>
        Sage will create all the right
        (or left)
        cosets of a subgroup.
        Written mathematically, cosets are sets,
        and the order of the elements within the set is irrelevant.
        With Sage, lists are more natural,
        and here it is to our advantage.
      </p>

      <p>
        Sage creates the cosets of a subgroup as a list of lists.
        Each inner list is a single coset.
        The first coset is always the coset that is the subgroup itself,
        and the first element of this coset is the identity.
        Each of the other cosets can be construed to have their first element as their representative,
        and if you use this element as the representative,
        the elements of the coset are in the same order they would be created by multiplying this representative by the elements of the first coset
        (the subgroup).
      </p>

      <p>
        The keyword <c>side</c> can be <c>'right'</c> or <c>'left'</c>,
        and if not given, then the default is right cosets.
        The options refer to which side of the product has the representative.
        Notice that now Sage's results will be
        <q>backwards</q> compared with the text.
        Here is <xref ref="cosets-example-s3-cosets"/> reprised,
        but in a slightly different order.
      </p>

            <sage>
                <input>
            G = SymmetricGroup(3)
            a = G("(1,2)")
            H = G.subgroup([a])
            rc = G.cosets(H, side='right'); rc
            </input>
                <output>[[(), (1,2)], [(2,3), (1,3,2)], [(1,2,3), (1,3)]]</output>
            </sage>
            <sage>
                <input>lc = G.cosets(H, side='left'); lc</input>
                <output>[[(), (1,2)], [(2,3), (1,2,3)], [(1,3,2), (1,3)]]</output>
            </sage>

      <p>
        So if we work our way through the brackets carefully we can see the difference between the right cosets and the left cosets.
        Compare these cosets with the ones in the text and see that left and right are reversed.
        Shouldn't be a problem <mdash/> just keep it in mind.
      </p>

            <sage>
                <input>
            G = SymmetricGroup(3)
            b = G("(1,2,3)")
            H = G.subgroup([b])
            rc = G.cosets(H, side='right'); rc
            </input>
                <output>[[(), (1,2,3), (1,3,2)], [(2,3), (1,3), (1,2)]]</output>
            </sage>
            <sage>
                <input>lc = G.cosets(H, side='left'); lc</input>
                <output>[[(), (1,2,3), (1,3,2)], [(2,3), (1,2), (1,3)]]</output>
            </sage>

      <p>
        If we study the bracketing,
        we can see that the left and right cosets are equal.
        Let's see what Sage thinks:
      </p>

            <sage>
                <input>rc == lc</input>
                <output>False</output>
            </sage>

      <p>
        Mathematically, we need sets,
        but Sage is working with ordered lists, and the order matters.
        However, if we know our lists do not have duplicates (the <c>.cosets()</c> method will never produce duplicates) then we can sort the lists and a test for equality will perform as expected.
        The elements of a permutation group have an ordering defined for them <mdash/> it is not so important <em>what</em> this is,
        just that <em>some</em> ordering is defined.
        The <c>sorted()</c> function will take any list and return a sorted version.
        So for each list of cosets,
        we will sort the individual cosets and then sort the list of sorted cosets.
        This is a typical maneuver, though a bit complicated with the nested lists.
      </p>

            <sage>
                <input>
            rc_sorted = sorted([sorted(coset) for coset in rc])
            rc_sorted
            </input>
                <output>[[(), (1,2,3), (1,3,2)], [(2,3), (1,2), (1,3)]]</output>
            </sage>
            <sage>
                <input>
            lc_sorted = sorted([sorted(coset) for coset in lc])
            lc_sorted
            </input>
                <output>[[(), (1,2,3), (1,3,2)], [(2,3), (1,2), (1,3)]]</output>
            </sage>
            <sage>
                <input>rc_sorted == lc_sorted</input>
                <output>True</output>
            </sage>

      <p>
        The list of all cosets can be quite long
        (it will include every element of the group)
        and can take a few seconds to complete, even for small groups.
        There are more sophisticated,
        and faster, ways to study cosets
        (such as just using their representatives),
        but to understand these techniques you also need to understand more theory.
      </p>

      <sage type="practice"/>
    </subsection>

    <subsection>
      <title>Subgroups</title>
      <p>
        Sage can compute all of the subgroups of a group.
        This can produce even more output than the coset method and can sometimes take much longer,
        depending on the structure of the group.
        The list is in order of the size of the subgroups, with smallest first.
        As a demonstration we will first compute and list all of the subgroups of a small group,
        and then extract just one of these subgroups from the list for some futher study.
      </p>

            <sage>
                <input>
            G = SymmetricGroup(3)
            sg = G.subgroups(); sg
            </input>
                <output>
            [Subgroup generated by [()] of (Symmetric group of order 3! as a permutation group),
             Subgroup generated by [(2,3)] of (Symmetric group of order 3! as a permutation group),
             Subgroup generated by [(1,2)] of (Symmetric group of order 3! as a permutation group),
             Subgroup generated by [(1,3)] of (Symmetric group of order 3! as a permutation group),
             Subgroup generated by [(1,2,3)] of (Symmetric group of order 3! as a permutation group),
             Subgroup generated by [(2,3), (1,2,3)] of (Symmetric group of order 3! as a permutation group)]
            </output>
            </sage>
            <sage>
                <input>H = sg[4]; H</input>
                <output>Subgroup generated by [(1,2,3)] of (Symmetric group of order 3! as a permutation group)</output>
            </sage>
            <sage>
                <input>H.order()</input>
                <output>3</output>
            </sage>
            <sage>
                <input>H.list()</input>
                <output>[(), (1,2,3), (1,3,2)]</output>
            </sage>
            <sage>
                <input>H.is_cyclic()</input>
                <output>True</output>
            </sage>
            <!-- RAB 2014/08/18 ref is to a proposition, not a Corollary? -->
      <p>
        The output of the <c>.subgroups()</c> method can be voluminous,
        so sometimes we are interested in properties of specific subgroups
        (as in the previous example)
        or broader questions of the group's
        <q>subgroup structure.</q>
        Here we expand on <xref ref="cosets-proposition-theorem-10"/>.
        Notice that just because Sage does not <em>compute</em>
        a subgroup of order 6 in <m>A_4</m>,
        this is no substitute whatsoever for a <em>proof</em>
        such as given for the corollary.
        But the computational result emboldens us to search for the theoretical result with confidence.
      </p>

            <sage>
                <input>
            G = AlternatingGroup(4)
            sg = G.subgroups()
            [H.order() for H in sg]
            </input>
                <output>[1, 2, 2, 2, 3, 3, 3, 3, 4, 12]</output>
            </sage>

      <p>
        So we see no subgroup of order 6 in the list of subgroups of <m>A_4</m>.
        Notice how Lagrange's Theorem (<xref ref="cosets-theorem-lagrange"/>) is in evidence <mdash/> all the subgroup orders divide <m>12</m>,
        the order of <m>A_4</m>.
        Be patient, the next subgroup computation may take a while.
      </p>

            <sage>
                <input>
            G = SymmetricGroup(4)
            sg = G.subgroups()
            [H.order() for H in sg]
            </input>
                <output>
            [1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4,
             6, 6, 6, 6, 8, 8, 8, 12, 24]
            </output>
            </sage>

      <p>
        Again, note Lagrange's Theorem in action.
        But more interestingly, <m>S_4</m> has a subgroup of order 6.
        Four of them, to be precise.
        These four subgroups of order 6 are similar to each other,
        can you describe them simply (<em>before</em>
        digging into the <c>sg</c> list for more information)?
        If you were curious how many subgroups <m>S_4</m> has,
        you could simply count the number of subgroups in the <c>sg</c> list.
        The <c>len()</c> function does this for <em>any</em>
        list and is often an easy way to count things.
      </p>

            <sage>
                <input>len(sg)</input>
                <output>30</output>
            </sage>
      <sage type="practice"/>
    </subsection>

    <subsection>
      <title>Subgroups of Cyclic Groups</title>
      <p>
        Now that we are more familiar with permutation groups,
        and know about the <c>.subgroups()</c> method,
        we can revisit an idea from <xref ref="cyclic"/>.
        The subgroups of a cyclic group are always cyclic,
        but how many are there and what are their orders?
      </p>

            <sage>
                <input>
            G = CyclicPermutationGroup(20)
            [H.order() for H in G.subgroups()]
            </input>
                <output>[1, 2, 4, 5, 10, 20]</output>
            </sage>
            <sage>
                <input>
            G = CyclicPermutationGroup(19)
            [H.order() for H in G.subgroups()]
            </input>
                <output>[1, 19]</output>
            </sage>

      <p>
        We could do this all day, but you have Sage at your disposal,
        so vary the order of <c>G</c> by changing <c>n</c> and study the output across many runs.
        Maybe try a cyclic group of order 24 and compare with the symmetric group <m>S_4</m> (above) which also has order 24.
        Do you feel a conjecture coming on?
      </p>

            <sage>
                <input>
            n = 8
            G = CyclicPermutationGroup(n)
            [H.order() for H in G.subgroups()]
            </input>
                <output>[1, 2, 4, 8]</output>
            </sage>
      <sage type="practice"/>
    </subsection>

    <subsection>
      <title>Euler Phi Function</title>
      <p>
        To add to our number-theoretic functions from <xref ref="integers"/>,
        we note that Sage makes the Euler <m>\phi</m>-function available as the function <c>euler_phi()</c>.
      </p>

            <sage>
                <input>euler_phi(345)</input>
                <output>176</output>
            </sage>

      <p>
        Here's an interesting experiment that you can try running several times.
      </p>

            <sage doctest="random">
                <input>
            m = random_prime(10000)
            n = random_prime(10000)
            m, n, euler_phi(m*n) == euler_phi(m)*euler_phi(n)
            </input>
                <output>(5881, 1277, True)</output>
            </sage>

      <p>
        Feel another conjecture coming on?
        Can you generalize this result?
      </p>

      <sage type="practice"/>
    </subsection>
  </section>
  <exercises xml:id="cosets-sage-exercises" component="sage-exercises">
    <title>Sage Exercises</title>
    <introduction>
      <p>
        The following exercises are less about cosets and subgroups,
        and more about using Sage as an experimental tool.
        They are designed to help you become both more efficient,
        and more expressive, as you write commands in Sage.
        We will have many opportunities to work with cosets and subgroups in the coming chapters.
        These exercises do not contain much guidance,
        and get more challenging as they go.
        They are designed to explore, or confirm,
        results presented in this chapter or earlier chapters.
      </p>

      <p>
        <alert>Important</alert>: You should answer each of the last three problems with a single (complicated) line of Sage that concludes by outputting <c>True</c>.
        A <q>single line</q> means you will have several Sage commands packaged up together in complicated ways.
        It does not mean several Sage commands seperated by semi-colons and typed in on a single line.
        Be sure include some intermediate steps used in building up your solution,
        but using smaller ranges of values so as to not overwhelm the reader with lots of output.
        This will help you, and the grader of your work,
        have some confidence that the final version is correct.
      </p>

      <p>
        When you check integers below for divisibility,
        remember that <c>range()</c> produces plain integers,
        which are quite simple in their functionality.
        The <c>srange()</c> command produces Sage integers,
        which have many more capabilities.
        (See the last exercise for an example.)
        And remember that a list comprehension is a very compact way to examine many possibilities at once.
      </p>
    </introduction>

    <exercise number="1" xml:id="cosets-sage-exercise-A4">
      <statement>
        <p>
          Use <c>.subgroups()</c> to find an example of a group <m>G</m> and an integer <m>m</m>,
          so that (a) <m>m</m> divides the order of <m>G</m>,
          and (b) <m>G</m> has no subgroup of order <m>m</m>.
          (Do not use the group <m>A_4</m> for <m>G</m>,
          since this is in the text.)
          Provide a single line of Sage code that has all the logic to produce the desired <m>m</m> as its output.
          (You can give your group a simple name on a prior line and then just reference the group by name.) Here is a very simple example that might help you structure your answer.
        </p>

            <sage>
                <input>
            a = 5
            b = 10
            c = 6
            d = 13
            a.divides(b)
            </input>
                <output>True</output>
            </sage>
            <sage>
                <input>not (b in [c,d])</input>
                <output>True</output>
            </sage>
            <sage>
                <input>a.divides(b) and not (b in [c,d])</input>
                <output>True</output>
            </sage>
      </statement>
    </exercise>

    <exercise number="2" xml:id="cosets-sage-exercise-fermat">
      <statement>
        <p>
          Verify the truth of Fermat's Little Theorem
          (either variant)
          using the composite number
          <m>391=17\cdot 23</m> as the choice of the base
          (either <m>a</m> or <m>b</m>),
          and for <m>p</m> assuming the value of every prime number between <m>100</m> and <m>1000</m>.
        </p>

        <p>
          Build up a solution slowly <mdash/> make a list of powers
          (start with just a few primes),
          then make a list of powers reduced by modular arithmetic,
          then a list of comparisons with the predicted value,
          then a check on all these logical values resulting from the comparisons.
          This is a useful strategy for many similar problems.
          Eventually you will write a single line that performs the verification by eventually printing out <c>True</c>.
          Here are some more hints about useful functions.
        </p>

            <sage>
                <input>
            a = 20
            b = 6
            a.mod(b)
            </input>
                <output>2</output>
            </sage>
            <sage>
                <input>prime_range(50, 100)</input>
                <output>[53, 59, 61, 67, 71, 73, 79, 83, 89, 97]</output>
            </sage>
            <sage>
                <input>all([True, True, True, True])</input>
                <output>True</output>
            </sage>
            <sage>
                <input>all([True, True, False, True])</input>
                <output>False</output>
            </sage>
      </statement>
    </exercise>

    <exercise number="3" xml:id="cosets-sage-exercise-group-of-units">
      <statement>
        <p>
          Verify that the group of units mod <m>n</m> has order <m>n-1</m> when <m>n</m> is prime,
          again for all primes between <m>100</m> and <m>1000</m>.
          As before, your output should be simply <c>True</c>, just once,
          indicating that the statement about the order is true for all the primes examined.
          As before, build up your solution slowly,
          and with a smaller range of primes in the beginning.
          Express your answer as a single line of Sage code.
        </p>
      </statement>
    </exercise>

    <exercise number="4" xml:id="cosets-sage-exercise-euler">
      <statement>
        <p>
          Verify Euler's Theorem for all values of
          <m>0\lt n\lt 100</m> and for <m>1\leq a \leq n</m>.
          This will require nested <c>for</c> statements with a conditional.
          Again, here is a small example that might be helpful for constructing your one line of Sage code.
          Note the use of <c>srange()</c> in this example.
        </p>

            <sage>
                <input>[a/b for a in srange(9) for b in srange(1,a) if gcd(a,b)==1]</input>
                <output>
            [2, 3, 3/2, 4, 4/3, 5, 5/2, 5/3, 5/4, 6, 6/5,
             7, 7/2, 7/3, 7/4, 7/5, 7/6, 8, 8/3, 8/5, 8/7]
            </output>
            </sage>
      </statement>
    </exercise>

    <exercise number="5" xml:id="cosets-sage-exercise-S7">
      <statement>
        <p>
          The symmetric group on <m>7</m> symbols,
          <m>S_7</m>, has <m>7! = 5040</m> elements.
          Consider the following questions without employing Sage,
          based on what we know about orders of elements of permutation groups (<xref ref="permute-exercise-order-product-cycles"/>).

          <ul>
            <li>
              <p>
                What is the maximum possible order?
              </p>
            </li>

            <li>
              <p>
                How many elements are there of order <m>10</m>?
              </p>
            </li>

            <li>
              <p>
                How many elements are there of order <m>1</m>?
              </p>
            </li>

            <li>
              <p>
                How many elements are there of order <m>2</m>?
              </p>
            </li>

            <li>
              <p>
                What is the smallest positive integer for which there is no element with that order?
              </p>
            </li>
          </ul>
        </p>

        <p>
          These questions will be easier if you are familiar with using binomial coefficients for counting in similarly complex situations.
          But either way, give some serious thought to each question
          (and maybe a few of your own)
          before firing up Sage.
        </p>

        <p>
          Now, compute how many elements there are of each order using the <c>.order()</c> method,
          and then embed this into a list comprehension which creates a single list of these counts.
          You can check your work
          (or check Sage)
          by wrapping this list in <c>sum()</c> and hopefully getting <m>5040</m>.
        </p>

        <p>
          Comment on the process of studying these questions first without any computational aid,
          and then again with Sage.
          For which values of <m>n</m> do you think Sage would be too slow and your mind quicker?
        </p>
      </statement>
    </exercise>

  </exercises>
</chapter>
