<?xml version="1.0"?>
<!-- This file is part of the book                    -->
<!--                                                  -->
<!-- Abstract Algebra: Theory and Applications        -->
<!--                                                  -->
<!-- Text: Copyright (C) 1997-2024  Thomas W. Judson  -->
<!-- Sage: Copyright (C) 2010-2024  Robert A. Beezer  -->
<!-- See the file COPYING for copying conditions.     -->
<!-- This file is part of the book                    -->
<!--                                                  -->
<!-- See the file COPYING for copying conditions.     -->
<chapter xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="cyclic">
  <title>Cyclic Groups</title>
  <introduction>
    <p>
      The groups <m>\mathbb Z</m> and <m>{\mathbb Z}_n</m>,
      which are among the most familiar and easily understood groups,
      are both examples of what are called cyclic groups.
      In this chapter we will study the properties of cyclic groups and cyclic subgroups,
      which play a fundamental part in the classification of all abelian groups.
    </p>
  </introduction>

  <section xml:id="cyclic-section-cyclic-subgroups">
    <title>Cyclic Subgroups</title>
    <introduction>
      <p>
        Often a subgroup will depend entirely on a single element of the group;
        that is, knowing that particular element will allow us to compute any other element in the subgroup.
      </p>
            <!-- RAB 2014/08/18 Maybe this id should have 3z, not z3? -->
      <example xml:id="cyclic-example-z3">
        <p>
          Suppose that we consider <m>3 \in {\mathbb Z}</m> and look at all multiples
          (both positive and negative)
          of <m>3</m>.
          As a set, this is
          <me>
            3 {\mathbb Z} = \{ \ldots, -3, 0, 3, 6, \ldots \}
          </me>.
          It is easy to see that <m>3 {\mathbb Z}</m> is a subgroup of the integers.
          This subgroup is completely determined by the element <m>3</m> since we can obtain all of the other elements of the group by taking multiples of <m>3</m>.
          Every element in the subgroup is
          <q>generated</q> by <m>3</m>.
        </p>
      </example>

      <example xml:id="cyclic-example-2n">
        <p>
          If <m>H = \{ 2^n : n \in {\mathbb Z} \}</m>,
          then <m>H</m> is a subgroup of the multiplicative group of nonzero rational numbers,
          <m>{\mathbb Q}^*</m>.
          If <m>a = 2^m</m> and <m>b = 2^n</m> are in <m>H</m>,
          then <m>ab^{-1} = 2^m 2^{-n} = 2^{m-n}</m> is also in <m>H</m>.
          By <xref ref="groups-proposition-subgroup"/>,
          <m>H</m> is a subgroup of <m>{\mathbb Q}^*</m> determined by the element <m>2</m>.
        </p>
      </example>

      <theorem xml:id="cyclic-theorem-subgroup">
        <statement>
          <p>
            Let <m>G</m> be a group and <m>a</m> be any element in <m>G</m>.
            Then the set

            <notation>
              <usage><m>\langle a \rangle</m></usage>
              <description>cyclic group generated by <m>a</m></description>
            </notation>

            <me>
              \langle a \rangle  = \{ a^k : k \in {\mathbb Z} \}
            </me>
            is a subgroup of <m>G</m>.
            Furthermore,
            <m>\langle a \rangle</m> is the smallest subgroup of <m>G</m> that contains <m>a</m>.
          </p>
        </statement>

        <proof>
          <p>
            The identity is in <m>\langle a \rangle </m> since <m>a^0 = e</m>.
            If <m>g</m> and <m>h</m> are any two elements in <m>\langle a \rangle </m>,
            then by the definition of <m>\langle a \rangle</m> we can write <m>g = a^m</m> and <m>h = a^n</m> for some integers <m>m</m> and <m>n</m>.
            So <m>gh = a^m a^n = a^{m+n}</m> is again in <m>\langle a \rangle </m>.
            Finally, if <m>g = a^n</m> in <m>\langle a \rangle </m>,
            then the inverse <m>g^{-1} = a^{-n}</m> is also in <m>\langle a \rangle </m>.
            Clearly, any subgroup <m>H</m> of <m>G</m> containing <m>a</m> must contain all the powers of <m>a</m> by closure;
            hence, <m>H</m> contains <m>\langle a \rangle </m>.
            Therefore, <m>\langle a \rangle </m> is the smallest subgroup of <m>G</m> containing <m>a</m>.
          </p>
        </proof>
      </theorem>

      <remark>
        <p>
          If we are using the <q>+</q> notation,
          as in the case of the integers under addition,
          we write <m>\langle a \rangle = \{ na : n \in {\mathbb Z} \}</m>.
        </p>
      </remark>

      <p>
        For <m>a \in G</m>, we call <m>\langle a \rangle </m> the
        <term>cyclic subgroup</term><idx><h>Subgroup</h><h>cyclic</h></idx>
        generated by <m>a</m>.
        If <m>G</m> contains some element <m>a</m> such that <m>G = \langle a \rangle </m>,
        then <m>G</m> is a <idx><h>Group</h><h>cyclic</h></idx><term>cyclic group</term>.
        In this case <m>a</m> is a <term>generator</term><idx><h>Generator of a cyclic subgroup</h></idx> of <m>G</m>.
        If <m>a</m> is an element of a group <m>G</m>,
        we define the <term>order</term><idx><h>Element</h><h>order of</h></idx>
        of <m>a</m> to be the smallest positive integer <m>n</m> such that <m>a^n= e</m>,
        and we write <m>|a| = n</m>.

        <notation>
          <usage><m>|a|</m></usage>
          <description>the order of an element <m>a</m></description>
        </notation>

        If there is no such integer <m>n</m>,
        we say that the order of <m>a</m> is infinite and write
        <m>|a| = \infty</m> to denote the order of <m>a</m>.
      </p>

      <example xml:id="cyclic-example-z6">
        <p>
          Notice that a cyclic group can have more than a single generator.
          Both <m>1</m> and <m>5</m> generate <m>{\mathbb Z}_6</m>;
          hence, <m>{\mathbb Z}_6</m> is a cyclic group.
          Not every element in a cyclic group is necessarily a generator of the group.
          The order of <m>2 \in {\mathbb Z}_6</m> is <m>3</m>.
          The cyclic subgroup generated by <m>2</m> is <m>\langle 2 \rangle = \{ 0, 2, 4 \}</m>.
        </p>
      </example>

      <p>
        The groups <m>{\mathbb Z}</m> and <m>{\mathbb Z}_n</m> are cyclic groups.
        The elements <m>1</m> and <m>-1</m> are generators for <m>{\mathbb Z}</m>.
        We can certainly generate <m>{\mathbb Z}_n</m> with 1 although there may be other generators of <m>{\mathbb Z}_n</m>,
        as in the case of <m>{\mathbb Z}_6</m>.
      </p>

      <example xml:id="cyclic-example-u9">
        <p>
          The group of units, <m>U(9)</m>,
          in <m>{\mathbb Z}_9</m> is a cyclic group.
          As a set, <m>U(9)</m> is <m>\{ 1, 2, 4, 5, 7, 8  \}</m>.
          The element 2 is a generator for <m>U(9)</m> since
          <md>
            <mrow>2^1 &amp; = 2 \qquad 2^2 = 4</mrow>
            <mrow>2^3 &amp; = 8 \qquad 2^4 = 7</mrow>
            <mrow>2^5 &amp; =  5 \qquad 2^6 = 1</mrow>
          </md>.
        </p>
      </example>

      <example xml:id="cyclic-example-s3-not-cyclic">
        <p>
          Not every group is a cyclic group.
          Consider the symmetry group of an equilateral triangle <m>S_3</m>.
          The multiplication table for this group is <xref ref="groups-table-s3"/>.
          The subgroups of <m>S_3</m> are shown in <xref ref="cyclic-figure-subgrps-s3"/>.
          Notice that every subgroup is cyclic;
          however, no single element generates the entire group.
        </p>

        <figure xml:id="cyclic-figure-subgrps-s3">
          <caption>Subgroups of <m>S_3</m></caption>
            <!-- Replaced figure with tikz figure - TWJ 5/6/2010 -->
          <image xml:id="cyclic-s3-subgroups">
            <description>The lattice of subgroups for S-3: the top is S-3, the second line is the identity, rho-1, rho-2; the identity, mu-1; the identity, mu-2; the identity, mu-3, and the bottom is the identity subgroup.</description>

            <latex-image>
                <xi:include href="tikz/cyclic-s3-subgroups.tex" parse="text"/>
            </latex-image>
          </image>

        </figure>
      </example>

      <theorem xml:id="cyclic-theorem-abelian">
        <statement>
          <p>
            Every cyclic group is abelian.
          </p>
        </statement>

        <proof>
          <p>
            Let <m>G</m> be a cyclic group and <m>a \in G</m> be a generator for <m>G</m>.
            If <m>g</m> and <m>h</m> are in <m>G</m>,
            then they can be written as powers of <m>a</m>,
            say <m>g = a^r</m> and <m>h = a^s</m>.
            Since
            <me>
              g  h = a^r a^s = a^{r+s} = a^{s+r} = a^s a^r = h g
            </me>,
            <m>G</m> is abelian.
          </p>
        </proof>
      </theorem>
    </introduction>

    <subsection xml:id="cyclic-subsection-cyclic-subgroups">
      <title>Subgroups of Cyclic Groups</title>
      <p>
        We can ask some interesting questions about cyclic subgroups of a group and subgroups of a cyclic group.
        If <m>G</m> is a group, which subgroups of <m>G</m> are cyclic?
        If <m>G</m> is a cyclic group,
        what type of subgroups does <m>G</m> possess?
      </p>

      <theorem xml:id="cyclic-theorem-cyclic-subgroups">
        <statement>
          <p>
            Every subgroup of a cyclic group is cyclic.
          </p>
        </statement>

        <proof>
          <p>
            The main tools used in this proof are the division algorithm and the Principle of Well-Ordering.
            Let <m>G</m> be a cyclic group generated by <m>a</m> and suppose that <m>H</m> is a subgroup of <m>G</m>.
            If <m>H = \{ e \}</m>, then trivially <m>H</m> is cyclic.
            Suppose that <m>H</m> contains some other element <m>g</m> distinct from the identity.
            Then <m>g</m> can be written as <m>a^n</m> for some integer <m>n</m>.
            Since <m>H</m> is a subgroup,
            <m>g^{-1} = a^{-n}</m> must also be in <m>H</m>.
            Since either <m>n</m> or <m>-n</m> is positive,
            we can assume that <m>H</m> contains positive powers of <m>a</m> and <m>n \gt 0</m>.
            Let <m>m</m> be the smallest natural number such that <m>a^m \in H</m>.
            Such an <m>m</m> exists by the Principle of Well-Ordering.
          </p>

          <p>
            We claim that <m>h = a^m</m> is a generator for <m>H</m>.
            We must show that every <m>h' \in H</m> can be written as a power of <m>h</m>.
            Since <m>h' \in H</m> and <m>H</m> is a subgroup of <m>G</m>,
            <m>h' = a^k</m> for some integer <m>k</m>.
            Using the division algorithm,
            we can find numbers <m>q</m> and <m>r</m> such that
            <m>k = mq +r</m> where <m>0 \leq r \lt m</m>; hence,
            <me>
              a^k = a^{mq +r} = (a^m)^q a^r = h^q a^r
            </me>.
            So <m>a^r = a^k h^{-q}</m>.
            Since <m>a^k</m> and <m>h^{-q}</m> are in <m>H</m>,
            <m>a^r</m> must also be in <m>H</m>.
            However, <m>m</m> was the smallest positive number such that <m>a^m</m> was in <m>H</m>;
            consequently, <m>r=0</m> and so <m>k=mq</m>.
            Therefore,
            <me>
              h' = a^k = a^{mq} =  h^q
            </me>
            and <m>H</m> is generated by <m>h</m>.
          </p>
        </proof>
      </theorem>

      <corollary>
        <statement>
          <p>
            The subgroups of <m>{\mathbb Z}</m> are exactly
            <m>n{\mathbb Z}</m> for <m>n = 0, 1, 2,\ldots</m>.
          </p>
        </statement>
      </corollary>

      <proposition xml:id="cyclic-proposition-subgrp-order">
        <statement>
          <p>
            Let <m>G</m> be a cyclic group of order <m>n</m> and suppose that <m>a</m> is a generator for <m>G</m>.
            Then <m>a^k=e</m> if and only if <m>n</m> divides <m>k</m>.
          </p>
        </statement>

        <proof>
          <p>
            First suppose that <m>a^k=e</m>.
            By the division algorithm,
            <m>k = nq + r</m> where <m>0 \leq r \lt n</m>; hence,
            <me>
              e = a^k = a^{nq + r} = a^{nq} a^r = e a^r = a^r
            </me>.
            Since the smallest positive integer <m>m</m> such that <m>a^m = e</m> is <m>n</m>,
            <m>r= 0</m>.
          </p>

          <p>
            Conversely, if <m>n</m> divides <m>k</m>,
            then <m>k=ns</m> for some integer <m>s</m>.
            Consequently,
            <me>
              a^k = a^{ns} = (a^n)^s = e^s = e
            </me>.
          </p>
        </proof>
      </proposition>

      <theorem xml:id="cyclic-theorem-cyclic-orders">
        <statement>
          <p>
            Let <m>G</m> be a cyclic group of order <m>n</m> and suppose that <m>a \in G</m> is a
            generator of the group.
            If <m>b = a^k</m>, then the order of <m>b</m> is <m>n/d</m>,
            where <m>d = \gcd(k,n)</m>.
          </p>
        </statement>

        <proof>
          <p>
            We wish to find the smallest integer <m>m</m> such that <m>e = b^m = a^{km}</m>.
            By <xref ref="cyclic-proposition-subgrp-order"/>,
            this is the smallest integer <m>m</m> such that <m>n</m> divides <m>km</m> or,
            equivalently,
            <m>n/d</m> divides <m>m(k/d)</m>.
            Since <m>d</m> is the greatest common divisor of <m>n</m> and <m>k</m>,
            <m>n/d</m> and <m>k/d</m> are relatively prime.
            Hence, for <m>n/d</m> to divide <m>m(k/d)</m> it must divide <m>m</m>.
            The smallest such <m>m</m> is <m>n/d</m>.
          </p>
        </proof>
      </theorem>

      <corollary xml:id="cyclic-corollary-mod-n-generators">
        <statement>
          <p>
            The generators of <m>{\mathbb Z}_n</m> are the integers <m>r</m> such that
            <m>1 \leq r \lt n</m> and <m>\gcd(r,n) = 1</m>.
          </p>
        </statement>
      </corollary>

      <example xml:id="cyclic-example-z16">
        <p>
          Let us examine the group <m>{\mathbb Z}_{16}</m>.
          The numbers <m>1</m>, <m>3</m>,
          <m>5</m>, <m>7</m>, <m>9</m>, <m>11</m>, <m>13</m>,
          and <m>15</m> are the elements of
          <m>{\mathbb Z}_{16}</m> that are relatively prime to <m>16</m>.
          Each of these elements generates <m>{\mathbb Z}_{16}</m>.
          For example,
          <md>
            <mrow>1 \cdot 9  &amp; =  9  &amp;  2 \cdot 9  &amp; = 2  &amp; 3 \cdot 9  &amp; = 11</mrow>
            <mrow>4 \cdot 9  &amp; =  4  &amp;  5 \cdot 9  &amp; = 13 &amp; 6 \cdot 9 &amp; = 6</mrow>
            <mrow>7 \cdot 9  &amp; =  15 &amp; 8 \cdot 9  &amp; = 8  &amp; 9 \cdot 9 &amp;  = 1</mrow>
            <mrow>10 \cdot 9 &amp; =  10 &amp; 11 \cdot 9 &amp; = 3  &amp; 12 \cdot 9 &amp;  = 12</mrow>
            <mrow>13 \cdot 9 &amp; =  5 &amp; 14 \cdot 9 &amp; = 14 &amp;  15 \cdot 9 &amp; = 7</mrow>
          </md>.
        </p>
      </example>
    </subsection>
  </section>

  <section xml:id="cyclic-section-mult-group-c">
    <title>Multiplicative Group of Complex Numbers</title>
    <introduction>
      <p>
        The <term>complex numbers</term> are defined as
        <me>
          {\mathbb C} = \{ a + bi : a, b \in {\mathbb R} \}
        </me>,
        where <m>i^2 = -1</m>.
        If <m>z = a + bi</m>, then <m>a</m> is the <term>real part</term>
        of <m>z</m> and <m>b</m> is the
        <term>imaginary part</term> of <m>z</m>.
      </p>

      <p>
        To add two complex numbers <m>z=a+bi</m> and <m>w= c+di</m>,
        we just add the corresponding real and imaginary parts:
        <me>
          z + w=(a + bi ) + (c + di)  =  (a + c) + (b + d)i
        </me>.
        Remembering that <m>i^2 = -1</m>,
        we multiply complex numbers just like polynomials.
        The product of <m>z</m> and <m>w</m> is
        <me>
          (a + bi )(c + di)  =   ac + bdi^2 + adi + bci =  (ac -bd) +(ad + bc)i
        </me>.
      </p>

      <p>
        Every nonzero complex number
        <m>z = a +bi</m> has a multiplicative inverse;
        that is, there exists a <m>z^{-1} \in {\mathbb C}^\ast</m> such that <m>z z^{-1} = z^{-1} z = 1</m>.
        If <m>z = a + bi</m>, then
        <me>
          z^{-1} = \frac{a-bi}{ a^2 + b^2  }
        </me>.
        The <term>complex conjugate</term><idx><h>Conjugate, complex</h></idx>
        of a complex number <m>z = a + bi</m> is defined to be <m>\overline{z} = a- bi</m>.
        The <term>absolute value</term> or <term>modulus</term>
        of  <m>z = a + bi</m>  is <m>|z| = \sqrt{a^2 + b^2}</m>.
      </p>

      <example xml:id="cyclic-example-complex-add">
        <p>
          Let <m>z = 2 + 3i</m> and <m>w = 1-2i</m>.
          Then
          <me>
            z + w = (2 + 3i) + (1 - 2i) = 3 + i
          </me>
          and
          <me>
            z  w = (2 + 3i)(1 - 2i ) = 8 - i
          </me>.
          Also,
          <md>
            <mrow>z^{-1} &amp; = \frac{2}{13} - \frac{3}{13}i</mrow>
            <mrow>|z| &amp; = \sqrt{13}</mrow>
            <mrow>\overline{z} &amp; = 2-3i</mrow>
          </md>.
        </p>
      </example>

      <figure xml:id="cyclic-figure-rectcoord">
        <caption>Rectangular coordinates of a complex number</caption>
            <!-- Replaced figure with tikz figure - TWJ 5/6/2010 -->
        <image xml:id="cyclic-complex-rectangular">
          <description>The complex plane where the horizontal axis is the x-axis or real axis and the verticle axis is the y-axis or imaginary axis. The point z1 = 2 + 3i is in the upper right quadrant, the point z2 = 1- 2i in the lower right quadrant, and z3 = -3 + 2i in the upper right quadrant.</description>

            <latex-image>
                <xi:include href="tikz/cyclic-complex-rectangular.tex" parse="text"/>
            </latex-image>
        </image>

      </figure>

      <p>
        There are several ways of graphically representing complex numbers.
        We can represent a complex number
        <m>z = a +bi</m> as an ordered pair on the <m>xy</m> plane where <m>a</m> is the <m>x</m>
        (or real)
        coordinate and <m>b</m> is the <m>y</m>
        (or imaginary)
        coordinate.
        This is called the <term>rectangular</term>
        or <term>Cartesian</term> representation.
        The rectangular representations of
        <m>z_1 = 2 + 3i</m>, <m>z_2 = 1 - 2i</m>,
        and <m>z_3 = - 3 + 2i</m> are depicted in <xref ref="cyclic-figure-rectcoord"/>.
      </p>

      <figure xml:id="cyclic-figure-polarcoord">
        <caption>Polar coordinates of a complex number</caption>
            <!-- Replaced figure with tikz figure - TWJ 5/6/2010 -->
        <image xml:id="cyclic-complex-polar">
          <description>The complex plane where the horizontal axis is the x-axis or real axis and the verticle axis is the y-axis or imaginary axis.  The point a + bi is in the upper right quadrant.  The point is also determined by a ray that at an angle of theta counterclockwise from the horizontal axis having a length of r.</description>

            <latex-image>
                <xi:include href="tikz/cyclic-complex-polar.tex" parse="text"/>
            </latex-image>
        </image>

      </figure>

      <p>
        Nonzero complex numbers can also be represented using
        <term>polar coordinates</term>.
        To specify any nonzero point on the plane,
        it suffices to give an angle <m>\theta</m> from the positive <m>x</m> axis in the counterclockwise direction and a distance <m>r</m> from the origin,
        as in  <xref ref="cyclic-figure-polarcoord"/>.
        We can see that
        <me>
          z = a + bi = r( \cos \theta + i \sin \theta)
        </me>.
        Hence,
        <me>
          r = |z| = \sqrt{a^2 + b^2}
        </me>
        and
        <md>
          <mrow>a &amp; = r \cos \theta</mrow>
          <mrow>b &amp; = r \sin \theta</mrow>
        </md>.
        We sometimes abbreviate <m>r( \cos \theta + i \sin \theta)</m> as <m>r \cis \theta</m>.

        <notation>
          <usage><m>\cis \theta</m></usage>
          <description><m>\cos \theta + i \sin \theta</m></description>
        </notation>

        To assure that the representation of <m>z</m> is  well-defined,
        we also require that <m>0^{\circ} \leq \theta \lt 360^{\circ}</m>.
        If the measurement is in radians,
        then <m>0 \leq \theta \lt2 \pi</m>.
      </p>

      <example xml:id="cyclic-example-polar">
        <p>
          Suppose that <m>z = 2 \cis  60^{\circ}</m>.
          Then
          <me>
            a  =  2 \cos 60^{\circ} = 1
          </me>
          and
          <me>
            b = 2 \sin 60^{\circ} = \sqrt{3}
          </me>.
          Hence, the rectangular representation is <m>z = 1+\sqrt{3}\, i</m>.
        </p>

        <p>
          Conversely, if we are given a rectangular representation of a complex number,
          it is often useful to know the number's polar representation.
          If <m>z = 3 \sqrt{2} - 3 \sqrt{2}\, i</m>, then
          <me>
            r = \sqrt{a^2 + b^2} = \sqrt{36 } = 6
          </me>
          and
          <me>
            \theta = \arctan \left( \frac{b}{a} \right) = \arctan( - 1) = 315^{\circ}
          </me>,
          so <m>3 \sqrt{2} - 3 \sqrt{2}\, i=6 \cis  315^{\circ}</m>.
        </p>
      </example>

      <p>
        The polar representation of a complex number makes it easy to find products and powers of complex numbers.
        The proof of the following proposition is straightforward and is left as an exercise.
      </p>

      <proposition xml:id="cyclic-proposition-polar-mult">
        <statement>
          <p>
            Let <m>z = r \cis \theta</m> and
            <m>w = s \cis \phi</m> be two nonzero complex numbers.
            Then
            <me>
              zw = r s \cis( \theta + \phi)
            </me>.
          </p>
        </statement>
      </proposition>

      <example xml:id="cyclic-example-polar-mult">
        <p>
          If <m>z = 3 \cis( \pi / 3 )</m> and <m>w = 2 \cis(\pi / 6 )</m>,
          then <m>zw = 6 \cis( \pi / 2 ) = 6i</m>.
        </p>
      </example>

      <theorem>
        <title>DeMoivre</title>
        <idx>
        <h>DeMoivre's Theorem</h>
        </idx>
        <statement>
          <p>
            Let <m>z = r \cis \theta</m> be a nonzero complex number.
            Then
            <me>
              [r \cis \theta  ]^n = r^n \cis( n \theta)
            </me>
            for <m>n = 1, 2, \ldots</m>.
          </p>
        </statement>

        <proof>
          <p>
            We will use induction on <m>n</m>.
            For <m>n = 1</m> the theorem is trivial.
            Assume that the theorem is true for all <m>k</m> such that <m>1  \leq k \leq n</m>.
            Then
            <md>
              <mrow>z^{n+1} &amp; = z^n z</mrow>
              <mrow>&amp; = r^n( \cos  n \theta + i \sin n \theta ) r( \cos \theta + i\sin \theta )</mrow>
              <mrow>&amp; = r^{n+1} [( \cos n \theta \cos \theta - \sin n \theta \sin \theta ) + i ( \sin n \theta \cos \theta + \cos n \theta \sin \theta)]</mrow>
              <mrow>&amp; = r^{n+1} [ \cos( n \theta + \theta) + i \sin( n \theta + \theta) ]</mrow>
              <mrow>&amp; = r^{n+1} [ \cos( n +1) \theta + i \sin( n+1) \theta  ]</mrow>
            </md>.
          </p>
        </proof>
      </theorem>

      <example xml:id="cyclic-theorem-demoivre">
        <p>
          Suppose that <m>z= 1+i</m> and we wish to compute <m>z^{10}</m>.
          Rather than computing <m>(1 + i)^{10}</m> directly,
          it is much easier to switch to polar coordinates and calculate <m>z^{10}</m> using DeMoivre's Theorem:
          <md>
            <mrow>z^{10} &amp; = (1+i)^{10}</mrow>
            <mrow>&amp; = \left( \sqrt{2} \cis \left( \frac{\pi }{4} \right) \right)^{10}</mrow>
            <mrow>&amp; = ( \sqrt{2}\, )^{10} \cis \left( \frac{5\pi }{2} \right)</mrow>
            <mrow>&amp; = 32  \cis \left( \frac{\pi }{2} \right)</mrow>
            <mrow>&amp; = 32i</mrow>
          </md>.
        </p>
      </example>
    </introduction>

    <subsection xml:id="cyclic-subsection-circle-group">
      <title>The Circle Group and the Roots of Unity</title>
      <p>
        The multiplicative group of the complex numbers,
        <m>{\mathbb C}^*</m>, possesses some interesting subgroups.
        Whereas <m>{\mathbb Q}^*</m> and
        <m>{\mathbb R}^*</m> have no interesting subgroups of finite order,
        <m>{\mathbb C}^*</m> has many.
        We first consider the <term>circle group</term>,<idx><h>Group</h><h>circle</h></idx>
        <notation>
          <usage><m>\mathbb T</m></usage>
          <description>the circle group</description>
        </notation>
        <me>
          {\mathbb T} = \{ z \in {\mathbb C} : |z| = 1 \}
        </me>.
        The following proposition is a direct result of <xref ref="cyclic-proposition-polar-mult"/>.
      </p>

      <proposition>
        <statement>
          <p>
            The circle group is a subgroup of <m>{\mathbb C}^*</m>.
          </p>
        </statement>
      </proposition>

      <p>
        Although the circle group has infinite order,
        it has many interesting finite subgroups.
        Suppose that <m>H = \{ 1, -1, i, -i \}</m>.
        Then <m>H</m> is a subgroup of the circle group.
        Also, <m>1</m>, <m>-1</m>, <m>i</m>,
        and <m>-i</m> are exactly those complex numbers that satisfy the equation <m>z^4 = 1</m>.
        The complex numbers satisfying the equation <m>z^n=1</m> are called the
        <idx><h><m>n</m>th root of unity</h></idx><term><m>n</m>th roots of unity</term>.
      </p>

      <theorem>
        <statement>
          <p>
            If <m>z^n = 1</m>, then the <m>n</m>th roots of unity are
            <me>
              z = \cis\left( \frac{2 k \pi}{n } \right)
            </me>,
            where <m>k = 0, 1, \ldots, n-1</m>.
            Furthermore,
            the <m>n</m>th roots of unity form a cyclic subgroup of <m>{\mathbb T}</m> of order <m>n</m>
          </p>
        </statement>

        <proof>
          <p>
            By DeMoivre's Theorem,
            <me>
              z^n = \cis \left( n \frac{2 k \pi}{n } \right) = \cis( 2 k \pi ) = 1
            </me>.
            The <m>z</m>'s are distinct since the numbers
            <m>2 k \pi /n</m> are all distinct and are greater than or equal to 0 but less than <m>2 \pi</m>.
            The fact that these are all of the roots of the equation <m>z^n=1</m> follows from from <xref ref="poly-corollary-zeros"/>,
            which states that a polynomial of degree <m>n</m> can have at most <m>n</m> roots.
            We will leave the proof that the <m>n</m>th roots of unity form a cyclic subgroup of <m>{\mathbb T}</m> as an exercise.
          </p>
        </proof>
      </theorem>

      <p>
        A generator for the group of the <m>n</m>th roots of unity is called a
        <idx><h>Primitive <m>n</m>th root of unity</h></idx><term>primitive <m>n</m>th root of unity</term>.
      </p>

      <example xml:id="example-roots_unity">
        <p>
          The 8th roots of unity can be represented as eight equally spaced points on the unit circle (<xref ref="cyclic-figure-roots-unity"/>).
          The primitive 8th roots of unity are
          <md>
            <mrow>\omega &amp; = \frac{\sqrt{2}}{2}  + \frac{\sqrt{2}}{2} i</mrow>
            <mrow>\omega^3 &amp; = -\frac{\sqrt{2}}{2}  + \frac{\sqrt{2}}{2} i</mrow>
            <mrow>\omega^5 &amp; = -\frac{\sqrt{2}}{2}  - \frac{\sqrt{2}}{2} i</mrow>
            <mrow>\omega^7 &amp; = \frac{\sqrt{2}}{2}  - \frac{\sqrt{2}}{2}i</mrow>
          </md>.
        </p>

        <figure xml:id="cyclic-figure-roots-unity">
          <caption>8th roots of unity</caption>
            <!-- Replaced figure with tikz figure - TWJ 5/6/2010 -->
          <image width="80%" xml:id="cyclic-roots-unity">
            <description>The 8 roots of unity are spaced evenly around the unit circle beginning with 1 on the positive horizontal axis and followed by omega, i, the cube of omega, -1, omega to the fifth power, -i, and omega to the seventh power.</description>

            <latex-image>
                <xi:include href="tikz/cyclic-roots-unity.tex" parse="text"/>
            </latex-image>
          </image>

        </figure>
      </example>

    </subsection>
  </section>

  <section xml:id="cyclic-section-method-of-repeated-squares">
    <title>The Method of Repeated Squares</title>
    <p>
      Computing large powers can be very time-consuming.
      Just as anyone can compute <m>2^2</m> or <m>2^8</m>,
      everyone knows how to compute
      <me>
        2^{2^{1{,}000{,}000} }
      </me>.
      However, such numbers are so large that we do not want to attempt the calculations;
      moreover, past a certain point the computations would not be feasible even if we had every computer in the world at our disposal.
      Even writing down the decimal representation of a very large number may not be reasonable.
      It could be thousands or even millions of digits long.
      However, if we could compute something like
      <me>
        2^{37{,}398{,}332 } \pmod{ 46{,}389}
      </me>,
      we could very easily write the result down since it would be a number between <m>0</m> and <m>46{,}388</m>.
      If we want to compute powers modulo <m>n</m> quickly and efficiently,
      we will have to be clever.<fn>
      The results in this section are needed only in <xref ref="crypt"/>
      </fn></p>

    <p>
      The first thing to notice is that any number <m>a</m> can be written as the sum of distinct powers of <m>2</m>;
      that is, we can write
      <me>
        a = 2^{k_1} + 2^{k_2} + \cdots + 2^{k_n}
      </me>,
      where <m>k_1 \lt k_2 \lt \cdots \lt k_n</m>.
      This is just the binary representation of <m>a</m>.
      For example, the binary representation of 57 is 111001,
      since we can write <m>57 = 2^0 + 2^3 + 2^4 + 2^5</m>.
    </p>

    <p>
      The laws of exponents still work in <m>{\mathbb Z}_n</m>;
      that is, if <m>b \equiv a^x \pmod{ n}</m> and <m>c \equiv a^y \pmod{ n}</m>,
      then <m>bc \equiv a^{x+y} \pmod{ n}</m>.
      We can compute <m>a^{2^k} \pmod{ n}</m> in <m>k</m> multiplications by computing
      <md>
        <mrow>a^{2^0} \pmod{ n}</mrow>
        <mrow>a^{2^1} \pmod{ n }</mrow>
        <mrow>\vdots</mrow>
        <mrow>a^{2^k} \pmod{ n}</mrow>
      </md>.
      Each step involves squaring the answer obtained in the previous step,
      dividing by <m>n</m>, and taking the remainder.
    </p>

    <example xml:id="cyclic-example-repeated-squares">
      <p>
        We will compute <m>271^{321} \pmod{ 481}</m>.
        Notice that
        <me>
          321 = 2^0 +2^6 + 2^8;
        </me>
        hence, computing <m>271^{ 321} \pmod{ 481}</m> is the same as computing
        <me>
          271^{ 2^0 +2^6 + 2^8 } \equiv 271^{ 2^0 } \cdot 271^{2^6 } \cdot 271^{ 2^8 } \pmod{ 481}
        </me>.
        So it will suffice to compute
        <m>271^{ 2^i } \pmod{ 481}</m> where <m>i = 0, 6, 8</m>.
        It is very easy to see that
        <me>
          271^{ 2^1}  = 73{,}441 \equiv 329 \pmod{ 481}
        </me>.
        We can square this result to obtain a value for <m>271^{ 2^2} \pmod{481}</m>:
        <md>
          <mrow>271^{ 2^2}  &amp; \equiv (271^{ 2^1})^2 \pmod{ 481}</mrow>
          <mrow>&amp; \equiv (329)^2 \pmod{481}</mrow>
          <mrow>&amp; \equiv 108{,}241 \pmod{481}</mrow>
          <mrow>&amp; \equiv 16 \pmod{481}</mrow>
        </md>.
        We are using the fact that <m>(a^{2^n})^2  \equiv a^{2 \cdot 2^n} \equiv a^{ 2^{n+1} } \pmod{ n}</m>.
        Continuing, we can calculate
        <me>
          271^{ 2^6 } \equiv 419 \pmod{481}
        </me>
        and
        <me>
          271^{ 2^8 }  \equiv 16 \pmod{481}
        </me>.
        Therefore,
        <md>
          <mrow>271^{ 321} &amp; \equiv 271^{ 2^0 +2^6 + 2^8 } \pmod{481}</mrow>
          <mrow>&amp; \equiv 271^{ 2^0 } \cdot 271^{ 2^6 } \cdot 271^{ 2^8 } \pmod{481}</mrow>
          <mrow>&amp; \equiv 271 \cdot 419 \cdot 16 \pmod{ 481}</mrow>
          <mrow>&amp; \equiv 1{,}816{,}784 \pmod{ 481}</mrow>
          <mrow>&amp; \equiv 47 \pmod{ 481}</mrow>
        </md>.
      </p>
    </example>
        <!-- Reformatted example.  TWJ 2/5/2013 -->
    <p>
      The method of repeated squares will prove to be a very useful tool when we explore <acro>RSA</acro> cryptography in <xref ref="crypt"/>.
      To encode and decode messages in a reasonable manner under this scheme,
      it is necessary to be able to quickly compute large powers of integers mod <m>n</m>.
    </p>

    <paragraphs component="sage-blurb">
      <title>Sage</title>
      <p>
        Sage support for cyclic groups is a little spotty <mdash/> but we can still make effective use of Sage and perhaps this situation could change soon.
      </p>
    </paragraphs>
  </section>

    <reading-questions>

    <exercise>
      <statement>
        <p>
          What is the order of the element <m>3</m> in <m>U(20)</m>?
        </p>
      </statement>
      <response/>
    </exercise>

    <exercise>
      <statement>
        <p>
          What is the order of the element <m>5</m> in <m>U(23)</m>?
        </p>
      </statement>
      <response/>
    </exercise>

    <exercise>
      <statement>
        <p>
          Find three generators of <m>\mathbb Z_8</m>.
        </p>
      </statement>
      <response/>
    </exercise>

    <exercise>
      <statement>
        <p>
          Find three generators of the <m>5^\text{th}</m> roots of unity.
        </p>
      </statement>
      <response/>
    </exercise>

    <exercise>
      <statement>
        <p>
          Show how to compute <m>15^{40}\pmod{23}</m> efficiently by hand.
          Check your answer with Sage.
        </p>
      </statement>
      <response/>
    </exercise>

  </reading-questions>
    <!-- Exercises with Solutions  -->
    <!-- File: cyclic.xml  -->
    <!-- Title: Cyclic Groups -->
  <exercises xml:id="cyclic-exercises" filenamebase="cyclic">
    <title>Exercises</title>

    <exercise number="1" xml:id="cyclic-exercise-prove-or-disprove-cyclic-facts">
      <statement>
        <p>
          Prove or disprove each of the following statements.

          <ol>
            <li>
              <p>
                All of the generators of <m>{\mathbb Z}_{60}</m> are prime.
              </p>
            </li>

            <li>
              <p>
                <m>U(8)</m> is cyclic.
              </p>
            </li>

            <li>
              <p>
                <m>{\mathbb Q}</m> is cyclic.
              </p>
            </li>

            <li>
              <p>
                If every proper subgroup of a group <m>G</m> is cyclic,
                then <m>G</m> is a cyclic group.
              </p>
            </li>

            <li>
              <p>
                A group with a finite number of subgroups is finite.
              </p>
            </li>
          </ol>
        </p>
      </statement>
      <hint>
        <p>
          (a) False; (c) false; (e) true.
        </p>
      </hint>
    </exercise>

    <exercise number="2" xml:id="cyclic-exercise-order-of-elements">
      <statement>
        <p>
          Find the order of each of the following elements.

          <ol cols="2">
            <li>
              <p>
                <m>5 \in {\mathbb Z}_{12}</m>
              </p>
            </li>

            <li>
              <p>
                <m>\sqrt{3} \in {\mathbb R}</m>
              </p>
            </li>

            <li>
              <p>
                <m>\sqrt{3} \in {\mathbb R}^\ast</m>
              </p>
            </li>

            <li>
              <p>
                <m>-i \in {\mathbb C}^\ast</m>
              </p>
            </li>

            <li>
              <p>
                <m>72 \in {\mathbb Z}_{240}</m>
              </p>
            </li>

            <li>
              <p>
                <m>312 \in {\mathbb Z}_{471}</m>
              </p>
            </li>
          </ol>
        </p>
      </statement>
      <hint>
        <p>
          (a) <m>12</m>; (c) infinite; (e) <m>10</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="3" xml:id="cyclic-exercise-subgroup-elements">
      <statement>
        <p>
          List all of the elements in each of the following subgroups.

          <ol>
            <li>
              <p>
                The subgroup of <m>{\mathbb Z}</m> generated by <m>7</m>
              </p>
            </li>

            <li>
              <p>
                The subgroup of <m>{\mathbb Z}_{24}</m> generated by <m>15</m>
              </p>
            </li>

            <li>
              <p>
                All subgroups of <m>{\mathbb Z}_{12}</m>
              </p>
            </li>

            <li>
              <p>
                All subgroups of <m>{\mathbb Z}_{60}</m>
              </p>
            </li>

            <li>
              <p>
                All subgroups of <m>{\mathbb Z}_{13}</m>
              </p>
            </li>

            <li>
              <p>
                All subgroups of <m>{\mathbb Z}_{48}</m>
              </p>
            </li>

            <li>
              <p>
                The subgroup generated by 3 in <m>U(20)</m>
              </p>
            </li>

            <li>
              <p>
                The subgroup generated by 5 in <m>U(18)</m>
              </p>
            </li>

            <li>
              <p>
                The subgroup of <m>{\mathbb R}^\ast</m> generated by <m>7</m>
              </p>
            </li>

            <li>
              <p>
                The subgroup of <m>{\mathbb C}^\ast</m> generated by <m>i</m> where <m>i^2 = -1</m>
              </p>
            </li>

            <li>
              <p>
                The subgroup of <m>{\mathbb C}^\ast</m> generated by <m>2i</m>
              </p>
            </li>

            <li>
              <p>
                The subgroup of <m>{\mathbb C}^\ast</m> generated by <m>(1 + i) / \sqrt{2}</m>
              </p>
            </li>

            <li>
              <p>
                The subgroup of <m>{\mathbb C}^\ast</m> generated by <m>(1 + \sqrt{3}\, i) / 2</m>
              </p>
            </li>
          </ol>
        </p>
      </statement>
      <hint>
        <p>
          (a) <m>7 {\mathbb Z} = \{ \ldots, -7, 0, 7, 14, \ldots \}</m>; (b) <m>\{ 0, 3, 6, 9, 12, 15, 18, 21 \}</m>; (c) <m>\{ 0 \}</m>,
          <m>\{ 0, 6 \}</m>, <m>\{ 0, 4, 8 \}</m>, <m>\{ 0, 3, 6, 9 \}</m>,
          <m>\{ 0, 2, 4, 6, 8, 10 \}</m>; (g)
          <m>\{ 1, 3, 7, 9 \}</m>; (j) <m>\{ 1, -1, i, -i \}</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="4" xml:id="cyclic-exercise-subgroups-GL2">
      <statement>
        <p>
          Find the subgroups of <m>GL_2( {\mathbb R })</m> generated by each of the following matrices.

          <ol cols="3">
            <li>
              <p>
                <m>\displaystyle \begin{pmatrix}
                0 &amp; 1 \\
                -1 &amp; 0
                \end{pmatrix}</m>
              </p>
            </li>

            <li>
              <p>
                <m>\displaystyle
                \begin{pmatrix}
                0 &amp; 1/3 \\
                3 &amp; 0
                \end{pmatrix}</m>
              </p>
            </li>

            <li>
              <p>
                <m>\displaystyle
                \begin{pmatrix}
                1 &amp; -1 \\
                1 &amp; 0
                \end{pmatrix}</m>
              </p>
            </li>

            <li>
              <p>
                <m>\displaystyle
                \begin{pmatrix}
                1 &amp; -1 \\
                0 &amp; 1
                \end{pmatrix}</m>
              </p>
            </li>

            <li>
              <p>
                <m>\displaystyle
                \begin{pmatrix}
                1 &amp; -1 \\
                -1 &amp; 0
                \end{pmatrix}</m>
              </p>
            </li>

            <li>
              <p>
                <m>\displaystyle
                \begin{pmatrix}
                \sqrt{3}/ 2 &amp; 1/2 \\
                -1/2 &amp; \sqrt{3}/2
                \end{pmatrix}</m>
              </p>
            </li>
          </ol>
        </p>
      </statement>
      <hint>
        <p>
          (a)
          <me>
            \begin{pmatrix}
            1 &amp; 0 \\
            0 &amp; 1
            \end{pmatrix},
            \begin{pmatrix}
            -1 &amp; 0 \\
            0 &amp; -1
            \end{pmatrix},
            \begin{pmatrix}
            0 &amp; -1 \\
            1 &amp; 0
            \end{pmatrix},
            \begin{pmatrix}
            0 &amp; 1 \\
            -1 &amp; 0
            \end{pmatrix}
          </me>.
        </p>

        <p>
          (c)
          <me>
            \begin{pmatrix}
            1 &amp; 0 \\
            0 &amp; 1
            \end{pmatrix},
            \begin{pmatrix}
            1 &amp; -1 \\
            1 &amp; 0
            \end{pmatrix},
            \begin{pmatrix}
            -1 &amp; 1 \\
            -1 &amp; 0
            \end{pmatrix}, \\
            \begin{pmatrix}
            0 &amp; 1 \\
            -1 &amp; 1
            \end{pmatrix},
            \begin{pmatrix}
            0 &amp; -1 \\
            1 &amp; -1
            \end{pmatrix},
            \begin{pmatrix}
            -1 &amp; 0 \\
            0 &amp; -1
            \end{pmatrix}
          </me>.
        </p>
      </hint>
    </exercise>

    <exercise number="5" xml:id="cyclic-exercise-order-Z18-elements">
      <statement>
        <p>
          Find the order of every element in <m>{\mathbb Z}_{18}</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="6" xml:id="cyclic-exercise-order-D4-elements">
      <statement>
        <p>
          Find the order of every element in the symmetry group of the square,
          <m>D_4</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="7" xml:id="cyclic-exercise-cyclic-subgroups-Q8">
      <statement>
        <p>
          What are all of the cyclic subgroups of the quaternion group,
          <m>Q_8</m>?
        </p>
      </statement>
    </exercise>

    <exercise number="8" xml:id="cyclic-exercise-cyclic-subgroups-U30">
      <statement>
        <p>
          List all of the cyclic subgroups of <m>U(30)</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="9" xml:id="cyclic-exercise-generators-subgroups-Z32">
      <statement>
        <p>
          List every generator of each subgroup of order 8 in <m>{\mathbb Z}_{32}</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="10" xml:id="cyclic-exercise-elements-finite-order">
      <statement>
        <p>
          Find all elements of finite order in each of the following groups.
          Here the <q><m>\ast</m></q> indicates the set with zero removed.

          <ol cols="3">
            <li>
              <p>
                <m>{\mathbb Z}</m>
              </p>
            </li>

            <li>
              <p>
                <m>{\mathbb Q}^\ast</m>
              </p>
            </li>

            <li>
              <p>
                <m>{\mathbb R}^\ast</m>
              </p>
            </li>
          </ol>
        </p>
      </statement>
      <hint>
        <p>
          (a) <m>0</m>; (b) <m>1, -1</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="11" xml:id="cyclic-exercise-possible-orders-a24">
      <statement>
        <p>
          If <m>a^{24} =e</m> in a group <m>G</m>,
          what are the possible orders of <m>a</m>?
        </p>
      </statement>
      <hint>
        <p>
          <m>1, 2, 3, 4, 6, 8, 12, 24</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="12" xml:id="cyclic-exercise-cyclic-group-one-generator">
      <statement>
        <p>
          Find a cyclic group with exactly one generator.
          Can you find cyclic groups with exactly two generators?
          Four generators?
          How about <m>n</m> generators?
        </p>
      </statement>
    </exercise>

    <exercise number="13" xml:id="cyclic-exercise-cyclic-groups-order-less-then-20">
      <statement>
        <p>
          For <m>n \leq 20</m>, which groups <m>U(n)</m> are cyclic?
          Make a conjecture as to what is true in general.
          Can you prove your conjecture?
        </p>
      </statement>
    </exercise>

    <exercise number="14" xml:id="cyclic-exercise-products-maynot-have-finite-orders">
      <statement>
        <p>
          Let
          <me>
            A =
            \begin{pmatrix}
            0 &amp; 1 \\
            -1 &amp; 0
            \end{pmatrix}
            \qquad \text{and} \qquad
            B =
            \begin{pmatrix}
            0 &amp; -1 \\
            1 &amp; -1
            \end{pmatrix}
          </me>
          be elements in <m>GL_2( {\mathbb R} )</m>.
          Show that <m>A</m> and <m>B</m> have finite orders but <m>AB</m> does not.
        </p>
      </statement>
    </exercise>

    <exercise number="15" xml:id="cyclic-exercise-complex-arithmetic">
      <statement>
        <p>
          Evaluate each of the following.

          <ol cols="2">
            <li>
              <p>
                <m>(3-2i)+ (5i-6)</m>
              </p>
            </li>

            <li>
              <p>
                <m>(4-5i)-\overline{(4i -4)}</m>
              </p>
            </li>

            <li>
              <p>
                <m>(5-4i)(7+2i)</m>
              </p>
            </li>

            <li>
              <p>
                <m>(9-i) \overline{(9-i)}</m>
              </p>
            </li>

            <li>
              <p>
                <m>i^{45}</m>
              </p>
            </li>

            <li>
              <p>
                <m>(1+i)+\overline{(1+i)}</m>
              </p>
            </li>
          </ol>
        </p>
      </statement>
      <hint>
        <p>
          (a) <m>-3 + 3i</m>; (c) <m>43- 18i</m>; (e) <m>i</m>
        </p>
      </hint>
    </exercise>

    <exercise number="16" xml:id="cyclic-exercise-complex-polar-to-rectangular">
      <statement>
        <p>
          Convert the following complex numbers to the form <m>a + bi</m>.

          <ol cols="2">
            <li>
              <p>
                <m>2 \cis(\pi / 6 )</m>
              </p>
            </li>

            <li>
              <p>
                <m>5 \cis(9\pi/4)</m>
              </p>
            </li>

            <li>
              <p>
                <m>3 \cis(\pi)</m>
              </p>
            </li>

            <li>
              <p>
                <m>\cis(7\pi/4) /2</m>
              </p>
            </li>
          </ol>
        </p>
      </statement>
      <hint>
        <p>
          (a) <m>\sqrt{3} + i</m>; (c) <m>-3</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="17" xml:id="cyclic-exercise-complex-rectangular-to-polar">
      <statement>
        <p>
          Change the following complex numbers to polar representation.

          <ol cols="3">
            <li>
              <p>
                <m>1-i</m>
              </p>
            </li>

            <li>
              <p>
                <m>-5</m>
              </p>
            </li>

            <li>
              <p>
                <m>2+2i</m>
              </p>
            </li>

            <li>
              <p>
                <m>\sqrt{3} + i</m>
              </p>
            </li>

            <li>
              <p>
                <m>-3i</m>
              </p>
            </li>

            <li>
              <p>
                <m>2i + 2 \sqrt{3}</m>
              </p>
            </li>
          </ol>
        </p>
      </statement>
      <hint>
        <p>
          (a) <m>\sqrt{2} \cis( 7 \pi /4)</m>; (c)
          <m>2 \sqrt{2} \cis( \pi /4)</m>; (e) <m>3 \cis(3 \pi/2)</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="18" xml:id="cyclic-exercise-calculate-powers-complex">
      <statement>
        <p>
          Calculate each of the following expressions.

          <ol cols="2">
            <li>
              <p>
                <m>(1+i)^{-1}</m>
              </p>
            </li>

            <li>
              <p>
                <m>(1 - i)^{6}</m>
              </p>
            </li>

            <li>
              <p>
                <m>(\sqrt{3} + i)^{5}</m>
              </p>
            </li>

            <li>
              <p>
                <m>(-i)^{10}</m>
              </p>
            </li>

            <li>
              <p>
                <m>((1-i)/2)^{4}</m>
              </p>
            </li>

            <li>
              <p>
                <m>(-\sqrt{2} - \sqrt{2}\, i)^{12}</m>
              </p>
            </li>

            <li>
              <p>
                <m>(-2 + 2i)^{-5}</m>
              </p>
            </li>
          </ol>
        </p>
      </statement>
      <hint>
        <p>
          (a) <m>(1 - i)/2</m>; (c) <m>16(i - \sqrt{3}\, )</m>; (e) <m>-1/4</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="19" xml:id="cyclic-exercise-complex-modulus">
      <statement>
        <p>
          Prove each of the following statements.

          <ol cols="2">
            <li>
              <p>
                <m>|z| = | \overline{z}|</m>
              </p>
            </li>

            <li>
              <p>
                <m>z \overline{z} = |z|^2</m>
              </p>
            </li>

            <li>
              <p>
                <m>z^{-1} = \overline{z} / |z|^2</m>
              </p>
            </li>

            <li>
              <p>
                <m>|z +w| \leq |z| + |w|</m>
              </p>
            </li>

            <li>
              <p>
                <m>|z - w| \geq | |z| - |w||</m>
              </p>
            </li>

            <li>
              <p>
                <m>|z w| = |z| |w|</m>
              </p>
            </li>
          </ol>
        </p>
      </statement>
    </exercise>

    <exercise number="20" xml:id="cyclic-exercise-6-roots-of-unity">
      <statement>
        <p>
          List and graph the 6th roots of unity.
          What are the generators of this group?
          What are the primitive 6th roots of unity?
        </p>
      </statement>
    </exercise>

    <exercise number="21" xml:id="cyclic-exercise-5-roots-of-unity">
      <statement>
        <p>
          List and graph the 5th roots of unity.
          What are the generators of this group?
          What are the primitive 5th roots of unity?
        </p>
      </statement>
    </exercise>

    <exercise number="22" xml:id="cyclic-exercise-calculate-powers-Zn">
      <statement>
        <p>
          Calculate each of the following.

          <ol cols="2">
            <li>
              <p>
                <m>292^{3171} \pmod{ 582}</m>
              </p>
            </li>

            <li>
              <p>
                <m>2557^{ 341} \pmod{ 5681}</m>
              </p>
            </li>

            <li>
              <p>
                <m>2071^{ 9521} \pmod{ 4724}</m>
              </p>
            </li>

            <li>
              <p>
                <m>971^{ 321} \pmod{ 765}</m>
              </p>
            </li>
          </ol>
        </p>
      </statement>
      <hint>
        <p>
          (a) <m>292</m>; (c) <m>1523</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="23" xml:id="cyclic-exercise-order-of-products">
      <statement>
        <p>
          Let <m>a, b \in G</m>.
          Prove the following statements.

          <ol>
            <li>
              <p>
                The order of <m>a</m> is the same as the order of <m>a^{-1}</m>.
              </p>
            </li>

            <li>
              <p>
                For all <m>g \in G</m>, <m>|a| = |g^{-1}ag|</m>.
              </p>
            </li>

            <li>
              <p>
                The order of <m>ab</m> is the same as the order of <m>ba</m>.
              </p>
            </li>
          </ol>
        </p>
      </statement>
    </exercise>

    <exercise number="24" xml:id="cyclic-exercise-Zpq-generators">
      <statement>
        <p>
          Let <m>p</m> and <m>q</m> be distinct primes.
          How many generators does <m>{\mathbb Z}_{pq}</m> have?
        </p>
      </statement>
    </exercise>

    <exercise number="25" xml:id="cyclic-exercise-Zp-hat-r-generators">
      <statement>
        <p>
          Let <m>p</m> be prime and <m>r</m> be a positive integer.
          How many generators does <m>{\mathbb Z}_{p^r}</m> have?
        </p>
      </statement>
    </exercise>

    <exercise number="26" xml:id="cyclic-exercise-Zp-subgroups">
      <statement>
        <p>
          Prove that <m>{\mathbb Z}_{p}</m> has no nontrivial subgroups if <m>p</m> is prime.
        </p>
      </statement>
    </exercise>

    <exercise number="27" xml:id="cyclic-exercise-orders-15-16">
      <statement>
        <p>
          If <m>g</m> and <m>h</m> have orders <m>15</m> and <m>16</m> respectively in a group <m>G</m>,
          what is the order of <m>\langle g \rangle \cap \langle h \rangle </m>?
        </p>
      </statement>
      <hint>
        <p>
          <m>|\langle g \rangle \cap \langle h \rangle| = 1</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="28" xml:id="cyclic-exercise-generator-am">
      <statement>
        <p>
          Let <m>a</m> be an element in a group <m>G</m>.
          What is a generator for the subgroup <m>\langle a^m \rangle \cap \langle a^n \rangle</m>?
        </p>
      </statement>
    </exercise>

    <exercise number="29" xml:id="cyclic-exercise-even-number-generators-Zn">
      <statement>
        <p>
          Prove that <m>{\mathbb Z}_n</m> has an even number of generators for <m>n \gt 2</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="30" xml:id="cyclic-exercise-coprime-elements-Zn">
      <statement>
        <p>
          Suppose that <m>G</m> is a group and let <m>a</m>, <m>b \in G</m>.
          Prove that if <m>|a| = m</m> and <m>|b| = n</m> with <m>\gcd(m,n) = 1</m>,
          then <m>\langle a \rangle \cap \langle b \rangle = \{ e \}</m>.
        </p>
      </statement>
    </exercise>

    <!--Todo Fix references to torsion subgroup-->

    <exercise number="31" xml:id="cyclic-exercise-elements-finite-order-subgroup">
      <statement>
        <p>
          Let <m>G</m> be an abelian group.
          Show that the elements of finite order in <m>G</m> form a subgroup.
          This subgroup is called the <term>torsion subgroup</term> of <m>G</m>.
        </p>
      </statement>
      <hint>
        <p>
          The identity element in any group has finite order.
          Let <m>g, h \in G</m> have orders <m>m</m> and <m>n</m>,
          respectively.
          Since <m>(g^{-1})^m = e</m> and <m>(gh)^{mn} = e</m>,
          the elements of finite order in <m>G</m> form a subgroup of <m>G</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="32" xml:id="cyclic-exercise-coprime-orders-generators">
      <statement>
        <p>
          Let <m>G</m> be a finite cyclic group of order <m>n</m> generated by <m>x</m>.
          Show that if <m>y = x^k</m> where <m>\gcd(k,n) = 1</m>,
          then <m>y</m> must be a generator of <m>G</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="33" xml:id="cyclic-exercise-cyclic-subgroup-order-4">
      <statement>
        <p>
          If <m>G</m> is an abelian group that contains a pair of cyclic subgroups of order <m>2</m>,
          show that <m>G</m> must contain a subgroup of order <m>4</m>.
          Does this subgroup have to be cyclic?
        </p>
      </statement>
    </exercise>

    <exercise number="34" xml:id="cyclic-exercise-order-Zpq">
      <statement>
        <p>
          Let <m>G</m> be an abelian group of order <m>pq</m> where <m>\gcd(p,q) = 1</m>.
          If <m>G</m> contains elements <m>a</m> and <m>b</m> of order <m>p</m> and <m>q</m> respectively,
          then show that <m>G</m> is cyclic.
        </p>
      </statement>
    </exercise>

    <exercise number="35" xml:id="cyclic-exercise-subgroups-of-Z">
      <statement>
        <p>
          Prove that the subgroups of <m>\mathbb Z</m> are exactly
          <m>n{\mathbb Z}</m> for <m>n = 0, 1, 2, \ldots</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="36" xml:id="cyclic-exercise-generators-of-Zn">
      <statement>
        <p>
          Prove that the generators of
          <m>{\mathbb Z}_n</m> are the integers <m>r</m> such that
          <m>1 \leq r \lt n</m> and <m>\gcd(r,n) = 1</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="37" xml:id="cyclic-exercise-cyclic-ifno-nontrivial-proper-subgroup">
      <statement>
        <p>
          Prove that if <m>G</m> has no proper nontrivial subgroups,
          then <m>G</m> is a cyclic group.
        </p>
      </statement>
      <hint>
        <p>
          If <m>g</m> is an element distinct from the identity in <m>G</m>,
          <m>g</m> must generate <m>G</m>;
          otherwise, <m>\langle g \rangle</m> is a nontrivial proper subgroup of <m>G</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="38" xml:id="cyclic-exercise-order-of-element-divides-order-group">
      <statement>
        <p>
          Prove that the order of an element in a cyclic group <m>G</m> must divide the order of the group.
        </p>
      </statement>
    </exercise>

    <exercise number="39" xml:id="cyclic-exercise-subgroups-exist">
      <statement>
        <p>
          Prove that if <m>G</m> is a cyclic group of order <m>m</m> and <m>d \mid m</m>,
          then <m>G</m> must have a subgroup of order <m>d</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="40" xml:id="cyclic-exercise-minus-one-root-of-unity">
      <statement>
        <p>
          For what integers <m>n</m> is <m>-1</m> an <m>n</m>th root of unity?
        </p>
      </statement>
    </exercise>

    <exercise number="41" xml:id="cyclic-exercise-polar-product-complex">
      <statement>
        <p>
          If <m>z = r( \cos \theta + i \sin \theta)</m> and
          <m>w = s(\cos \phi + i \sin \phi)</m> are two nonzero complex numbers,
          show that
          <me>
            zw = rs[ \cos( \theta + \phi) + i \sin( \theta + \phi)]
          </me>.
        </p>
      </statement>
    </exercise>

    <exercise number="42" xml:id="cyclic-exercise-circle-group-subgroup-C-star">
      <statement>
        <p>
          Prove that the circle group is a subgroup of <m>{\mathbb C}^*</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="43" xml:id="cyclic-exercise-nth-root-of-unity-cyclic">
      <statement>
        <p>
          Prove that the <m>n</m>th roots of unity form a cyclic subgroup of <m>{\mathbb T}</m> of order <m>n</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="44" xml:id="cyclic-exercise-order-of-elements-circle-group">
      <statement>
        <p>
          Let <m>\alpha \in \mathbb T</m>.
          Prove that <m>\alpha^m =1</m> and <m>\alpha^n = 1</m> if and only if
          <m>\alpha^d = 1</m> for <m>d = \gcd(m,n)</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="45" xml:id="cyclic-exercise-order-of-elements-greaterthan-1-in-C">
      <statement>
        <p>
          Let <m>z \in {\mathbb C}^\ast</m>.
          If <m>|z| \neq 1</m>, prove that the order of <m>z</m> is infinite.
        </p>
      </statement>
    </exercise>

    <exercise number="46" xml:id="cyclic-exercise-order-rational-angles-in-T">
      <statement>
        <p>
          Let <m>z =\cos \theta + i \sin \theta</m> be in
          <m>{\mathbb T}</m> where <m>\theta \in {\mathbb Q}</m>.
          Prove that the order of <m>z</m> is infinite.
        </p>
      </statement>
    </exercise>

  </exercises>
  
  <exercises xml:id="cyclic-exercises-programming">
    <title>Programming Exercises</title>
    <exercise>
      <statement>
        <p>
          Write a computer program that will write any decimal number as the sum of distinct powers of <m>2</m>.
          What is the largest integer that your program will handle?
        </p>
      </statement>
    </exercise>

    <exercise>
      <statement>
        <p>
          Write a computer program to calculate
          <m>a^x \pmod{ n}</m> by the method of repeated squares.
          What are the largest values of <m>n</m> and <m>x</m> that your program will accept?
        </p>
      </statement>
    </exercise>

  </exercises>

  <references xml:id="cyclic-references">
    <title>References and Suggested Readings</title>
        <!-- was [1] -->
        <!-- reference updated - TWJ 5/6/2010 -->
    <biblio type="raw">
      Koblitz, N.
      <title>A Course in Number Theory and Cryptography</title>. 2nd ed. Springer, New York, 1994.
    </biblio>
        <!-- was [2] -->
    <biblio type="raw" xml:id="biblio-pomerance-1990">
      Pomerance, C. <q>Cryptology and Computational Number Theory<mdash/>An Introduction,</q> in
      <title>Cryptology and Computational Number Theory</title>, Pomerance, C., ed. Proceedings of Symposia in Applied Mathematics, vol. 42, American Mathematical Society, Providence, RI, 1990. This book gives an excellent account of how the method of repeated squares is used in cryptography.
    </biblio>
  </references>



  <section xml:id="cyclic-sage" component="sage-info">
    <title>Sage</title>
    <introduction>
      <p>
        Cyclic groups are very important,
        so it is no surprise that they appear in many different forms in Sage.
        Each is slightly different,
        and no one implementation is ideal for an introduction,
        but together they can illustrate most of the important ideas.
        Here is a guide to the various ways to construct,
        and study, a cyclic group in Sage.
      </p>
    </introduction>

    <subsection>
      <title>Infinite Cyclic Groups</title>
      <p>
        In Sage, the integers <m>\mathbb Z</m> are constructed with <c>ZZ</c>.
        To build the infinite cyclic group such as
        <m>3\mathbb Z</m> from <xref ref="cyclic-example-z3"/>, simply use <c>3*ZZ</c>.
        As an infinite set, there is not a whole lot you can do with this.
        You can test if integers are in this set, or not.
        You can also recall the generator with the <c>.gen()</c> command.
      </p>

            <sage>
                <input>
            G = 3*ZZ
            -12 in G
            </input>
                <output>True</output>
            </sage>
            <sage>
                <input>
            37 in G
            </input>
                <output>False</output>
            </sage>
            <sage>
                <input>
            G.gen()
            </input>
                <output>3</output>
            </sage>
    </subsection>

    <subsection>
      <title>Additive Cyclic Groups</title>
      <p>
        The additive cyclic group <m>\mathbb Z_n</m> can be built as a special case of a more general Sage construction.
        First we build <m>\mathbb Z_{14}</m> and capture its generator.
        Throughout, pay close attention to the use of parentheses and square brackets for when you experiment on your own.
      </p>

            <sage>
                <input>
            G = AdditiveAbelianGroup([14])
            G.order()
            </input>
                <output>14</output>
            </sage>
            <sage>
                <input>G.list()</input>
                <output>
            [(0), (1), (2), (3), (4), (5), (6), (7),
             (8), (9), (10), (11), (12), (13)]
            </output>
            </sage>
            <sage>
                <input>
            a = G.gen(0)
            a
            </input>
                <output>(1)</output>
            </sage>

      <p>
        You can compute in this group, by using the generator,
        or by using new elements formed by coercing integers into the group,
        or by taking the result of operations on other elements.
        And we can compute the order of elements in this group.
        Notice that we can perform repeated additions with the shortcut of taking integer multiples of an element.
      </p>

            <sage>
                <input>
            a + a
            </input>
                <output>(2)</output>
            </sage>
            <sage>
                <input>
            a + a + a + a
            </input>
                <output>(4)</output>
            </sage>
            <sage>
                <input>
            4*a
            </input>
                <output>(4)</output>
            </sage>
            <sage>
                <input>
            37*a
            </input>
                <output>(9)</output>
            </sage>

      <p>
        We can create, and then compute with,
        new elements of the group by coercing an integer
        (in a list of length <m>1</m>)
        into the group.
        You may get a <c>DeprecationWarning</c> the first time you use this syntax if you are using an old version of Sage.
        The mysterious warning can be safely ignored.
      </p>
            <!-- Only to doctesting, warning to disappear "a few months" after 2015/05/20      -->
            <!-- This test evokes the warning, then next one tests fine, as it normally should -->
            <!-- Adjust sentence above once it goes away -->
            <!-- Adjustments made with v8.8              -->
            <!-- Used ... below to mark out a line number that doctesting complained about -->
            <sage doctest="invisible">
                <input>
            G([2])
            </input>
                <output>(2)</output>
            </sage>
            <sage>
                <input>
            b = G([2]); b
            </input>
                <output>(2)</output>
            </sage>
            <sage>
                <input>
            b + b
            </input>
                <output>(4)</output>
            </sage>
            <sage>
                <input>
            2*b == 4*a
            </input>
                <output>True</output>
            </sage>
            <sage>
                <input>
            7*b
            </input>
                <output>(0)</output>
            </sage>
            <sage>
                <input>
            b.order()
            </input>
                <output>7</output>
            </sage>
            <sage>
                <input>
            c = a - 6*b; c
            </input>
                <output>(3)</output>
            </sage>
            <sage>
                <input>
            c + c + c + c
            </input>
                <output>(12)</output>
            </sage>
            <sage>
                <input>
            c.order()
            </input>
                <output>14</output>
            </sage>

      <p>
        It is possible to create cyclic subgroups,
        from an element designated to be the new generator.
        Unfortunately, to do this requires the <c>.submodule()</c> method
        (which should be renamed in Sage).
      </p>

            <sage>
                <input>H = G.submodule([b]); H</input>
                <output>Additive abelian group isomorphic to Z/7</output>
            </sage>
            <sage>
                <input>H.list()</input>
                <output>[(0), (2), (4), (6), (8), (10), (12)]</output>
            </sage>
            <sage>
                <input>H.order()</input>
                <output>7</output>
            </sage>
            <sage>
                <input>e = H.gen(0); e</input>
                <output>(2)</output>
            </sage>
            <sage>
                <input>3*e</input>
                <output>(6)</output>
            </sage>
            <sage>
                <input>e.order()</input>
                <output>7</output>
            </sage>

      <p>
        The cyclic subgroup <c>H</c> just created has more than one generator.
        We can test this by building a new subgroup and comparing the two subgroups.
      </p>

            <sage>
                <input>f = 12*a; f</input>
                <output>(12)</output>
            </sage>
            <sage>
                <input>f.order()</input>
                <output>7</output>
            </sage>
            <sage>
                <input>K = G.submodule([f]); K</input>
                <output>Additive abelian group isomorphic to Z/7</output>
            </sage>
            <sage>
                <input>K.order()</input>
                <output>7</output>
            </sage>
            <sage>
                <input>K.list()</input>
                <output>[(0), (2), (4), (6), (8), (10), (12)]</output>
            </sage>
            <sage>
                <input>K.gen(0)</input>
                <output>(2)</output>
            </sage>
            <sage>
                <input>H == K</input>
                <output>True</output>
            </sage>

      <p>
        Certainly the list of elements,
        and the common generator of <c>(2)</c> lead us to belive that <c>H</c> and <c>K</c> are the same,
        but the comparison in the last line leaves no doubt.
      </p>

      <p>
        Results in this section,
        especially <xref ref="cyclic-theorem-cyclic-orders"/> and <xref ref="cyclic-corollary-mod-n-generators"/>,
        can be investigated by creating generators of subgroups from a generator of one additive cyclic group,
        creating the subgroups,
        and computing the orders of both elements and orders of groups.
      </p>
    </subsection>

    <subsection>
      <title>Abstract Multiplicative Cyclic Groups</title>
      <p>
        We can create an abstract cyclic group in the style of <xref ref="cyclic-theorem-subgroup"/>,
        <xref ref="cyclic-theorem-abelian"/>, and <xref ref="cyclic-theorem-cyclic-subgroups"/>.
        In the syntax below <c>a</c> is a name for the generator,
        and <c>14</c> is the order of the element.
        Notice that the notation is now multiplicative,
        so we multiply elements, and repeated products can be written as powers.
      </p>

            <sage>
                <input>
            G.&lt;a&gt; = AbelianGroup([14])
            G.order()
            </input>
                <output>14</output>
            </sage>
            <sage>
                <input>G.list()</input>
                <output>(1, a, a^2, a^3, a^4, a^5, a^6, a^7, a^8, a^9, a^10, a^11, a^12, a^13)</output>
            </sage>
            <sage>
                <input>a.order()</input>
                <output>14</output>
            </sage>

      <p>
        Computations in the group are similar to before,
        only with different notation.
        Now products, with repeated products written as exponentiation.
      </p>

            <sage>
                <input>
            b = a^2
            b.order()
            </input>
                <output>7</output>
            </sage>
            <sage>
                <input>b*b*b</input>
                <output>a^6</output>
            </sage>
            <sage>
                <input>
            c = a^7
            c.order()
            </input>
                <output>2</output>
            </sage>
            <sage>
                <input>c^2</input>
                <output>1</output>
            </sage>
            <sage>
                <input>b*c</input>
                <output>a^9</output>
            </sage>
            <sage>
                <input>b^37*c^42</input>
                <output>a^4</output>
            </sage>

      <p>
        Subgroups can be formed with a <c>.subgroup()</c> command.
        But do not try to list the contents of a subgroup,
        it'll look strangely unfamiliar.
        Also, comparison of subgroups is not implemented.
      </p>

            <sage>
                <input>
            H = G.subgroup([a^2])
            H.order()
            </input>
                <output>7</output>
            </sage>
            <sage>
                <input>
            K = G.subgroup([a^12])
            K.order()
            </input>
                <output>7</output>
            </sage>
            <!-- Subgroup equality is buggy, L and H are the subgroup of order 7 -->
            <sage type="hidden">
                <input>
                L = G.subgroup([a^4])
                H == L
            </input>
                <output>False</output>
            </sage>

      <p>
        One advantage of this implementation is the possibility to create all possible subgroups.
        Here we create the list of subgroups, extract one in particular
        (the third),
        and check its order.
      </p>

            <sage>
                <input>
            allsg = G.subgroups(); allsg
            </input>
                <output>
            [Multiplicative Abelian subgroup isomorphic to C2 x C7 generated by {a},
             Multiplicative Abelian subgroup isomorphic to C7 generated by {a^2},
             Multiplicative Abelian subgroup isomorphic to C2 generated by {a^7},
             Trivial Abelian subgroup]
            </output>
            </sage>
            <sage>
                <input>
            sub = allsg[2]
            sub.order()
            </input>
                <output>2</output>
            </sage>
    </subsection>

    <subsection>
      <title>Cyclic Permutation Groups</title>
      <p>
        We will learn more about permutation groups in the next chapter.
        But we will mention here that it is easy to create cyclic groups as permutation groups,
        and a variety of methods are available for working with them,
        even if the actual elements get a bit cumbersome to work with.
        As before, notice that the notation and syntax is multiplicative.
      </p>

            <sage>
                <input>
            G=CyclicPermutationGroup(14)
            a = G.gen(0); a
            </input>
                <output>(1,2,3,4,5,6,7,8,9,10,11,12,13,14)</output>
            </sage>
            <sage>
                <input>
            b = a^2
            b = a^2; b
            </input>
                <output>(1,3,5,7,9,11,13)(2,4,6,8,10,12,14)</output>
            </sage>
            <sage>
                <input>b.order()</input>
                <output>7</output>
            </sage>
            <sage>
                <input>a*a*b*b*b</input>
                <output>(1,9,3,11,5,13,7)(2,10,4,12,6,14,8)</output>
            </sage>
            <sage>
                <input>c = a^37*b^26; c</input>
                <output>(1,6,11,2,7,12,3,8,13,4,9,14,5,10)</output>
            </sage>
            <sage>
                <input>c.order()</input>
                <output>14</output>
            </sage>

      <p>
        We can create subgroups, check their orders, and list their elements.
      </p>

            <sage>
                <input>
            H = G.subgroup([a^2])
            H.order()
            </input>
                <output>7</output>
            </sage>
            <sage>
                <input>H.gen(0)</input>
                <output>(1,3,5,7,9,11,13)(2,4,6,8,10,12,14)</output>
            </sage>
            <sage>
                <input>H.list()</input>
                <output>
            [(),
             (1,3,5,7,9,11,13)(2,4,6,8,10,12,14),
             (1,5,9,13,3,7,11)(2,6,10,14,4,8,12),
             (1,7,13,5,11,3,9)(2,8,14,6,12,4,10),
             (1,9,3,11,5,13,7)(2,10,4,12,6,14,8),
             (1,11,7,3,13,9,5)(2,12,8,4,14,10,6),
             (1,13,11,9,7,5,3)(2,14,12,10,8,6,4)]
            </output>
            </sage>

      <p>
        It could help to visualize this group, and the subgroup,
        as rotations of a regular <m>12</m>-gon with the vertices labeled with the integers <m>1</m> through <m>12</m>.
        This is not the full group of symmetries,
        since it does not include reflections,
        just the <m>12</m> rotations.
      </p>
    </subsection>

    <subsection>
      <title>Cayley Tables</title>
      <p>
        As groups, each of the examples above
        (groups and subgroups)
        have Cayley tables implemented.
        Since the groups are cyclic, and their subgroups are therefore cyclic,
        the Cayley tables should have a similar <q>cyclic</q> pattern.
        Note that the letters used in the default table are generic,
        and are not related to the letters used above for specific elements <mdash/> they just match up with the group elements in the order given by <c>.list()</c>.
      </p>

            <sage>
                <input>
            G.&lt;a&gt; = AbelianGroup([14])
            G.cayley_table()
            </input>
                <output>
            *  a b c d e f g h i j k l m n
             +----------------------------
            a| a b c d e f g h i j k l m n
            b| b c d e f g h i j k l m n a
            c| c d e f g h i j k l m n a b
            d| d e f g h i j k l m n a b c
            e| e f g h i j k l m n a b c d
            f| f g h i j k l m n a b c d e
            g| g h i j k l m n a b c d e f
            h| h i j k l m n a b c d e f g
            i| i j k l m n a b c d e f g h
            j| j k l m n a b c d e f g h i
            k| k l m n a b c d e f g h i j
            l| l m n a b c d e f g h i j k
            m| m n a b c d e f g h i j k l
            n| n a b c d e f g h i j k l m
            </output>
            </sage>

      <p>
        If the real names of the elements are not too complicated,
        the table could be more informative using these names.
      </p>

            <sage>
                <input>
            K.&lt;b&gt; = AbelianGroup([10])
            K.cayley_table(names='elements')
            </input>
                <output>
              *    1   b b^2 b^3 b^4 b^5 b^6 b^7 b^8 b^9
               +----------------------------------------
              1|   1   b b^2 b^3 b^4 b^5 b^6 b^7 b^8 b^9
              b|   b b^2 b^3 b^4 b^5 b^6 b^7 b^8 b^9   1
            b^2| b^2 b^3 b^4 b^5 b^6 b^7 b^8 b^9   1   b
            b^3| b^3 b^4 b^5 b^6 b^7 b^8 b^9   1   b b^2
            b^4| b^4 b^5 b^6 b^7 b^8 b^9   1   b b^2 b^3
            b^5| b^5 b^6 b^7 b^8 b^9   1   b b^2 b^3 b^4
            b^6| b^6 b^7 b^8 b^9   1   b b^2 b^3 b^4 b^5
            b^7| b^7 b^8 b^9   1   b b^2 b^3 b^4 b^5 b^6
            b^8| b^8 b^9   1   b b^2 b^3 b^4 b^5 b^6 b^7
            b^9| b^9   1   b b^2 b^3 b^4 b^5 b^6 b^7 b^8
            </output>
            </sage>
    </subsection>

    <subsection>
      <title>Complex Roots of Unity</title>
      <p>
        The finite cyclic subgroups of <m>{\mathbb T}</m>,
        generated by a primitive <m>n</m>th root of unity are implemented as a more general construction in Sage,
        known as a cyclotomic field.
        If you concentrate on just the multiplication of powers of a generator
        (and ignore the infinitely many other elements)
        then this is a finite cyclic group.
        Since this is not implemented directly in Sage as a group,
        <foreign>per se</foreign>,
        it is a bit harder to construct things like subgroups,
        but it is an excellent exercise to try.
        It is a nice example since the complex numbers are a concrete and familiar construction.
        Here are a few sample calculations to provide you with some exploratory tools.
        See the notes following the computations.
      </p>

            <sage>
                <input>
            G = CyclotomicField(14)
            w = G.gen(0); w
            </input>
                <output>zeta14</output>
            </sage>
            <sage>
                <input>
            wc = CDF(w)
            wc.abs()
            </input>
                <output>1.0</output>
            </sage>
            <sage>
                <input>wc.arg()/N(2*pi/14)</input>
                <output>1.0</output>
            </sage>
            <sage>
                <input>
            b = w^2
            b.multiplicative_order()
            </input>
                <output>7</output>
            </sage>
            <sage>
                <input>bc = CDF(b); bc</input>
                <output>0.62348980185... + 0.781831482468...*I</output>
            </sage>
            <sage>
                <input>bc.abs()</input>
                <output>1.0</output>
            </sage>
            <sage>
                <input>bc.arg()/N(2*pi/14)</input>
                <output>2.0</output>
            </sage>
            <sage>
                <input>sg = [b^i for i in range(7)]; sg</input>
                <output>
            [1, zeta14^2, zeta14^4,
            zeta14^5 - zeta14^4 + zeta14^3 - zeta14^2 + zeta14 - 1,
            -zeta14, -zeta14^3, -zeta14^5]
            </output>
            </sage>
            <sage>
                <input>
            c = sg[3]; d = sg[5]
            c*d
            </input>
                <output>zeta14^2</output>
            </sage>
            <sage>
                <input>
            c = sg[3]; d = sg[6]
            c*d in sg
            </input>
                <output>True</output>
            </sage>
            <sage>
                <input>c*d == sg[2]</input>
                <output>True</output>
            </sage>
            <sage>
                <input>sg[5]*sg[6] == sg[4]</input>
                <output>True</output>
            </sage>
            <sage>
                <input>G.multiplication_table(elements=sg)</input>
                <output>
            *  a b c d e f g
             +--------------
            a| a b c d e f g
            b| b c d e f g a
            c| c d e f g a b
            d| d e f g a b c
            e| e f g a b c d
            f| f g a b c d e
            g| g a b c d e f
            </output>
            </sage>

      <p>
        Notes:

        <ol>
          <li>
            <p>
            <c>zeta14</c> is the name of the generator used for the cyclotomic field,
              it is a primitive root of unity (a <m>14</m>th root of unity in this case).
              We have captured it as <c>w</c>.
            </p>
          </li>

          <li>
            <p>
              The syntax <c>CDF(w)</c> will convert the complex number <c>w</c> into the more familiar form with real and imaginary parts.
            </p>
          </li>

          <li>
            <p>
              The method <c>.abs()</c> will return the modulus of a complex number,
              <m>r</m> as described in the text.
              For elements of <m>{\mathbb C}^\ast</m> this should always equal <m>1</m>.
            </p>
          </li>

          <li>
            <p>
              The method <c>.arg()</c> will return the argument of a complex number,
              <m>\theta</m> as described in the text.
              Every element of the cyclic group in this example should have an argument that is an integer multiple of <m>\frac{2\pi}{14}</m>.
              The <c>N()</c> syntax converts the symbolic value of <c>pi</c> to a numerical approximation.
            </p>
          </li>

          <li>
            <p>
            <c>sg</c> is a list of elements that form a cyclic subgroup of order 7, composed of the first 7 powers of <c>b = w^2</c>.
              So, for example,
              the last comparison multiplies the fifth power of <c>b</c> with the sixth power of <c>b</c>,
              which would be the eleventh power of <c>b</c>.
              But since <c>b</c> has order 7, this reduces to the fourth power.
            </p>
          </li>

          <li>
            <p>
              If you know a subset of an infinite group forms a subgroup,
              then you can produce its Cayley table by specifying the list of elements you want to use.
              Here we ask for a multiplication table,
              since that is the relevant operation.
            </p>
          </li>
        </ol>
      </p>
    </subsection>
  </section>

  <exercises xml:id="cyclic-sage-exercises" component="sage-exercises">
    <title>Sage Exercises</title>
    <introduction>
      <p>
        This group of exercises is about the group of units mod <m>n</m>,
        <m>U(n)</m>, which is sometimes cyclic, sometimes not.
        There are some commands in Sage that will answer some of these questions very quickly,
        but instead of using those now,
        just use the basic techniques described.
        The idea here is to just work with elements,
        and lists of elements, to discern the subgroup structure of these groups.
      </p>

      <p>
        Sage worksheets have extensive capabilities for making new cells with carefully formatted text,
        include support for <latex/> syntax to express mathematics.
        So when a question asks for explanation or commentary,
        make a new cell and communicate clearly with your audience.
        Continue this practice in subsequent exercise sets.
      </p>
    </introduction>

    <exercise number="1" xml:id="cyclic-sage-exercise-integers-40">
      <statement>
        <p>
          Execute the statement <c>R = Integers(40)</c> to create the set <c>[0,1,2,...,39]</c>This is a group under addition mod <m>40</m>,
          which we will ignore.
          Instead we are interested in the subset of elements which have an inverse under
          <em>multiplication</em> mod <m>40</m>.
          Determine how big this subgroup is by executing the command <c>R.unit_group_order()</c>,
          and then obtain a list of these elements with <c>R.list_of_elements_of_multiplicative_group()</c>.
        </p>
      </statement>
    </exercise>

    <exercise number="2" xml:id="cyclic-sage-exercise-u40">
      <statement>
        <p>
          You can create elements of this group by coercing regular integers into <c>U</c>,
          such as with the statement <c>a = U(7)</c>. (Don't confuse this with our mathematical notation <m>U(40)</m>.) This will tell Sage that you want to view <m>7</m> as an element of <m>U</m>,
          subject to the corresponding operations.
          Determine the elements of the cyclic subgroup of <m>U</m> generated by <m>7</m> with a list comprehension as follows:
        </p>

            <sage type="display">
                <input>
            R = Integers(40)
            a = R(7)
            [a^i for i in srange(16)]
            </input>
            </sage>

        <p>
          What is the order of <m>7</m> in <m>U(40)</m>?
        </p>
      </statement>
    </exercise>

    <exercise number="3" xml:id="cyclic-sage-exercise-u49">
      <statement>
        <p>
          The group <m>U(49)</m> is cyclic.
          Using only the Sage commands described previously,
          use Sage to find a generator for this group.
          Now using <em>only</em> theorems about the structure of cyclic groups,
          describe each of the subgroups of <m>U(49)</m> by specifying its order and by giving an explicit generator.
          Do not repeat any of the subgroups <mdash/> in other words,
          present each subgroup <em>exactly</em> once.
          You can use Sage to check your work on the subgroups,
          but your answer about the subgroups should rely only on theorems and be a nicely written paragraph with a table, etc.
        </p>
      </statement>
    </exercise>

    <exercise number="4" xml:id="cyclic-sage-exercise-u35">
      <statement>
        <p>
          The group <m>U(35)</m> is not cyclic.
          Again, using only the Sage commands described previously,
          use computations to provide irrefutable evidence of this.
          How many of the <m>16</m> different subgroups of <m>U(35)</m> can you list?
        </p>
      </statement>
    </exercise>

    <exercise number="5" xml:id="cyclic-sage-exercise-un">
      <statement>
        <p>
          Again, using only the Sage commands described previously,
          explore the structure of <m>U(n)</m> for various values of <m>n</m> and see if you can formulate an interesting conjecture about some basic property of this group.
          (Yes, this is a <em>very</em> open-ended question,
          but this is ultimately the real power of exploring mathematics with Sage.)
        </p>
      </statement>
    </exercise>

  </exercises>
</chapter>
