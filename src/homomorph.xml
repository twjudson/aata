<?xml version="1.0"?>
<!-- This file is part of the book                    -->
<!--                                                  -->
<!-- Abstract Algebra: Theory and Applications        -->
<!--                                                  -->
<!-- Text: Copyright (C) 1997-2024  Thomas W. Judson  -->
<!-- Sage: Copyright (C) 2010-2024  Robert A. Beezer  -->
<!-- See the file COPYING for copying conditions.     -->
<!-- This file is part of the book                    -->
<!--                                                  -->
<!-- See the file COPYING for copying conditions.     -->
<chapter xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="homomorph">
  <title>Homomorphisms</title>
  <introduction>
    <p>
      One of the basic ideas of algebra is the concept of a homomorphism,
      a natural generalization of an isomorphism.
      If we relax the requirement that an isomorphism of groups be bijective,
      we have a homomorphism.
    </p>
  </introduction>
    <!-- % TWJ, 2010/03/31 -->
    <!-- % The chapter HOMOMORPHISMS AND FACTOR GROUPS is now -->
    <!-- % two chapters: (10) NORMAL SUBGROUPS AND FACTOR GROUPS -->
    <!-- % (11) HOMOMORPHISMS -->
  <section xml:id="homomorph-section-group-homomorphisms">
    <title>Group Homomorphisms</title>
    <p>
      A <term>homomorphism</term><idx><h>Group</h><h>homomorphism of</h></idx><idx><h>Homomorphism</h><h>of groups</h></idx> between groups <m>(G, \cdot)</m> and
      <m>(H, \circ)</m> is a map <m>\phi :G \rightarrow H</m> such that
      <me>
        \phi( g_1 \cdot g_2 ) = \phi( g_1 ) \circ \phi( g_2 )
      </me>
      for <m>g_1, g_2 \in G</m>.
      The range of <m>\phi</m> in <m>H</m> is called the
      <term>homomorphic image</term><idx><h>Homomorphic image</h></idx>
      of <m>\phi</m>.
    </p>

    <p>
      Two groups are related in the strongest possible way if they are isomorphic;
      however, a weaker relationship may exist between two groups.
      For example, the symmetric group <m>S_n</m> and the group
      <m>{\mathbb Z}_2</m> are related by the fact that <m>S_n</m> can be divided into even and odd permutations that exhibit a group structure like that <m>{\mathbb Z}_2</m>,
      as shown in the following multiplication table.
    </p>

    <p>
      <me>
        \begin{array}{c|cc}
        &amp; \text{even} &amp; \text{odd} \\ \hline
        \text{even} &amp; \text{even} &amp; \text{odd} \\
        \text{odd}  &amp; \text{odd}  &amp; \text{even}
        \end{array}
      </me>
    </p>

    <p>
      We use homomorphisms to study relationships such as the one we have just described.
    </p>

    <example xml:id="homomorph-example-zn">
      <p>
        Let <m>G</m> be a group and <m>g \in G</m>.
        Define a map <m>\phi : {\mathbb Z} \rightarrow G</m> by <m>\phi( n ) = g^n</m>.
        Then <m>\phi</m> is a group homomorphism, since
        <me>
          \phi( m + n ) = g^{ m + n} = g^m g^n = \phi( m ) \phi( n )
        </me>.
        This homomorphism maps <m>{\mathbb Z}</m> onto the cyclic subgroup of <m>G</m> generated by <m>g</m>.
      </p>
    </example>

    <example xml:id="homomorph-example-gl2">
      <p>
        Let <m>G = GL_2( {\mathbb R })</m>.
        If
        <me>
          A =
          \begin{pmatrix}
          a &amp; b \\
          c &amp; d
          \end{pmatrix}
        </me>
        is in <m>G</m>, then the determinant is  nonzero;
        that is, <m>\det(A) = ad - bc \neq 0</m>.
        Also, for any two elements <m>A</m> and <m>B</m> in <m>G</m>,
        <m>\det(AB) = \det(A) \det(B)</m>.
        Using the determinant, we can define a homomorphism
        <m>\phi : GL_2( {\mathbb R }) \rightarrow {\mathbb R}^\ast</m> by <m>A \mapsto \det(A)</m>.
      </p>
    </example>

    <example xml:id="homomorph-example-circle-group">
      <p>
        Recall that the circle group
        <m>{ \mathbb T}</m> consists of all complex numbers <m>z</m> such that <m>|z|=1</m>.
        We can define a homomorphism <m>\phi</m> from the additive group of real numbers <m>{\mathbb R}</m> to
        <m>{\mathbb T}</m> by <m>\phi : \theta \mapsto \cos \theta + i \sin \theta</m>.
        Indeed,
        <md>
          <mrow>\phi( \alpha + \beta ) &amp; = \cos( \alpha + \beta ) + i \sin( \alpha + \beta )</mrow>
          <mrow>&amp; = (\cos \alpha \cos \beta - \sin \alpha \sin \beta)  + i( \sin \alpha  \cos \beta + \cos \alpha \sin \beta )</mrow>
          <mrow>&amp; = (\cos \alpha + i \sin \alpha )(\cos \beta + i \sin \beta)</mrow>
          <mrow>&amp; = \phi( \alpha ) \phi( \beta )</mrow>
        </md>.
        Geometrically,
        we are simply wrapping the real line around the circle in a group-theoretic fashion.
      </p>
    </example>

    <p>
      The following proposition lists some basic properties of group homomorphisms.
    </p>

    <proposition xml:id="homomorph-proposition-homorphism-subgroup">
      <statement>
        <p>
          Let <m>\phi : G_1 \rightarrow G_2</m> be a homomorphism of groups.
          Then

          <ol>
            <li>
              <p>
                If <m>e</m> is the identity of <m>G_1</m>,
                then <m>\phi( e)</m> is the identity of <m>G_2</m>;
              </p>
            </li>

            <li>
              <p>
                For any element <m>g \in G_1</m>,
                <m>\phi( g^{-1}) = [\phi( g )]^{- 1}</m>;
              </p>
            </li>

            <li>
              <p>
                If <m>H_1</m> is a subgroup of <m>G_1</m>,
                then <m>\phi( H_1 )</m> is a subgroup of <m>G_2</m>;
              </p>
            </li>

            <li>
              <p>
                If <m>H_2</m> is a subgroup of <m>G_2</m>,
                then <m>\phi^{-1}(H_2) = \{ g \in G _1: \phi(g) \in H_2 \}</m> is a subgroup of <m>G_1</m>.
                Furthermore, if <m>H_2</m> is normal in <m>G_2</m>,
                then <m>\phi^{-1}(H_2)</m> is normal in <m>G_1</m>.
              </p>
            </li>
<!-- % TWJ, 2011/09/15 --><!-- % Changed G to G_1 --><!-- % Suggested by Tony Perkins -->
          </ol>
        </p>
      </statement>

      <proof>
        <p>
          (1) Suppose that <m>e</m> and <m>e'</m> are the identities of <m>G_1</m> and <m>G_2</m>,
          respectively; then
          <me>
            e' \phi(e) = \phi(e) = \phi(e e) = \phi(e) \phi(e)
          </me>.
          By cancellation, <m>\phi(e) = e'</m>.
        </p>

        <p>
          (2) This statement follows from the fact that
          <me>
            \phi( g^{-1}) \phi(g) = \phi(g^{-1} g) = \phi(e) = e'
          </me>.
        </p>
            <!--  Corrected notation error.  Suggested by P. Diethelm.  TWJ 16/8/2013. -->
        <p>
          (3) The set <m>\phi(H_1)</m> is nonempty since the identity of <m>G_2</m> is in <m>\phi(H_1)</m>.
          Suppose that <m>H_1</m> is a subgroup of <m>G_1</m> and let <m>x</m> and <m>y</m> be in <m>\phi(H_1)</m>.
          There exist elements <m>a,
          b \in H_1</m> such that <m>\phi(a) = x</m> and <m>\phi(b)=y</m>.
          Since
          <me>
            xy^{-1} = \phi(a)[ \phi(b)]^{-1} = \phi(a b^{-1} ) \in \phi(H_1)
          </me>,
          <m>\phi(H_1)</m> is a subgroup of <m>G_2</m> by <xref ref="groups-proposition-subgroup"/>.
        </p>
            <!-- H_2 changed to G_2 in proof.  Suggested by K. Wenholz. -->
            <!-- TWJ - 12/19/2011 -->
        <p>
          (4) Let <m>H_2</m> be a subgroup of <m>G_2</m> and define <m>H_1</m> to be <m>\phi^{-1}(H_2)</m>;
          that is, <m>H_1</m> is the set of all
          <m>g \in G_1</m> such that <m>\phi(g) \in H_2</m>.
          The identity is in <m>H_1</m> since <m>\phi(e) = e'</m>.
          If <m>a</m> and <m>b</m> are in <m>H_1</m>,
          then <m>\phi(ab^{-1}) = \phi(a)[ \phi(b) ]^{-1}</m> is in <m>H_2</m> since <m>H_2</m> is a subgroup of <m>G_2</m>.
          Therefore, <m>ab^{-1} \in H_1</m> and <m>H_1</m> is a subgroup of <m>G_1</m>.
          If <m>H_2</m> is normal in <m>G_2</m>,
          we must show that <m>g^{-1} h g \in H_1</m> for
          <m>h \in H_1</m> and <m>g \in G_1</m>.
          But
          <me>
            \phi( g^{-1} h g) = [ \phi(g) ]^{-1} \phi( h ) \phi( g ) \in H_2
          </me>,
          since <m>H_2</m> is a normal subgroup of <m>G_2</m>.
          Therefore, <m>g^{-1}hg \in H_1</m>.
        </p>
      </proof>
    </proposition>

    <p>
      Let <m>\phi : G \rightarrow H</m> be a group homomorphism and suppose that <m>e</m> is the identity of <m>H</m>.
      By <xref ref="homomorph-proposition-homorphism-subgroup"/>,
      <m>\phi^{-1} ( \{ e \} )</m> is a subgroup of <m>G</m>.
      This subgroup is called the <term>kernel</term><idx><h>Kernel</h><h>of a group homomorphism</h></idx><idx><h>Homomorphism</h><h>kernel of a group</h></idx> of <m>\phi</m> and will be denoted by <m>\ker \phi</m>.

      <notation>
        <usage><m>\ker \phi</m></usage>
        <description>kernel of <m>\phi</m></description>
      </notation>

      In fact, this subgroup is a normal subgroup of <m>G</m> since the trivial subgroup is normal in <m>H</m>.
      We state this result in the following theorem,
      which says that with every homomorphism of groups we can naturally associate a normal subgroup.
    </p>

    <theorem>
      <statement>
        <p>
          Let <m>\phi : G \rightarrow H</m> be a group homomorphism.
          Then the kernel of <m>\phi</m> is a normal subgroup of <m>G</m>.
        </p>
      </statement>
    </theorem>

    <example xml:id="homomorph-example-g2-to-r">
      <p>
        Let us examine the homomorphism
        <m>\phi : GL_2( {\mathbb R }) \rightarrow {\mathbb R}^\ast</m> defined by <m>A \mapsto \det( A )</m>.
        Since <m>1</m> is the identity of <m>{\mathbb R}^\ast</m>,
        the kernel of this homomorphism is all
        <m>2 \times 2</m> matrices having determinant one.
        That is, <m>\ker \phi = SL_2( {\mathbb R })</m>.
      </p>
    </example>

    <example xml:id="homomorph-example-kernel">
      <p>
        The kernel of the group homomorphism <m>\phi : {\mathbb R} \rightarrow {\mathbb C}^\ast</m> defined by
        <m>\phi( \theta ) = \cos \theta + i \sin \theta</m> is <m>\{ 2 \pi n : n \in {\mathbb Z} \}</m>.
        Notice that <m>\ker \phi \cong {\mathbb Z}</m>.
      </p>
    </example>

    <example xml:id="homomorph-example-z7">
      <p>
        Suppose that we wish to determine all possible homomorphisms <m>\phi</m> from
        <m>{\mathbb Z}_7</m> to <m>{\mathbb Z}_{12}</m>.
        Since the kernel of <m>\phi</m> must be a subgroup of <m>{\mathbb Z}_7</m>,
        there are only two possible kernels,
        <m>\{ 0 \}</m> and all of <m>{\mathbb Z}_7</m>.
        The image of a subgroup of
        <m>{\mathbb Z}_7</m> must be a subgroup of <m>{\mathbb Z}_{12}</m>.
        Hence, there is no injective homomorphism;
        otherwise, <m>{\mathbb Z}_{12}</m> would have a subgroup of order <m>7</m>,
        which is impossible.
        Consequently,
        the only possible homomorphism from <m>{\mathbb Z}_7</m> to
        <m>{\mathbb Z}_{12}</m> is the one mapping all elements to zero.
      </p>
    </example>

    <example xml:id="homomorph-example-gn">
      <p>
        Let <m>G</m> be a group.
        Suppose that <m>g \in G</m> and <m>\phi</m> is the homomorphism from
        <m>{\mathbb Z}</m> to <m>G</m> given by <m>\phi( n ) = g^n</m>.
        If the order of <m>g</m> is infinite,
        then the kernel of this homomorphism is <m>\{ 0 \}</m> since <m>\phi</m> maps
        <m>{\mathbb Z}</m> onto the cyclic subgroup of <m>G</m> generated by <m>g</m>.
        However, if the order of <m>g</m> is finite,
        say <m>n</m>,
        then the kernel of <m>\phi</m> is <m>n {\mathbb Z}</m>.
      </p>
    </example>
  </section>

  <section xml:id="homomorph-section-group-isomorphism-theorems">
    <title>The Isomorphism Theorems</title>
    <p>
      Although it is not evident at first,
      factor groups correspond exactly to homomorphic images,
      and we can use factor groups to study homomorphisms.
      We already know that with every group homomorphism
      <m>\phi: G \rightarrow H</m> we can associate a normal subgroup of <m>G</m>,
      <m>\ker \phi</m>.
      The converse is also true; that is,
      every normal subgroup of a group <m>G</m> gives rise to homomorphism of groups.
    </p>

    <p>
      Let <m>H</m> be a normal subgroup of <m>G</m>.
      Define the <term>natural</term><idx><h>Homomorphism</h><h>natural</h></idx> or
      <term>canonical homomorphism</term><idx><h>Homomorphism</h><h>canonical</h></idx>
      <me>
        \phi : G \rightarrow G/H
      </me>
      by
      <me>
        \phi(g) = gH
      </me>.
      This is indeed a homomorphism, since
      <me>
        \phi( g_1 g_2 ) = g_1 g_2 H =  g_1 H g_2 H = \phi( g_1) \phi( g_2 )
      </me>.
      The kernel of this homomorphism is <m>H</m>.
      The following theorems describe the relationships between group homomorphisms,
      normal subgroups, and factor groups.
    </p>

    <theorem xml:id="homomorph-theorem-first-isomorphism">
      <title>First Isomorphism Theorem</title>
      <idx>
      <h>First Isomorphism Theorem</h>
      <h>for groups</h>
      </idx>
      <statement>
        <p>
          If <m>\psi : G \rightarrow H</m> is a group homomorphism with <m>K =\ker \psi</m>,
          then <m>K</m> is normal in <m>G</m>.
          Let <m>\phi: G \rightarrow G/K</m> be the canonical homomorphism.
          Then there exists a unique isomorphism
          <m>\eta: G/K \rightarrow \psi(G)</m> such that <m>\psi = \eta \phi</m>.
        </p>
      </statement>

      <proof>
        <p>
          We already know that <m>K</m> is normal in <m>G</m>.
          Define <m>\eta: G/K \rightarrow \psi(G)</m> by <m>\eta(gK) = \psi(g)</m>.
          We first show that <m>\eta</m> is a well-defined map.
          If <m>g_1 K =g_2 K</m>, then for some <m>k \in K</m>,
          <m>g_1 k=g_2</m>; consequently,
          <me>
            \eta(g_1 K) = \psi(g_1) = \psi(g_1) \psi(k) = \psi(g_1k) = \psi(g_2) = \eta(g_2 K)
          </me>.
          Thus, <m>\eta</m> does not depend on the choice of coset representatives and the map
          <m>\eta: G/K \rightarrow \psi(G)</m> is uniquely defined since <m>\psi =  \eta \phi</m>.
          We must also show that <m>\eta</m> is a homomorphism. Indeed,
          <md>
            <mrow>\eta( g_1K g_2K ) &amp; = \eta(g_1 g_2K)</mrow>
            <mrow>&amp; = \psi(g_1 g_2)</mrow>
            <mrow>&amp; = \psi(g_1) \psi(g_2)</mrow>
            <mrow>&amp; = \eta( g_1K) \eta( g_2K )</mrow>
          </md>.
          Clearly, <m>\eta</m> is onto <m>\psi( G)</m>.
          To show that <m>\eta</m> is one-to-one,
          suppose that <m>\eta(g_1 K) = \eta(g_2 K)</m>.
          Then <m>\psi(g_1) = \psi(g_2)</m>.
          This implies that <m>\psi( g_1^{-1} g_2 ) = e</m>,
          or <m>g_1^{-1} g_2</m> is in the kernel of <m>\psi</m>;
          hence, <m>g_1^{-1} g_2K = K</m>;
          that is, <m>g_1K =g_2K</m>.
        </p>
      </proof>
    </theorem>
        <!--  Proof rewritten for clarification.  Suggested by P. Diethelm.  TWJ 16/8/2013. -->
    <p>
      Mathematicians often use diagrams called
      <term>commutative diagrams</term><idx><h>Commutative diagrams</h></idx>
      to describe such theorems.
      The following diagram <q>commutes</q>
      since <m>\psi = \eta \phi</m>.
    </p>

    <image width="40%" xml:id="homomorphs-first-isomorphism">
          <description>A diagram with G mapped with an arrow to H by psi on the top row.  G gets mapped with an arrow down and right to G/K by phi.  G/K gets mapped with an arrow up and right to H by eta. </description>
          <latex-image>
              <xi:include href="tikz/homomorphs-first-isomorphism.tex" parse="text"/>
          </latex-image>
    </image>

    <example xml:id="homo_cyclic">
      <p>
        Let <m>G</m> be a cyclic group with generator <m>g</m>.
        Define a map <m>\phi : {\mathbb Z} \rightarrow G</m> by <m>n \mapsto g^n</m>.
        This map is a surjective homomorphism since
        <me>
          \phi( m + n) = g^{m+n} = g^m g^n = \phi(m) \phi(n)
        </me>.
        Clearly <m>\phi</m> is onto.
        If <m>|g| = m</m>, then  <m>g^m = e</m>.
        Hence, <m>\ker \phi = m {\mathbb Z}</m> and <m>{\mathbb Z} / \ker \phi =  {\mathbb Z} / m {\mathbb Z} \cong G</m>.
        On the other hand, if the order of <m>g</m> is infinite,
        then <m>\ker \phi = 0</m> and <m>\phi</m> is an isomorphism of <m>G</m> and <m>{\mathbb Z}</m>.
        Hence, two cyclic groups are isomorphic exactly when they have the same order.
        Up to isomorphism, the only cyclic groups are
        <m>{\mathbb Z}</m> and <m>{\mathbb Z}_n</m>.
      </p>
    </example>

    <theorem xml:id="homomorph-theorem-second-isomorphism">
      <title>Second Isomorphism Theorem</title>
      <idx>
      <h>Second Isomorphism Theorem</h>
      <h>for groups</h>
      </idx>
      <statement>
        <p>
          Let  <m>H</m> be a subgroup of a group <m>G</m>
          (not necessarily normal in <m>G</m>)
          and <m>N</m> a normal subgroup of <m>G</m>.
          Then <m>HN</m> is a subgroup of <m>G</m>,
          <m>H \cap N</m> is a normal subgroup of <m>H</m>, and
          <me>
            H / H \cap N \cong HN /N
          </me>.
        </p>
      </statement>

      <proof>
        <p>
          We will first show that <m>HN = \{ hn : h \in H, n \in N \}</m> is a subgroup of <m>G</m>.
          Suppose that  <m>h_1 n_1, h_2 n_2 \in HN</m>.
          Since <m>N</m> is normal, <m>(h_2)^{-1} n_1 h_2 \in N</m>.
          So
          <me>
            (h_1 n_1)(h_2 n_2) = h_1 h_2 ( (h_2)^{-1} n_1 h_2 )n_2
          </me>
          is in <m>HN</m>.
          The inverse of <m>hn \in HN</m> is in <m>HN</m> since
          <me>
            ( hn )^{-1} = n^{-1 } h^{-1} = h^{-1} (h n^{-1} h^{-1} )
          </me>.
        </p>

        <p>
          Next, we prove that <m>H \cap N</m> is normal in <m>H</m>.
          Let <m>h \in H</m> and <m>n \in H \cap N</m>.
          Then <m>h^{-1} n h \in H</m> since each element is in <m>H</m>.
          Also, <m>h^{-1} n h \in N</m> since <m>N</m> is normal in <m>G</m>;
          therefore, <m>h^{-1} n h \in H \cap N</m>.
        </p>

        <p>
          Now define a map <m>\phi</m> from <m>H</m> to <m> HN / N</m> by <m>h \mapsto h N</m>.
          The map <m>\phi</m> is onto,
          since any coset <m>h n N = h N</m> is the image of <m>h</m> in <m>H</m>.
          We also know that <m>\phi</m> is a homomorphism because
          <me>
            \phi( h  h')  = h h' N =  h N h' N =  \phi( h ) \phi( h')
          </me>.
          By the First Isomorphism Theorem,
          the image of <m>\phi</m> is isomorphic to <m>H / \ker \phi</m>; that is,
          <me>
            HN/N = \phi(H) \cong H / \ker \phi
          </me>.
          Since
          <me>
            \ker \phi = \{ h \in H : h \in N \} = H \cap N
          </me>,
          <m>HN/N = \phi(H) \cong H / H \cap N</m>.
        </p>
      </proof>
    </theorem>

    <theorem xml:id="homomorph-theorem-correspondence">
      <title>Correspondence Theorem</title>
      <idx>
      <h>Correspondence Theorem</h>
      <h>for groups</h>
      </idx>
      <statement>
        <p>
          Let <m>N</m> be a normal subgroup of a group <m>G</m>.
          Then <m>H \mapsto H/N</m> is a one-to-one correspondence between the set of subgroups <m>H</m> of <m>G</m> containing <m>N</m> and the set of subgroups of <m>G/N</m>.
          Furthermore,
          the normal subgroups of <m>G</m> containing <m>N</m> correspond to normal subgroups of <m>G/N</m>.
        </p>
      </statement>

      <proof>
        <p>
          Let <m>H</m> be a subgroup of <m>G</m> containing <m>N</m>.
          Since <m>N</m> is normal in <m>H</m>, <m>H/N</m> is a factor group.
          Let <m>aN</m> and <m>bN</m> be elements of <m>H/N</m>.
          Then <m>(aN)( b^{-1} N )= ab^{-1}N \in H/N</m>;
          hence, <m>H/N</m> is a subgroup of <m>G/N</m>.
        </p>

        <p>
          Let <m>S</m> be a subgroup of <m>G/N</m>.
          This subgroup is a set of cosets of <m>N</m>.
          If <m>H= \{ g \in G : gN \in S \}</m>,
          then for <m>h_1, h_2 \in H</m>,
          we have that <m>(h_1 N)( h_2 N )= h_1 h_2 N \in S</m> and <m>h_1^{-1} N \in S</m>.
          Therefore, <m>H</m> must be a subgroup of <m>G</m>.
          Clearly, <m>H</m> contains <m>N</m>.
          Therefore, <m>S = H / N</m>.
          Consequently, the map <m>H \mapsto H/N</m> is onto.
        </p>
            <!--  Notation error corrected.  Suggested by P. Diethelm.  TWJ 16/8/2013. -->
        <p>
          Suppose that <m>H_1</m> and <m>H_2</m> are subgroups of <m>G</m> containing <m>N</m> such that <m>H_1/N = H_2/N</m>.
          If <m>h_1 \in H_1</m>, then <m>h_1 N \in H_1/N</m>.
          Hence, <m>h_1 N = h_2 N \subset H_2</m> for some <m>h_2</m> in <m>H_2</m>.
          However, since <m>N</m> is contained in <m>H_2</m>,
          we know that <m>h_1 \in H_2</m> or <m>H_1 \subset H_2</m>.
          Similarly, <m>H_2 \subset H_1</m>.
          Since <m>H_1 = H_2</m>, the map <m>H \mapsto H/N</m> is one-to-one.
        </p>
            <!-- H/N changed to N/H.  Suggested by S. Engle. -->
            <!-- TWJ - 12/19/2011 -->
            <!-- Changed it back.  What was I thinking?  Suggested by R. Beezer. -->
            <!-- TWJ - 11/29/2012 -->
        <p>
          Suppose that <m>H</m> is normal in <m>G</m> and <m>N</m> is a subgroup of <m>H</m>.
          Then it is easy to verify that the map
          <m>G/N \rightarrow G/H</m> defined by <m>gN \mapsto gH</m> is a homomorphism.
          The kernel of this homomorphism is <m>H/N</m>,
          which proves that <m>H/N</m> is normal in <m>G/N</m>.
        </p>

        <p>
          Conversely, suppose that <m>H/N</m> is normal in <m>G/N</m>.
          The homomorphism given by
          <me>
            G \rightarrow G/N \rightarrow \frac{G/N}{H/N}
          </me>
          has kernel <m>H</m>.
          Hence, <m>H</m> must be normal in <m>G</m>.
        </p>
      </proof>
    </theorem>
        <!--  Statement of the Correspondence Theorem corrected.  Suggested by P. Diethelm.  TWJ 16/8/2013. -->
    <p>
      Notice that in the course of the proof of <xref ref="homomorph-theorem-correspondence"/>, we have also proved the following theorem.
    </p>

    <theorem xml:id="homomorph-theorem-third-isomorphism">
      <title>Third Isomorphism Theorem</title>
      <idx>
      <h>Third Isomorphism Theorem</h>
      <h>for groups</h>
      </idx>
      <statement>
        <p>
          Let <m>G</m> be a group and <m>N</m> and <m>H</m> be normal subgroups of <m>G</m> with <m>N \subset H</m>.
          Then
          <me>
            G/H \cong \frac{G/N}{H/N}
          </me>.
        </p>
      </statement>
    </theorem>

    <example xml:id="homomorph-example-third-isomorphism">
      <p>
        By the Third Isomorphism Theorem,
        <me>
          {\mathbb Z} / m {\mathbb Z} \cong ({\mathbb Z}/ mn {\mathbb Z})/ (m {\mathbb Z}/ mn {\mathbb Z})
        </me>.
        Since <m>| {\mathbb Z} / mn {\mathbb Z} | = mn</m> and  <m>|{\mathbb Z} / m{\mathbb Z}| = m</m>,
        we have <m>| m {\mathbb Z} / mn {\mathbb Z}| = n</m>.
      </p>
    </example>

    <paragraphs component="sage-blurb">
      <title>Sage</title>
      <p>
        Sage can create homomorphisms between groups,
        which can be used directly as functions,
        and then queried for their kernels and images.
        So there is great potential for exploring the many fundamental relationships between groups,
        normal subgroups, quotient groups and properties of homomorphisms.
      </p>
    </paragraphs>
  </section>

  
  <reading-questions>

    <exercise>
      <statement>
        <p>
          Consider the function <m>\phi:\mathbb Z_{10}\rightarrow\mathbb Z_{10}</m> defined by <m>\phi(x)=x+x</m>.
          Prove that <m>\phi</m> is a group homomorphism.
        </p>
      </statement>
      <response/>
    </exercise>

    <exercise>
      <statement>
        <p>
          For <m>\phi</m> defined in the previous question,
          explain why <m>\phi</m> is not a group isomorphism.
        </p>
      </statement>
      <response/>
    </exercise>

    <exercise>
      <statement>
        <p>
          Compare and contrast isomorphisms and homomorphisms.
        </p>
      </statement>
      <response/>
    </exercise>

    <exercise>
      <statement>
        <p>
          Paraphrase the First Isomorphism Theorem using <em>only words</em>.
          No symbols allowed <em>at all</em>.
        </p>
      </statement>
      <response/>
    </exercise>

    <exercise>
      <statement>
        <p>
          <q>For every normal subgroup there is a homomorphism,
          and for every homomorphism there is a normal subgroup.</q>
          Explain the (precise) basis for this (vague) statement.
        </p>
      </statement>
      <response/>
    </exercise>

  </reading-questions>
    <!-- Exercises with Solutions  -->
    <!-- File: homomorph.xml  -->
    <!-- Title: Homomorphisms -->
  <exercises xml:id="homomorph-exercises" filenamebase="homomorph">
    <title>Exercises</title>

    <exercise number="1"  xml:id="homomorph-exercise-det-homomorph">
      <statement>
        <p>
          Prove that <m>\det( AB) = \det(A) \det(B)</m> for <m>A, B \in GL_2( {\mathbb R} )</m>.
          This shows that the determinant is a homomorphism from
          <m>GL_2( {\mathbb R} )</m> to <m>{\mathbb R}^*</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="2"  xml:id="homomorph-exercise-which-are-homomorph">
      <statement>
        <p>
          Which of the following maps are homomorphisms?
          If the map is a homomorphism, what is the kernel?

          <ol>
            <li>
              <p>
                <m>\phi : {\mathbb R}^\ast \rightarrow GL_2 ( {\mathbb R})</m> defined by
                <me>
                  \phi( a ) =
                  \begin{pmatrix}
                  1 &amp; 0 \\
                  0 &amp; a
                  \end{pmatrix}
                </me>
              </p>
            </li>

            <li>
              <p>
                <m>\phi : {\mathbb R} \rightarrow GL_2 ( {\mathbb R})</m> defined by
                <me>
                  \phi( a ) =
                  \begin{pmatrix}
                  1 &amp; 0 \\
                  a &amp; 1
                  \end{pmatrix}
                </me>
              </p>
            </li>

            <li>
              <p>
                <m>\phi : GL_2 ({\mathbb R})   \rightarrow {\mathbb R}</m> defined by
                <me>
                  \phi
                  \left(
                  \begin{pmatrix}
                  a &amp; b \\
                  c &amp; d
                  \end{pmatrix}
                  \right)
                  = a + d
                </me>
              </p>
            </li>

            <li>
              <p>
                <m>\phi : GL_2 ( {\mathbb R})   \rightarrow {\mathbb R}^\ast</m> defined by
                <me>
                  \phi
                  \left(
                  \begin{pmatrix}
                  a &amp; b \\
                  c &amp; d
                  \end{pmatrix}
                  \right)
                  = ad - bc
                </me>
              </p>
            </li>

            <li>
              <p>
                <m>\phi : {\mathbb M}_2( {\mathbb R}) \rightarrow {\mathbb R}</m> defined by
                <me>
                  \phi
                  \left(
                  \begin{pmatrix}
                  a &amp; b \\
                  c &amp; d
                  \end{pmatrix}
                  \right)
                  = b
                </me>,
                where <m>{\mathbb M}_2( {\mathbb R})</m> is the additive group of
                <m>2 \times 2</m> matrices with entries in <m>{\mathbb R}</m>.
              </p>
            </li>
          </ol>
        </p>
      </statement>
      <hint>
        <p>
          (a) is a homomorphism with kernel <m>\{ 1 \}</m>; (c) is not a homomorphism.
        </p>
      </hint>
    </exercise>

    <exercise number="3"  xml:id="homomorph-exercise-matrix-mult">
      <statement>
        <p>
          Let <m>A</m> be an <m>m \times n</m> matrix.
          Show that matrix multiplication, <m>x \mapsto Ax</m>,
          defines a homomorphism <m>\phi : {\mathbb R}^n \rightarrow {\mathbb R}^m</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="4"  xml:id="homomorph-exercise-n-to-7n">
      <statement>
        <p>
          Let <m>\phi : {\mathbb Z} \rightarrow {\mathbb Z}</m> be given by <m>\phi(n) = 7n</m>.
          Prove that <m>\phi</m> is a group homomorphism.
          Find the kernel and the image of <m>\phi</m>.
        </p>
      </statement>
      <hint>
        <p>
          Since <m>\phi(m + n) = 7(m+n) = 7m + 7n = \phi(m) + \phi(n)</m>,
          <m>\phi</m> is a homomorphism.
        </p>
      </hint>
    </exercise>

    <exercise number="5"  xml:id="homomorph-exercise-Z24-to-Z18">
      <statement>
        <p>
          Describe all of the homomorphisms from
          <m>{\mathbb Z}_{24}</m> to <m>{\mathbb Z}_{18}</m>.
        </p>
      </statement>
      <hint>
        <p>
          For any homomorphism <m>\phi : {\mathbb Z}_{24} \rightarrow {\mathbb Z}_{18}</m>,
          the kernel of <m>\phi</m> must be a subgroup of
          <m>{\mathbb Z}_{24}</m> and the image of <m>\phi</m> must be a subgroup of <m>{\mathbb Z}_{18}</m>.
          Now use the fact that a generator must map to a generator.
        </p>
      </hint>
    </exercise>

    <!--Todo Fix the solution to Exercise 5.-->

    <exercise number="6"  xml:id="homomorph-exercise-Z-to-Z12">
      <statement>
        <p>
          Describe all of the homomorphisms from
          <m>{\mathbb Z}</m> to <m>{\mathbb Z}_{12}</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="7"  xml:id="homomorph-exercise-second-isomorph-ther">
      <statement>
        <p>
          In the group <m>{\mathbb Z}_{24}</m>,
          let <m>H = \langle 4 \rangle</m> and <m>N = \langle 6 \rangle</m>.

          <ol>
            <li>
              <p>
                List the elements in <m>HN</m>
                (we usually write <m>H + N</m> for these additive groups)
                and <m>H \cap N</m>.
              </p>
            </li>

            <li>
              <p>
                List the cosets in <m>HN/N</m>,
                showing the elements in each coset.
              </p>
            </li>

            <li>
              <p>
                List the cosets in <m>H/(H \cap N)</m>,
                showing the elements in each coset.
              </p>
            </li>

            <li>
              <p>
                Give the correspondence between <m>HN/N</m> and
                <m>H/(H \cap N)</m> described in the proof of the Second Isomorphism Theorem.
              </p>
            </li>
          </ol>
        </p>
      </statement>
    </exercise>

    <!--Todo Double check the solution to Exercise 7.-->

    <exercise number="8"  xml:id="homomorph-exercise-g-to-gn">
      <statement>
        <p>
          If <m>G</m> is an abelian group and <m>n \in {\mathbb N}</m>,
          show that <m>\phi : G \rightarrow G</m> defined by
          <m>g \mapsto g^n</m> is a group homomorphism.
        </p>
      </statement>
    </exercise>

    <exercise number="9"  xml:id="homomorph-exercise-phi-G-abelian">
      <statement>
        <p>
          If <m>\phi : G \rightarrow H</m> is a group homomorphism and <m>G</m> is abelian,
          prove that <m>\phi(G)</m> is also abelian.
        </p>
      </statement>
      <hint>
        <p>
          Let <m>a, b \in G</m>.
          Then <m>\phi(a) \phi(b) = \phi(ab) = \phi(ba) = \phi(b)\phi(a)</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="10"  xml:id="homomorph-exercise-phi-G-cyclic">
      <statement>
        <p>
          If <m>\phi : G \rightarrow H</m> is a group homomorphism and <m>G</m> is cyclic,
          prove that <m>\phi(G)</m> is also cyclic.
        </p>
      </statement>
    </exercise>

    <exercise number="11"  xml:id="homomorph-exercise-cyclic-homomorph-generator">
      <statement>
        <p>
          Show that a homomorphism defined on a cyclic group is completely determined by its action on the generator of the group.
        </p>
      </statement>
    </exercise>
        <!--I don't think that we can prove this without Cauchy's Theorem or the class equation.  At least the proof would not be an easy one.
	<exercise number="12">
		<statement>
			<p>Let <m>G</m> be a group of order <m>p^2</m>, where <m>p</m> is a prime number. If <m>H</m> is a subgroup of <m>G</m> of order <m>p</m>, show that <m>H</m> is normal in <m>G</m>. Prove that <m>G</m> must be abelian.</p>
		</statement>
		<solution>
			<p>Choose an element <m>g \in G</m> that is not the identity.  The order of <m>g</m> must be either <m>p</m> or <m>p^2</m>.  If <m>g</m> has order <m>p^2</m>, then <m>G</m> is cyclic.  Otherwise, <m>g</m> generates a subgroup <m>H</m> of order <m>p</m>.</p>
		</solution>
	</exercise>
-->
    <exercise number="12"  xml:id="homomorph-exercise-one-subgroup-normal">
      <statement>
        <p>
          If a group <m>G</m> has exactly one subgroup <m>H</m> of order <m>k</m>,
          prove that <m>H</m> is normal in <m>G</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="13"  xml:id="homomorph-exercise-QmodZ-Q">
      <statement>
        <p>
          Prove or disprove:
          <m>{\mathbb Q} / {\mathbb Z} \cong {\mathbb Q}</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="14"  xml:id="homomorph-exercise-G-finitie-N-normal">
      <statement>
        <p>
          Let <m>G</m> be a finite group and <m>N</m> a normal subgroup of <m>G</m>.
          If <m>H</m> is a subgroup of <m>G/N</m>,
          prove that <m>\phi^{-1}(H)</m> is a subgroup in <m>G</m> of order <m>|H| \cdot |N|</m>,
          where <m>\phi : G \rightarrow G/N</m> is the canonical homomorphism.
        </p>
      </statement>
    </exercise>

    <exercise number="15"  xml:id="homomorph-exercise-quotient-to-quatient">
      <statement>
        <p>
          Let <m>G_1</m> and <m>G_2</m> be groups,
          and let <m>H_1</m> and <m>H_2</m> be normal subgroups of <m>G_1</m> and <m>G_2</m> respectively.
          Let <m>\phi : G_1 \rightarrow G_2</m> be a homomorphism.
          Show that <m>\phi</m> induces a homomorphism
          <m>\overline{\phi} : (G_1/H_1) \rightarrow (G_2/H_2)</m> if <m>\phi(H_1) \subset H_2</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="16"  xml:id="homomorph-exercise-H-K-normal">
      <statement>
        <p>
          If <m>H</m> and <m>K</m> are normal subgroups of <m>G</m> and <m>H \cap K = \{ e \}</m>,
          prove that <m>G</m> is isomorphic to a subgroup of <m>G/H \times G/K</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="17"  xml:id="homomorph-exercise-isomorphic-quotients">
      <statement>
        <p>
          Let <m>\phi : G_1 \rightarrow G_2</m> be a surjective group homomorphism.
          Let <m>H_1</m> be a normal subgroup of <m>G_1</m> and suppose that <m>\phi(H_1) = H_2</m>.
          Prove or disprove that <m>G_1/H_1 \cong G_2/H_2</m>.
        </p>
      </statement>
      <hint>
        <p>
          Find a counterexample.
        </p>
      </hint>
    </exercise>

    <exercise number="18" xml:id="homomorph-exercise-trivial-kernel">
      <statement>
        <p>
          Let <m>\phi : G \rightarrow H</m> be a group homomorphism.
          Show that <m>\phi</m> is one-to-one if and only if <m>\phi^{-1}(e) = \{ e \}</m>.
        </p>
      </statement>
    </exercise>

    <exercise number="19"  xml:id="homomorph-exercise-equivalence-relation">
      <statement>
        <p>
          Given a homomorphism <m>\phi :G \rightarrow H</m> define a relation <m>\sim</m> on <m>G</m> by <m>a \sim b</m> if
          <m>\phi(a) = \phi(b)</m> for <m>a, b \in G</m>.
          Show this relation is an equivalence relation and describe the equivalence classes.
        </p>
      </statement>
    </exercise>

  </exercises>
  <exercises xml:id="homomorph-exercises-automorphisms">
    <title>Additional Exercises: Automorphisms</title>

    <exercise xml:id="homomorph-exercise-aut-G">
      <statement>
        <p>
          Let <m>\aut(G)</m> be the set of all automorphisms of <m>G</m>;
          that is, isomorphisms from <m>G</m> to itself.
          Prove this set forms a group and is a subgroup of the group of permutations of <m>G</m>;
          that is, <m>\aut(G) \leq S_G</m>.
        </p>
      </statement>
    </exercise>

    <exercise xml:id="homomorph-exercise-inner-aut">
      <statement>
        <p>
          An <term>inner automorphism</term><idx><h>Automorphism</h><h>inner</h></idx> of <m>G</m>,
          <me>
            i_g : G \rightarrow G
          </me>,
          is defined by the map
          <me>
            i_g(x) = g x g^{-1}
          </me>,
          for <m>g \in G</m>.
          Show that <m>i_g \in \aut(G)</m>.
        </p>
      </statement>
    </exercise>

    <exercise xml:id="homomorph-exercise-Inn-G">
      <statement>
        <p>
          The set of all inner automorphisms is denoted by <m>\inn(G)</m>.
          Show that <m>\inn(G)</m> is a subgroup of <m>\aut(G)</m>.
        </p>
      </statement>
    </exercise>

    <exercise xml:id="homomorph-exercise-auto-not-inner">
      <statement>
        <p>
          Find an automorphism of a group <m>G</m> that is not an inner automorphism.
        </p>
      </statement>
    </exercise>

    <exercise xml:id="homomorph-exercise-ZG-inner">
      <statement>
        <p>
          Let <m>G</m> be a group and <m>i_g</m> be an inner automorphism of <m>G</m>,
          and define a map
          <me>
            G \rightarrow \aut(G)
          </me>
          by
          <me>
            g \mapsto i_g
          </me>.
          Prove that this map is a homomorphism with image <m>\inn(G)</m> and kernel <m>Z(G)</m>.
          Use this result to conclude that
          <me>
            G/Z(G) \cong \inn(G)
          </me>.
        </p>
      </statement>
    </exercise>

    <exercise xml:id="homomorph-exercise-aut-S3">
      <statement>
        <p>
          Compute <m>\aut(S_3)</m> and <m>\inn(S_3)</m>.
          Do the same thing for <m>D_4</m>.
        </p>
      </statement>
    </exercise>

    <exercise xml:id="homomorph-exercise-aut-Z">
      <statement>
        <p>
          Find all of the homomorphisms <m>\phi : {\mathbb Z} \rightarrow {\mathbb Z}</m>.
          What is <m>\aut({\mathbb Z})</m>?
        </p>
      </statement>
    </exercise>

    <exercise xml:id="homomorph-exercise-aut-Z8">
      <statement>
        <p>
          Find all of the automorphisms of <m>{\mathbb Z}_8</m>.
          Prove that <m>\aut({\mathbb Z}_8) \cong U(8)</m>.
        </p>
      </statement>
    </exercise>

    <exercise xml:id="homomorph-exercise-a-to-ka">
      <statement>
        <p>
          For <m>k \in {\mathbb Z}_n</m>,
          define a map <m>\phi_k : {\mathbb Z}_n \rightarrow {\mathbb Z}_n</m> by <m>a \mapsto ka</m>.
          Prove that <m>\phi_k</m> is a homomorphism.
        </p>
      </statement>
    </exercise>

    <exercise xml:id="homomorph-exercise-phi-k-Zn">
      <statement>
        <p>
          Prove that <m>\phi_k</m> is an isomorphism if and only if <m>k</m> is a generator of <m>{\mathbb Z}_n</m>.
        </p>
      </statement>
    </exercise>

    <exercise xml:id="homomorph-exercise-aut-Zn">
      <statement>
        <p>
          Show that every automorphism of
          <m>{\mathbb Z}_n</m> is of the form <m>\phi_k</m>,
          where <m>k</m> is a generator of <m>{\mathbb Z}_n</m>.
        </p>
      </statement>
    </exercise>

    <exercise xml:id="homomorph-exercise-Un-aut-Zn">
      <statement>
        <p>
          Prove that <m>\psi : U(n) \rightarrow \aut({\mathbb Z}_n)</m> is an isomorphism,
          where <m>\psi : k \mapsto \phi_k</m>.
        </p>
      </statement>
    </exercise>

  </exercises>


  <section xml:id="homomorph-sage" component="sage-info">
    <title>Sage</title>
    <introduction>
      <p>
        Sage is able to create homomorphisms
        (and by extension, isomorphisms and automorphisms)
        between finite permutation groups.
        There is a limited supply of commands then available to manipulate these functions,
        but we can still illustrate many of the ideas in this chapter.
      </p>
    </introduction>

    <subsection>
      <title>Homomorphisms</title>
      <p>
        The principal device for creating a homomorphism is to specify the specific images of the set of generators for the domain.
        Consider cyclic groups of order <m>12</m> and <m>20</m>:
        <md>
          <mrow>G &amp;= \{a^i\vert a^{12}=e\} &amp; H &amp;= \{x^i\vert x^{20}=e\}</mrow>
        </md>
        and define a homomorphism by just defining the image of the generator of <m>G</m>,
        and define the rest of the mapping by extending the mapping via the operation-preserving property of a homomorphism.
        <md>
          <mrow>\phi: G\rightarrow H, &amp;\quad\phi(a)=x^5</mrow>
          <mrow>\Rightarrow           &amp;\quad\phi(a^i) = \phi(a)^i = (x^5)^i = x ^{5i}</mrow>
        </md>
        The constructor <c>PermutationGroupMorphism</c> requires the two groups,
        then a list of images for each generator
        (in order!),
        and then will create the homomorphism.
        Note that we can then use the result as a function.
        In the example below,
        we first verify that <c>C12</c> has a single generator
        (no surprise there),
        which we then send to a particular element of order <m>4</m> in the codomain.
        Sage then constructs the unique homomorphism that is consistent with this requirement.
      </p>

            <sage>
                <input>
        C12 = CyclicPermutationGroup(12)
        C20 = CyclicPermutationGroup(20)
        domain_gens = C12.gens()
        [g.order() for g in domain_gens]
        </input>
                <output>
        [12]
        </output>
            </sage>
            <sage>
                <input>
        x = C20.gen(0)
        y = x^5
        y.order()
        </input>
                <output>
        4
        </output>
            </sage>
            <sage>
                <input>
        phi = PermutationGroupMorphism(C12, C20, [y])
        phi
        </input>
                <output>
        Permutation group morphism:
          From: Cyclic group of order 12 as a permutation group
          To:   Cyclic group of order 20 as a permutation group
          Defn: [(1,2,3,4,5,6,7,8,9,10,11,12)] -&gt;
                [(1,6,11,16)(2,7,12,17)(3,8,13,18)(4,9,14,19)(5,10,15,20)]
        </output>
            </sage>
            <sage>
                <input>
        a = C12("(1,6,11,4,9,2,7,12,5,10,3,8)")
        phi(a)
        </input>
                <output>
        (1,6,11,16)(2,7,12,17)(3,8,13,18)(4,9,14,19)(5,10,15,20)
        </output>
            </sage>
            <sage>
                <input>
        b = C12("(1,3,5,7,9,11)(2,4,6,8,10,12)")
        phi(b)
        </input>
                <output>
        (1,11)(2,12)(3,13)(4,14)(5,15)(6,16)(7,17)(8,18)(9,19)(10,20)
        </output>
            </sage>
            <sage>
                <input>
        c = C12("(1,9,5)(2,10,6)(3,11,7)(4,12,8)")
        phi(c)
        </input>
                <output>
        ()
        </output>
            </sage>

      <p>
        Note that the element <c>c</c> must therefore be in the kernel of <c>phi</c>.
      </p>

      <p>
        We can then compute the subgroup of the domain that is the kernel,
        in this case a cyclic group of order <m>3</m> inside the cyclic group of order <m>12</m>.
        We can compute the image of <em>any</em> subgroup,
        but here we will build the whole homomorphic image by supplying the whole domain to the <c>.image()</c> method.
        Here the image is a cyclic subgroup of order <m>4</m> inside the cyclic group of order <m>20</m>.
        Then we can verify the First Isomorphism Theorem.
      </p>

            <sage>
                <input>
        K = phi.kernel(); K
        </input>
                <output>
        Subgroup generated by [(1,5,9)(2,6,10)(3,7,11)(4,8,12)]
        of (Cyclic group of order 12 as a permutation group)
        </output>
            </sage>
            <sage>
                <input>
        Im = phi.image(C12); Im
        </input>
                <output>
        Subgroup generated by [(1,6,11,16)(2,7,12,17)(3,8,13,18)(4,9,14,19)(5,10,15,20)]
        of (Cyclic group of order 20 as a permutation group)
        </output>
            </sage>
            <sage>
                <input>
        Im.is_isomorphic(C12.quotient(K))
        </input>
                <output>
        True
        </output>
            </sage>

      <p>
        Here is a slightly more complicated example.
        The dihedral group <m>D_{20}</m> is the symmetry group of a <m>20</m>-gon.
        Inside this group is a subgroup that is isomorphic to the symmetry group of a <m>5</m>-gon
        (pentagon).
        Is this a surprise, or is this obvious?
        Here is a way to make precise the statement
        <q><m>D_{20}</m> contains a copy of <m>D_{5}</m>.</q>
      </p>

      <p>
        We build the domain and find its generators,
        so we know how many images to supply in the definition of the homomorphism.
        Then we construct the codomain,
        from which we will construct images.
        Our choice here is to send a reflection to a reflection,
        and a rotation to a rotation.
        But the rotations will both have order <m>5</m>,
        and both are a rotation by <m>72</m> degrees.
      </p>

            <sage>
                <input>
        G = DihedralGroup(5)
        H = DihedralGroup(20)
        G.gens()
        </input>
                <output>
        ((1,2,3,4,5), (1,5)(2,4))
        </output>
            </sage>
            <sage>
                <input>
        H.gens()
        </input>
                <output>
        ((1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20),
         (1,20)(2,19)(3,18)(4,17)(5,16)(6,15)(7,14)(8,13)(9,12)(10,11))
        </output>
            </sage>
            <sage>
                <input>
        x = H.gen(0)^4
        y = H.gen(1)
        rho = PermutationGroupMorphism(G, H, [x, y])
        rho.kernel()
        </input>
                <output>
        Subgroup generated by [()] of (Dihedral group of order 10 as a permutation group)
        </output>
            </sage>

      <p>
        Since the kernel is trivial, <c>rho</c> is a one-to-one function
        (see <xref ref="homomorph-exercise-trivial-kernel"/>).
        But more importantly, by the First Isomorphishm Theorem,
        <c>G</c> is isomorphic to the image of the homomorphism.
        We compute the image and check the claim.
      </p>

            <sage>
                <input>
        Im = rho.image(G); Im
        </input>
                <output>
        Subgroup generated by [(1,5,9,13,17)(2,6,10,14,18)(3,7,11,15,19)(4,8,12,16,20), (1,20)(2,19)(3,18)(4,17)(5,16)(6,15)(7,14)(8,13)(9,12)(10,11)] 
        of (Dihedral group of order 40 as a permutation group)
        </output>
            </sage>
            <sage>
                <input>
        Im.is_subgroup(H)
        </input>
                <output>
        True
        </output>
            </sage>
            <sage>
                <input>
        Im.is_isomorphic(G)
        </input>
                <output>
        True
        </output>
            </sage>

      <p>
        Just providing a list of images for the generators of the domain is no guarantee that the function will extend to a homomorphism.
        For starters,
        the order of each image must divide the order of the corresponding preimage. (Can you prove this?) And similarly,
        if the domain is abelian, then the image must also be abelian,
        so in this case the list of images should not generate a non-abelian subgroup.
        Here is an example.
        There are no homomorphisms from a cyclic group of order <m>7</m> to a cyclic group of order <m>4</m>
        (other than the trivial function that takes every element to the identity).
        To see this, consider the possible orders of the kernel,
        and of the two possibilities,
        see that one is impossible and the other arises with the trivial homomorphism.
        Unfortunately, Sage acts as if nothing is wrong in creating a homomorphism between these groups,
        but what Sage builds is useless and raises errors when you try to use it.
      </p>

            <sage>
                <input>
        G = CyclicPermutationGroup(7)
        H = CyclicPermutationGroup(4)
        tau = PermutationGroupMorphism_im_gens(G, H, H.gens())
        tau
        </input>
                <output>
        Permutation group morphism:
          From: Cyclic group of order 7 as a permutation group
          To:   Cyclic group of order 4 as a permutation group
          Defn: [(1,2,3,4,5,6,7)] -&gt; [(1,2,3,4)]
        </output>
            </sage>
            <sage>
                <input>
        tau.kernel()
        </input>
                <output>
        Traceback (most recent call last):
        ...
        sage.libs.gap.util.GAPError: Error, no method found!
        Error, no 1st choice method found for `Kernel' on 1 arguments
        ...
        </output>
            </sage>

      <p>
        Rather than creating homomorphisms ourselves,
        in certain situations Sage knows of the existence of natural homomorphisms and will create them for you.
        One such case is a direct product construction.
        Given a group <c>G</c>,
        the method <c>.direct_product(H)</c> will create the direct product
        <m>G\times H</m>. (This is not the same command as the function <c>direct_product_permgroups()</c> from before.) Not only does this command create the direct product,
        but it also builds <em>four</em>
        homomorphisms, one with domain <m>G</m>,
        one with domain <m>H</m> and two with domain <m>G\times H</m>.
        So the output consists of five objects,
        the first being the actual group,
        and the remainder are homomorphisms.
        We will demonstrate the call here,
        and leave a more thorough investigation for the exercises.
      </p>

            <sage>
                <input>
        G = CyclicPermutationGroup(3)
        H = DihedralGroup(4)
        results = G.direct_product(H)
        results[0]
        </input>
                <output>
        Permutation Group with generators [(4,5,6,7), (4,7)(5,6), (1,2,3)]
        </output>
            </sage>
            <sage>
                <input>
        results[1]
        </input>
                <output>
        Permutation group morphism:
          From: Cyclic group of order 3 as a permutation group
          To:   Permutation Group with generators
                [(4,5,6,7), (4,7)(5,6), (1,2,3)]
          Defn: Embedding( Group( [ (1,2,3), (4,5,6,7), (4,7)(5,6) ] ), 1 )
        </output>
            </sage>
            <sage>
                <input>
        results[2]
        </input>
                <output>
        Permutation group morphism:
          From: Dihedral group of order 8 as a permutation group
          To:   Permutation Group with generators
                [(4,5,6,7), (4,7)(5,6), (1,2,3)]
          Defn: Embedding( Group( [ (1,2,3), (4,5,6,7), (4,7)(5,6) ] ), 2 )
        </output>
            </sage>
            <sage>
                <input>
        results[3]
        </input>
                <output>
        Permutation group morphism:
          From: Permutation Group with generators
                [(4,5,6,7), (4,7)(5,6), (1,2,3)]
          To:   Cyclic group of order 3 as a permutation group
          Defn: Projection( Group( [ (1,2,3), (4,5,6,7), (4,7)(5,6) ] ), 1 )
        </output>
            </sage>
            <sage>
                <input>
        results[4]
        </input>
                <output>
        Permutation group morphism:
          From: Permutation Group with generators
                [(4,5,6,7), (4,7)(5,6), (1,2,3)]
          To:   Dihedral group of order 8 as a permutation group
          Defn: Projection( Group( [ (1,2,3), (4,5,6,7), (4,7)(5,6) ] ), 2 )
        </output>
            </sage>
    </subsection>
  </section>

  <exercises xml:id="homomorph-sage-exercises" component="sage-exercises">
    <title>Sage Exercises</title>

    <exercise number="1" xml:id="homomorph-sage-exercise-automorphism">
      <statement>
        <p>
          An automorphism is an isomorphism between a group and itself.
          The identity function (<m>x\mapsto x</m>) is always an isomorphism,
          which we consider trivial.
          Use Sage to construct a nontrivial automorphism of the cyclic group of order <m>12</m>.
          Check that the mapping is both onto and one-to-one by computing the image and kernel and performing the proper tests on these subgroups.
          Now construct all of the possible automorphisms of the cyclic group of order <m>12</m> without any duplicates.
        </p>
      </statement>
    </exercise>

    <exercise number="2" xml:id="homomorph-sage-exercise-GxH">
      <statement>
        <p>
          The four homomorphisms created by the direct product construction are each an example of a more general construction of homomorphisms involving groups <m>G</m>,
          <m>H</m> and <m>G\times H</m>.
          By using the same groups as in the example in the previous subsection,
          see if you can discover and describe these constructions with exact definitions of the four homomorphisms in general.
        </p>

        <p>
          Your tools for investigating a Sage group homomorphism are limited,
          you might take each generator of the domain and see what its image is.
          Here is an example of the type of computation you might do repeatedly.
          We'll investigate the second homomorphism.
          The domain is the dihedral group,
          and we will compute the image of the first generator.
        </p>

                <sage>
                    <input>
            G = CyclicPermutationGroup(3)
            H = DihedralGroup(4)
            results = G.direct_product(H)
            phi = results[2]
            H.gens()
            </input>
                    <output>
            ((1,2,3,4), (1,4)(2,3))
            </output>
                </sage>
                <sage>
                    <input>
            a = H.gen(0); a
            </input>
                    <output>
            (1,2,3,4)
            </output>
                </sage>
                <sage>
                    <input>
            phi(a)
            </input>
                    <output>
            (4,5,6,7)
            </output>
                </sage>
      </statement>
    </exercise>

    <exercise number="3" xml:id="homomorph-sage-exercise-S7-S12">
      <statement>
        <p>
          Consider two permutation groups.
          The first is the subgroup of <m>S_7</m> generated by
          <m>(1, 2, 3)</m> and <m>(4, 5, 6, 7)</m>.
          The second is a subgroup of <m>S_{12}</m> generated by
          <m>(1, 2, 3)(4, 5, 6)(7, 8, 9)(10, 11, 12)</m> and <m>(1, 10, 7, 4)(2, 11, 8, 5)(3, 12, 9, 6)</m>.
          Build these two groups and use the proper Sage command to see that they are isomorphic.
          Then construct a homomorphism between these two groups that is an isomorphism and include enough details to verify that the mapping is really an isomorphism.
        </p>
      </statement>
    </exercise>

    <exercise number="4" xml:id="homomorph-sage-exercise-Sn-Z2">
      <statement>
        <p>
          The second paragraph of this chapter informally describes a homomorphism from <m>S_n</m> to <m>{\mathbb Z}_2</m>,
          where the even permutations all map to one of the elements and the odd permutations all map to the other element.
          Replace <m>S_n</m> by <m>S_6</m> and replace
          <m>{\mathbb Z}_2</m> by the permutation version of the cyclic subgroup of order <m>2</m>,
          and construct a nontrivial homomorphism between these two groups.
          Evaluate your homomorphism with enough even and odd permutations to be convinced that it is correct.
          Then construct the kernel and verify that it is the group you expect.
        </p>

        <p>
          Hints: First,
          decide which elements of the group of order <m>2</m> will be associated with even permutations and which will be associated with odd permutations.
          Then examine the generators of <m>S_6</m> to help decide just how to build the homomorphism.
        </p>
      </statement>
    </exercise>

    <exercise number="5" xml:id="homomorph-sage-exercise-D20">
      <statement>
        <p>
          The dihedral group <m>D_{20}</m> has several normal subgroups,
          as seen below.
          Each of these is the kernel of a homomorphism with <m>D_{20}</m> as the domain.
          For each normal subgroup of <m>D_{20}</m> construct a homomorphism from <m>D_{20}</m> to <m>D_{20}</m> that has the normal subgroup as the kernel.
          Include in your work verifications that you are creating the desired kernels.
          There is a pattern to many of these,
          but the three of order <m>20</m> will be a challenge.
        </p>

                <sage>
                    <input>
            G = DihedralGroup(20)
            [H.order() for H in G.normal_subgroups()]
            </input>
                    <output>
            [40, 20, 20, 20, 10, 4, 2, 5, 1]
            </output>
                </sage>
      </statement>
    </exercise>

    <!--Todo Add Sage exercises illustrating isomorphism theorems, since now have intersection of groups-->
  </exercises>
</chapter>
