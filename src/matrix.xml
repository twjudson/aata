<?xml version="1.0"?>
<!-- This file is part of the book                    -->
<!--                                                  -->
<!-- Abstract Algebra: Theory and Applications        -->
<!--                                                  -->
<!-- Text: Copyright (C) 1997-2024  Thomas W. Judson  -->
<!-- Sage: Copyright (C) 2010-2024  Robert A. Beezer  -->
<!-- See the file COPYING for copying conditions.     -->
<!-- This file is part of the book                    -->
<!--                                                  -->
<!-- See the file COPYING for copying conditions.     -->
<chapter xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="matrix">
  <title>Matrix Groups and Symmetry</title>
  <introduction>
    <p>
      When Felix Klein<idx><h>Klein, Felix</h></idx>
      (1849<ndash/>1925) accepted a chair at the University of Erlangen,
      he outlined in his inaugural address a program to classify different geometries.
      Central to Klein's program was the theory of groups:
      he considered geometry to be the study of properties that are left invariant under transformation groups.
      Groups, especially matrix groups,
      have now become important in the study of symmetry and have found applications in such disciplines as chemistry and physics.
      In the first part of this chapter,
      we will examine some of the classical matrix groups,
      such as the general linear group,
      the special linear group, and the orthogonal group.
      We will then use these matrix groups to investigate some of the ideas behind geometric symmetry.
    </p>
  </introduction>

  <section xml:id="matrix-section-groups">
    <title>Matrix Groups</title>
    <subsection xml:id="matrix-subsection-linear-algebra">
      <title>Some Facts from Linear Algebra</title>
      <p>
        Before we study matrix groups,
        we must recall some basic facts from linear algebra.
        One of the most fundamental ideas of linear algebra is that of a linear transformation.
        A <term>linear transformation</term><idx><h>Linear transformation</h><h>definition of</h></idx> or <term>linear map</term><idx><h>Linear map</h></idx>
        <m>T : {\mathbb R}^n \rightarrow {\mathbb R}^m</m> is a map that preserves vector addition and scalar multiplication;
        that is, for vectors <m>{\mathbf x}</m> and <m>{\mathbf y}</m> in
        <m>{\mathbb R}^n</m> and a scalar <m>\alpha \in {\mathbb R}</m>,
        <md>
          <mrow>T({\mathbf x}+{\mathbf y}) &amp; = T({\mathbf x}) + T({\mathbf y})</mrow>
          <mrow>T(\alpha {\mathbf y}) &amp; = \alpha T({\mathbf y})</mrow>
        </md>.
        An <m>m \times n</m> matrix with entries in
        <m>{\mathbb R}</m> represents a linear transformation from
        <m>{\mathbb R}^n</m> to <m>{\mathbb R}^m</m>.
        If we write vectors <m>{\mathbf x} = (x_1, \ldots,
        x_n)^\transpose</m> and <m>{\mathbf y} = (y_1, \ldots,
        y_n)^\transpose</m> in <m>{\mathbb R}^n</m> as column matrices,
        then an <m>m \times n</m> matrix
        <me>
          A
          =
          \begin{pmatrix}
          a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n} \\
          a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n} \\
          \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
          a_{m1} &amp; a_{m2} &amp; \cdots &amp; a_{mn}
          \end{pmatrix}
        </me>
        maps the vectors to <m>{\mathbb R}^m</m> linearly by matrix multiplication.
        Observe that if <m>\alpha</m> is a real number,
        <me>
          A({\mathbf x} + {\mathbf y} ) 
          = 
          A {\mathbf x }+ A {\mathbf y} 
          \qquad \text{and} \qquad
          \alpha A {\mathbf x} 
          = 
          A ( \alpha {\mathbf x})
        </me>,
        where
        <me>
          {\mathbf x}
          =
          \begin{pmatrix}
          x_1 \\
          x_2 \\
          \vdots \\
          x_n
          \end{pmatrix}
        </me>.
        We will often abbreviate the matrix <m>A</m> by writing <m>(a_{ij})</m>.

        <notation>
          <usage><m>(a_{ij})</m></usage>
          <description>matrix</description>
        </notation>

      </p>

      <p>
        Conversely, if <m>T : {\mathbb R}^n \rightarrow {\mathbb R}^m</m> is a linear map,
        we can associate a matrix <m>A</m> with <m>T</m> by considering what <m>T</m> does to the vectors
        <md>
          <mrow>{\mathbf e}_1 &amp; = (1, 0, \ldots, 0)^\transpose</mrow>
          <mrow>{\mathbf e}_2 &amp; = (0, 1, \ldots, 0)^\transpose</mrow>
          <mrow>&amp;  \vdots &amp;</mrow>
          <mrow>{\mathbf e}_n &amp; = (0, 0, \ldots, 1)^\transpose</mrow>
        </md>.
        We can write any vector <m>{\mathbf x} = (x_1, \ldots,
        x_n)^\transpose</m> as
        <me>
          x_1 {\mathbf e}_1 + x_2 {\mathbf e}_2 + \cdots + x_n {\mathbf e}_n
        </me>.
        Consequently, if
        <md>
          <mrow>T({\mathbf e}_1) &amp; = (a_{11}, a_{21}, \ldots, a_{m1})^\transpose,</mrow>
          <mrow>T({\mathbf e}_2) &amp; = (a_{12}, a_{22}, \ldots, a_{m2})^\transpose,</mrow>
          <mrow>&amp;  \vdots &amp;</mrow>
          <mrow>T({\mathbf e}_n) &amp; = (a_{1n}, a_{2n}, \ldots, a_{mn})^\transpose</mrow>
        </md>,
        then
        <md>
          <mrow>T({\mathbf x} ) &amp; = T(x_1 {\mathbf e}_1 + x_2 {\mathbf e}_2 + \cdots + x_n {\mathbf e}_n)</mrow>
          <mrow>&amp; = x_1 T({\mathbf e}_1) + x_2 T({\mathbf e}_2) + \cdots + x_n T({\mathbf e}_n)</mrow>
          <mrow>&amp; = \left( \sum_{k=1}^{n} a_{1k} x_k, \ldots,  \sum_{k=1}^{n} a_{mk} x_k \right)^\transpose</mrow>
          <mrow>&amp; = A {\mathbf x}</mrow>
        </md>.
      </p>

      <example xml:id="matrix-example-linear-transform">
        <p>
          If we let <m>T : {\mathbb R}^2 \rightarrow {\mathbb R}^2</m> be the map given by
          <me>
            T(x_1, x_2) = (2 x_1 + 5 x_2, - 4 x_1 + 3 x_2)
          </me>,
          the axioms that <m>T</m> must satisfy to be a linear transformation are easily verified.
          The column vectors <m>T {\mathbf e}_1 = (2, -4)^\transpose</m> and
          <m>T {\mathbf e}_2 = (5,3)^\transpose</m> tell us that <m>T</m> is given by the matrix
          <me>
            A =
            \begin{pmatrix}
            2 &amp; 5 \\
            -4 &amp; 3
            \end{pmatrix}
          </me>.
        </p>
      </example>

      <p>
        Since we are interested in groups of matrices,
        we need to know which matrices have multiplicative inverses.
        Recall that an <m>n \times n</m> matrix <m>A</m> is <term>invertible</term><idx><h>Matrix</h><h>invertible</h></idx>
        exactly when there exists another matrix <m>A^{-1}</m> such that <m>A A^{-1} = A^{-1} A = I</m>, where
        <me>
          I =
          \begin{pmatrix}
          1 &amp; 0 &amp; \cdots &amp; 0 \\
          0 &amp; 1 &amp; \cdots &amp; 0 \\
          \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
          0 &amp; 0 &amp; \cdots &amp; 1
          \end{pmatrix}
        </me>
        is the <m>n \times n</m> identity matrix.
        From linear algebra we know that <m>A</m> is invertible if and only if the determinant of <m>A</m> is nonzero.
        Sometimes an invertible matrix is said to be <idx><h>Matrix</h><h>nonsingular</h></idx><term>nonsingular</term>.
      </p>

      <example xml:id="matrix-inverse-matrix">
        <p>
          If <m>A</m> is the matrix
          <me>
            \begin{pmatrix}
            2 &amp; 1 \\
            5 &amp; 3
            \end{pmatrix}
          </me>,
          then the inverse of <m>A</m> is
          <me>
            A^{-1} =
            \begin{pmatrix}
            3 &amp; -1 \\
            -5 &amp; 2
            \end{pmatrix}
          </me>.
          We are guaranteed  that <m>A^{-1}</m> exists,
          since <m>\det(A) = 2 \cdot 3 - 5 \cdot 1 = 1</m> is nonzero.
        </p>
      </example>

      <p>
        Some other facts about determinants will also prove useful in the course of this chapter.
        Let <m>A</m> and <m>B</m> be <m>n \times n</m> matrices.
        From linear algebra we have the following properties of determinants.

        <ul>
          <li>
            <p>
              The determinant is a homomorphism into the multiplicative group of real numbers;
              that is, <m>\det( A B) = (\det A )(\det B)</m>.
            </p>
          </li>

          <li>
            <p>
              If <m>A</m> is an invertible matrix,
              then <m>\det(A^{-1}) = 1 / \det A</m>.
            </p>
          </li>

          <li>
            <p>
              If we define the transpose of a matrix
              <m>A = (a_{ij})</m> to be <m>A^\transpose = (a_{ji})</m>,
              then <m>\det(A^\transpose) = \det A</m>.
            </p>
          </li>

          <li>
            <p>
              Let <m>T</m> be the linear transformation associated with an <m>n \times n</m> matrix <m>A</m>.
              Then <m>T</m> multiplies volumes by a factor of <m>|\det A|</m>.
              In the case of <m>{\mathbb R}^2</m>,
              this means that <m>T</m> multiplies areas by <m>|\det A|</m>.
            </p>
          </li>
        </ul>
      </p>

      <p>
        Linear maps, matrices,
        and determinants are covered in any elementary linear algebra text;
        however, if you have not had a course in linear algebra,
        it is a straightforward process to verify these properties directly for <m>2 \times 2</m> matrices,
        the case with which we are most concerned.
      </p>
    </subsection>

    <subsection xml:id="matrix-subsection-general-linear-group">
      <title>The General and Special Linear Groups</title>
      <p>
        The set of all <m>n \times n</m> invertible matrices forms a group called the
        <idx><h>Group</h><h>general linear</h></idx><term>general linear group</term>.
        We will denote this group by <m>GL_n({\mathbb R})</m>.
        The general linear group has several important subgroups.
        The multiplicative properties of the determinant imply that the set of matrices with determinant one is a subgroup of the general linear group.
        Stated another way, suppose that
        <m>\det(A) =1</m> and <m>\det(B) = 1</m>.
        Then <m>\det(AB) = \det(A) \det (B) = 1</m> and <m>\det(A^{-1}) = 1 / \det A = 1</m>.
        This subgroup is called the <term>special linear group</term><idx><h>Group</h><h>special linear</h></idx> and is denoted by <m>SL_n({\mathbb R})</m>.
      </p>

      <example xml:id="matrix-example-determinant">
        <p>
          Given a <m>2 \times 2</m> matrix
          <me>
            A =
            \begin{pmatrix}
            a &amp; b \\
            c &amp; d
            \end{pmatrix}
          </me>,
          the determinant of <m>A</m> is <m>ad-bc</m>.
          The group <m>GL_2({\mathbb R})</m> consists of those matrices in which <m>ad-bc \neq 0</m>.
          The inverse of <m>A</m> is
          <me>
            A^{-1} =
            \frac{1}{ad-bc}
            \begin{pmatrix}
            d &amp; -b \\
            -c &amp; a
            \end{pmatrix}
          </me>.
          If <m>A</m> is in <m>SL_2({\mathbb R})</m>, then
          <me>
            A^{-1} =
            \begin{pmatrix}
            d &amp; -b \\
            -c &amp; a
            \end{pmatrix}
          </me>.
          Geometrically,
          <m>SL_2({\mathbb R})</m> is the group that preserves the areas of parallelograms.
          Let
          <me>
            A =
            \begin{pmatrix}
            1 &amp; 1 \\
            0 &amp; 1
            \end{pmatrix}
          </me>
          be in <m>SL_2({\mathbb R})</m>.
          In <xref ref="matrix-figure-sl2"/>,
          the unit square corresponding to the vectors <m>{\mathbf x} = (1,0)^\transpose</m> and
          <m>{\mathbf y} = (0,1)^\transpose</m> is taken  by <m>A</m> to the parallelogram with sides
          <m>(1,0)^\transpose</m> and <m>(1, 1)^\transpose</m>;
          that is, <m>A {\mathbf x} = (1,0)^\transpose</m> and <m>A {\mathbf y} = (1, 1)^\transpose</m>.
          Notice that these two parallelograms have the same area.
        </p>
      </example>
<!--=============================-->


      <figure xml:id="matrix-figure-sl2">
        <caption><m>SL_2(\mathbb R)</m> acting on the unit square</caption>
            <!-- Replaced figure with tikz figure - TWJ 6/11/2010 -->
        <sidebyside width="40%" margins="auto" valign="middle">
          <image xml:id="matrix-sl2r-a">
          	<description>A square on set of axes with the left edge a vector from the origin to (0,1) and bottom edge a vector from the origin to (1,0).</description>
              <latex-image>
                  <xi:include href="tikz/matrix-sl2r-a.tex" parse="text"/>
              </latex-image>
          </image>

          <image xml:id="matrix-sl2r-b">
            <description>A parallelogram on set of axes with the left edge a vector from the origin to (1,1) and bottom edge a vector from the origin to (1,0).</description>
              <latex-image>
                  <xi:include href="tikz/matrix-sl2r-b.tex" parse="text"/>
              </latex-image>
          </image>
        </sidebyside>
      </figure>


<!--=============================-->
    </subsection>

    <subsection xml:id="matrix-subsection-orthogonal-group">
      <title>The Orthogonal Group <m>O(n)</m></title>
      <p>
        Another subgroup of <m>GL_n({\mathbb R})</m> is the orthogonal group.
        A matrix <m>A</m> is <term>orthogonal</term><idx><h>Orthogonal matrix</h></idx><idx><h>Matrix</h><h>orthogonal</h></idx>
        if <m>A^{-1} = A^\transpose</m>.
        The <term>orthogonal group</term><idx><h>Group</h><h>orthogonal</h></idx><idx><h>Orthogonal group</h></idx>
        consists of the set of all orthogonal matrices.
        We write <m>O(n)</m> for the <m>n \times n</m> orthogonal group.
        <notation>
          <usage><m>O(n)</m></usage>
          <description>orthogonal group</description>
        </notation>
        We leave as an exercise the proof that <m>O(n)</m> is a subgroup of <m>GL_n( {\mathbb R})</m>.
      </p>

      <example xml:id="matrix-orthogonal">
        <p>
          The following matrices are orthogonal:
          <me>
            \begin{pmatrix}
            3/5 &amp; -4/5 \\
            4/5 &amp; 3/5
            \end{pmatrix}, 
            \quad
            \begin{pmatrix}
            1/2 &amp; -\sqrt{3}/2 \\
            \sqrt{3}/2 &amp; 1/2
            \end{pmatrix}, 
            \quad
            \begin{pmatrix}
            -1/\sqrt{2} &amp; 0 &amp; 1/ \sqrt{2} \\
            1/\sqrt{6} &amp; -2/\sqrt{6} &amp; 1/\sqrt{6} \\
            1/ \sqrt{3} &amp; 1/ \sqrt{3} &amp; 1/ \sqrt{3} 
            \end{pmatrix}
          </me>.
        </p>
      </example>

      <p>
        There is a more geometric way of viewing the group <m>O(n)</m>.
        The orthogonal matrices are exactly those matrices that preserve the length of vectors.
        We can define the length of a vector using the
        <term>Euclidean inner product</term>,<idx><h>Euclidean inner product</h></idx>
        or <term>dot product</term>, of two vectors.
        The Euclidean inner product of two vectors
        <m>{\mathbf x}=(x_1, \ldots,
        x_n)^\transpose</m> and <m>{\mathbf y}=(y_1, \ldots, y_n)^\transpose</m> is
        <me>
          \langle  {\mathbf x}, {\mathbf y} \rangle
          =
          {\mathbf x}^\transpose {\mathbf y}
          =
          (x_1, x_2, \ldots, x_n)
          \begin{pmatrix}
          y_1 \\ y_2 \\ \vdots \\ y_n
          \end{pmatrix}
          =
          x_1 y_1 + \cdots + x_n y_n
        </me>.
        We define the length of a vector <m>{\mathbf x}=(x_1, \ldots,
        x_n)^\transpose</m> to be

        <notation>
          <usage><m>\| {\mathbf x} \|</m></usage>
          <description>length of a vector <m>\mathbf x</m></description>
        </notation>

        <me>
          \| {\mathbf x} \| = \sqrt{\langle  {\mathbf x}, {\mathbf x} \rangle}  = \sqrt{x_1^2 + \cdots + x_n^2}
        </me>.
        Associated with the notion of the length of a vector is the idea of the distance between two vectors.
        We define the <term>distance</term>
        between two vectors <m>{\mathbf x}</m> and
        <m>{\mathbf y}</m> to be <m>\| {\mathbf x}-{\mathbf y} \|</m>.
        We leave as an exercise the proof of the following proposition about the properties of Euclidean inner products.
      </p>

      <proposition>
        <statement>
          <p>
            Let <m>{\mathbf x}</m>, <m>{\mathbf y}</m>,
            and <m>{\mathbf w}</m> be vectors in
            <m>{\mathbb R}^n</m> and <m>\alpha \in {\mathbb R}</m>.
            Then

            <ol>
              <li>
                <p>
                  <m>\langle {\mathbf x}, {\mathbf y} \rangle = \langle {\mathbf y}, {\mathbf x} \rangle</m>.
                </p>
              </li>

              <li>
                <p>
                  <m>\langle {\mathbf x}, {\mathbf y} + {\mathbf w} \rangle = \langle {\mathbf x}, {\mathbf y} \rangle + \langle {\mathbf x}, {\mathbf w} \rangle</m>.
                </p>
              </li>

              <li>
                <p>
                  <m>\langle \alpha {\mathbf x}, {\mathbf y} \rangle = \langle {\mathbf x}, \alpha {\mathbf y} \rangle = \alpha \langle {\mathbf x}, {\mathbf y} \rangle</m>.
                </p>
              </li>

              <li>
                <p>
                  <m>\langle {\mathbf x}, {\mathbf x} \rangle \geq 0</m> with equality exactly when <m>{\mathbf x} = 0</m>.
                </p>
              </li>

              <li>
                <p>
                  If <m>\langle {\mathbf x}, {\mathbf y} \rangle = 0</m> for all
                  <m>{\mathbf x}</m> in <m>{\mathbb R}^n</m>,
                  then <m>{\mathbf y} = 0</m>.
                </p>
              </li>
            </ol>
          </p>
        </statement>
      </proposition>

      <example xml:id="matrix-example-on-preserves-length">
        <p>
          The vector <m>{\mathbf x} =(3,4)^\transpose</m> has length <m>\sqrt{3^2 + 4^2} = 5</m>.
          We can also see that the orthogonal matrix
          <me>
            A=
            \begin{pmatrix}
            3/5 &amp; -4/5 \\
            4/5 &amp; 3/5
            \end{pmatrix}
          </me>
          preserves the length of this vector.
          The vector <m>A{\mathbf x} = (-7/5,24/5)^\transpose</m> also has length 5.
        </p>
      </example>

      <p>
        Since <m>\det(A A^\transpose) = \det(I) = 1</m> and <m>\det(A) = \det( A^\transpose )</m>,
        the determinant of any orthogonal matrix is either <m>1</m> or <m>-1</m>.
        Consider the column vectors
        <me>
          {\mathbf a}_j =
          \begin{pmatrix}
          a_{1j} \\ a_{2j} \\ \vdots \\ a_{nj}
          \end{pmatrix}
        </me>
        of the orthogonal matrix <m>A= (a_{ij})</m>.
        Since <m>AA^\transpose = I</m>,
        <m>\langle {\mathbf a}_r, {\mathbf a}_s \rangle = \delta_{rs}</m>, where
        <me>
          \delta_{rs}
          =
          \begin{cases}
          1 &amp; r = s \\
          0 &amp; r \neq s
          \end{cases}
        </me>
        is the <idx><h>Kronecker delta</h></idx>Kronecker delta.
        Accordingly,
        column vectors of an orthogonal matrix all have length 1;
        and the Euclidean inner product of distinct column vectors is zero.
        Any set of vectors satisfying these properties is called an
        <idx><h>Orthonormal set</h></idx><term>orthonormal set</term>.
        Conversely, given an <m>n \times n</m> matrix <m>A</m> whose columns form an orthonormal set,
        it follows that <m>A^{-1} = A^\transpose</m>.
      </p>

      <p>
        We say that a matrix <m>A</m> is
        <term>distance-preserving</term>,<idx><h>Matrix</h><h>distance-preserving</h></idx>
        <term>length-preserving</term>,<idx><h>Matrix</h><h>length-preserving</h></idx>
        or <term>inner product-preserving</term><idx><h>Matrix</h><h>inner product-preserving</h></idx> when <m>\| A{\mathbf x}- A{\mathbf y} \| =\| {\mathbf x}- {\mathbf y} \|</m>,
        <m>\| A{\mathbf x} \| =\| {\mathbf x} \|</m>,
        or <m>\langle A{\mathbf x}, A{\mathbf y} \rangle = \langle {\mathbf x},{\mathbf y} \rangle</m>,
        respectively.
        The following theorem, which characterizes the orthogonal group,
        says that these notions are the same.
      </p>

      <theorem xml:id="matrix-theorem-orthnormal-matrix">
        <statement>
          <p>
            Let <m>A</m> be an <m>n \times n</m> matrix.
            The following statements are equivalent.

            <ol>
              <li>
                <p>
                  The columns of the matrix <m>A</m> form an orthonormal set.
                </p>
              </li>

              <li>
                <p>
                  <m>A^{-1} = A^\transpose</m>.
                </p>
              </li>

              <li>
                <p>
                  For vectors <m>{\mathbf x}</m> and <m>{\mathbf y}</m>,
                  <m>\langle A{\mathbf x}, A {\mathbf y} \rangle = \langle {\mathbf x}, {\mathbf y} \rangle</m>.
                </p>
              </li>

              <li>
                <p>
                  For vectors <m>{\mathbf x}</m> and <m>{\mathbf y}</m>,
                  <m>\| A{\mathbf x}- A{\mathbf y} \| = \| {\mathbf x}- {\mathbf y} \|</m>.
                </p>
              </li>

              <li>
                <p>
                  For any vector <m>{\mathbf x}</m>,
                  <m>\| A{\mathbf x} \| = \| {\mathbf x}\|</m>.
                </p>
              </li>
            </ol>
          </p>
        </statement>

        <proof>
          <p>
            We have already shown (1) and (2) to be equivalent.
          </p>

          <p>
            <m>(2) \Rightarrow (3)</m>.
            <md>
              <mrow>\langle A{\mathbf x}, A{\mathbf y} \rangle &amp; = (A {\mathbf x})^\transpose A {\mathbf y}</mrow>
              <mrow>&amp; = {\mathbf x}^\transpose A^\transpose A {\mathbf y}</mrow>
              <mrow>&amp; = {\mathbf x}^\transpose {\mathbf y}</mrow>
              <mrow>&amp; = \langle {\mathbf x}, {\mathbf y} \rangle</mrow>
            </md>.
          </p>

          <p>
            <m>(3) \Rightarrow (2)</m>.
            First, 
              <m>\langle A{\mathbf x}, A {\mathbf y} \rangle = (A{\mathbf x})^\transpose A{\mathbf y} = {\mathbf x}^\transpose A^\transpose A {\mathbf y} = {\mathbf x}^\transpose {\mathbf y}.</m>
            If <m>M</m> is any <m>n \times n</m> matrix, then <m>\mathbf e_i^\transpose M \mathbf e_j^\transpose = M_{ij}</m>, where <m>M_{ij}</m> is the <m>ij</m>th entry of the matrix <m>M</m>.  Noticing that <m>{\mathbf x}^\transpose A^\transpose A {\mathbf y} = {\mathbf x}^\transpose {\mathbf y}</m>, let <m>\mathbf x = \mathbf e_i</m> and <m>\mathbf y = \mathbf e_j</m>.  Then 
              <me>\mathbf e_i^\transpose A^\transpose A \mathbf e_j = \mathbf e_i^\transpose \mathbf e_j.</me>
            Thus, the <m>ij</m>th component of <m>A^\transpose A</m>is <m>1</m> when <m>i = j</m> and <m>0</m> otherwise.  In other words <m>A^\transpose A = I</m>, and <m>A^{-1} = A^\transpose</m>.

            <!--Since
            <md>
              <mrow>\langle {\mathbf x}, {\mathbf x} \rangle &amp; = \langle A{\mathbf x}, A{\mathbf x} \rangle</mrow>
              <mrow>&amp; = {\mathbf x}^\transpose A^\transpose A {\mathbf x}</mrow>
              <mrow>&amp; = \langle {\mathbf x}, A^\transpose A{\mathbf x} \rangle</mrow>
            </md>,
            we know that <m>\langle {\mathbf x}, (A^\transpose A - I){\mathbf x} \rangle = 0</m> for all <m>{\mathbf x}</m>.
            Therefore, <m>A^\transpose A -I = 0</m> or <m>A^{-1} = A^\transpose</m>.-->
          </p>

          <p>
            <m>(3) \Rightarrow (4)</m>.
            If <m>A</m> is inner product-preserving,
            then <m>A</m> is distance-preserving, since
            <md>
              <mrow>\| A{\mathbf x} - A{\mathbf y} \|^2 &amp; = \| A({\mathbf x} - {\mathbf y}) \|^2</mrow>
              <mrow>&amp; = \langle A({\mathbf x} - {\mathbf y}), A({\mathbf x} - {\mathbf y}) \rangle</mrow>
              <mrow>&amp; = \langle {\mathbf x} - {\mathbf y}, {\mathbf x} - {\mathbf y} \rangle</mrow>
              <mrow>&amp; = \| {\mathbf x} - {\mathbf y} \|^2</mrow>
            </md>.
          </p>

          <p>
            <m>(4) \Rightarrow (5)</m>.
            If <m>A</m> is distance-preserving,
            then <m>A</m> is length-preserving.
            Letting <m>{\mathbf y} = 0</m>, we have
            <me>
              \| A{\mathbf x}\| = \| A{\mathbf x}- A{\mathbf y} \| = \| {\mathbf x}- {\mathbf y} \| = \| {\mathbf x} \|
            </me>.
          </p>

          <p>
            <m>(5) \Rightarrow (3)</m>.
            We use the following identity to show that length-preserving implies inner product-preserving:
            <me>
              \langle {\mathbf x}, {\mathbf y} \rangle = \frac{1}{2} \left[ \|{\mathbf x} +{\mathbf y}\|^2 - \|{\mathbf x}\|^2 - \|{\mathbf y}\|^2 \right]
            </me>.
            Observe that
            <md>
              <mrow>\langle A {\mathbf x}, A {\mathbf y} \rangle &amp; = \frac{1}{2} \left[ \|A {\mathbf x} + A {\mathbf y} \|^2 - \|A {\mathbf x} \|^2 -  \|A {\mathbf y} \|^2 \right]</mrow>
              <mrow>&amp; = \frac{1}{2} \left[ \|A ( {\mathbf x} + {\mathbf y} ) \|^2 - \|A {\mathbf x} \|^2 -  \|A {\mathbf y} \|^2 \right]</mrow>
              <mrow>&amp; = \frac{1}{2} \left[ \|{\mathbf x} + {\mathbf y}\|^2 - \|{\mathbf x}\|^2 - \|{\mathbf y}\|^2 \right]</mrow>
              <mrow>&amp; = \langle {\mathbf x}, {\mathbf y} \rangle</mrow>
            </md>.
          </p>
        </proof>
      </theorem>
<!--=============================-->
      <figure xml:id="matrix-figure-o2">
        <caption><m>O(2)</m> acting on <m>\mathbb R^2</m></caption>
            <!-- Replaced figure with tikz figure - TWJ 6/11/2010 -->
            <!-- Fixed tikz figure - TWJ 12/8/2011 -->
        <sidebyside width="40%" margins="auto" valign="middle">
          <image xml:id="matrix-o2-a">
          	<description>Two side-by figures. The figure on the left is a set of axes with an arrow pointing up and right from the origin to (a,b) and the second arrow pointing down and right from the origin to a point (a, -b). The figure on the right is a set of axes with an arrow pointed up and right from the origin to (cosine theta, sine theta) and an arrow point up and left at a right angle to the first vector from the origin to (sine theta, minus cosine theta).</description>
              <latex-image>
                  <xi:include href="tikz/matrix-o2-a.tex" parse="text"/>
              </latex-image>
          </image>

          <image xml:id="matrix-o2-b">
            <description>Two side-by figures. The figure on the left is a set of axes with an arrow pointing up and right from the origin to (a,b) and the second arrow pointing down and right from the origin to a point (a, -b). The figure on the right is a set of axes with an arrow pointed up and right from the origin to (cosine theta, sine theta) and an arrow point up and left at a right angle to the first vector from the origin to (sine theta, minus cosine theta).</description>
              <latex-image>
                  <xi:include href="tikz/matrix-o2-b.tex" parse="text"/>
              </latex-image>
          </image>

        </sidebyside>

      </figure>

<!--=============================-->
            <!-- Clarified what it means to be a reflection - TWJ 12/8/2011 -->
      <example xml:id="matrix-example-o2">
        <p>
          Let us examine the orthogonal group on <m>{\mathbb R}^2</m> a bit more closely.
          An element <m>A \in O(2)</m> is determined by its action on
          <m>{\mathbf e}_1 = (1, 0)^\transpose</m> and <m>{\mathbf e}_2 = (0, 1)^\transpose</m>.
          If <m>A{\mathbf e}_1 = (a,b)^\transpose</m>,
          then <m>a^2 + b^2 = 1</m>, since the length of a vector must be preserved when it is multiplied by <m>A</m>. Since multiplication of an element of <m>O(2)</m> preserves length and orthogonality, <m>A{\mathbf e}_2 = \pm(-b, a)^\transpose</m>.
          If we choose <m>A{\mathbf e}_2 = (-b, a)^\transpose</m>, then
          <me>
            A
            =
            \begin{pmatrix}
            a &amp; -b \\
            b &amp; a
            \end{pmatrix}
            =
            \begin{pmatrix}
            \cos \theta &amp; - \sin \theta \\
            \sin \theta &amp; \cos \theta
            \end{pmatrix},
          </me>
          where <m>0 \leq \theta \lt 2 \pi</m>.
          The matrix <m>A</m> rotates a vector in <m>\mathbb R^2</m> counterclockwise about the origin by an angle of <m>\theta</m> (<xref ref="matrix-figure-o2"/>).</p>

          <p>If we choose <m>A{\mathbf e}_2 = (b, -a)^\transpose</m>, then we obtain the matrix
		  <me>
            B
            =
            \begin{pmatrix}
            a &amp; b \\
            b &amp; -a
            \end{pmatrix}
            =
            \begin{pmatrix}
            \cos \theta &amp; \sin \theta \\
            \sin \theta &amp; -\cos \theta
            \end{pmatrix}.
          </me>
          Here, <m>\det B = -1</m> and 
          <me>
            B^2
            =
            \begin{pmatrix}
            1 &amp; 0 \\
            0 &amp; 1
            \end{pmatrix}.
          </me>
          A reflection about the horizontal axis is given by the matrix
          <me>
            C
            =
            \begin{pmatrix}
            1 &amp; 0 \\
            0 &amp; -1
            \end{pmatrix},
          </me>
          and <m>B = AC</m> (see <xref ref="matrix-figure-o2"/>). Thus,
          a reflection about a line <m>\ell</m> is simply a reflection about the horizontal axis followed by a rotation.
        </p>
      </example>

      <p>
        Two of the other matrix or matrix-related groups that we will consider are the special orthogonal group  and the group of Euclidean motions.
        The <term>special orthogonal group</term>,<idx><h>Group</h><h>special orthogonal</h></idx>
        <m>SO(n)</m>,
        is just the intersection of <m>O(n)</m> and <m>SL_n({\mathbb R})</m>;
        that is, those elements in <m>O(n)</m> with determinant one.

        <notation>
          <usage><m>SO(n)</m></usage>
          <description>special orthogonal group</description>
        </notation>

        The <term>Euclidean group</term>,<idx><h>Euclidean group</h></idx><idx><h>Group</h><h>Euclidean</h></idx>
        <m>E(n)</m>,
        can be written as ordered pairs <m>(A, {\mathbf x})</m>,
        where <m>A</m> is in <m>O(n)</m> and
        <m>{\mathbf x}</m> is in <m>{\mathbb R}^n</m>.
        We define multiplication by

        <notation>
          <usage><m>E(n)</m></usage>
          <description>Euclidean group</description>
        </notation>

        <me>
          (A, {\mathbf x}) (B, {\mathbf y}) = (AB, A {\mathbf y} +{\mathbf x})
        </me>.
        The identity of the group is <m>(I,{\mathbf 0})</m>;
        the inverse of <m>(A, {\mathbf x})</m> is <m>(A^{-1}, -A^{-1} {\mathbf x})</m>.
        In <xref ref="matrix-exercise-en-group"/>,
        you are asked to check that <m>E(n)</m> is indeed a group under this operation.
      </p>

<!--
      <figure xml:id="matrix-figure-isometries">
        <caption>Translations in <m>\mathbb R^2</m></caption>
        <image xml:id="matrix-r2-translations">
          <description>Two side-by figures. The figure on the left is a set of axes with an arrow pointing up and right from the origin to a point x. The figure on the right is a set of axes with an arrow of the same length and same direction from a point to the right and above the origin to a point x + y.</description>
          <latex-image>
                <xi:include href="tikz/matrix-r2-translations.tex" parse="text"/>
            </latex-image>
        </image>
      </figure>
-->

      <figure xml:id="matrix-figure-isometries">
        <caption>Translations in <m>\mathbb R^2</m></caption>
        <sidebyside width="40%" margins="auto" valign="middle">
          <image xml:id="matrix-r2-translations-a">
            <description>A set of axes with an arrow pointing up and right from the origin to a point x.</description>
              <latex-image>
                  <xi:include href="tikz/matrix-r2-translations-a.tex" parse="text"/>
              </latex-image>
          </image>

          <image xml:id="matrix-r2-translations-b">
            <description>A set of axes with an arrow of the same length and same direction as in the previous diagram from a point to the right and above the origin to a point x + y.</description>
              <latex-image>
                  <xi:include href="tikz/matrix-r2-translations-b.tex" parse="text"/>
              </latex-image>
          </image>

        </sidebyside>
      </figure>
    </subsection>

  </section>

  <section xml:id="matrix-section-symmetry">
    <title>Symmetry</title>
    <introduction>
      <p>
        An <term>isometry</term><idx><h>Isometry</h></idx>
        or <term>rigid motion</term><idx><h>Rigid motion</h></idx>
        in <m>{\mathbb R}^n</m> is a distance-preserving function <m>f</m> from
        <m>{\mathbb R}^n</m> to <m>{\mathbb R}^n</m>.
        This means that <m>f</m> must satisfy
        <me>
          \| f({\mathbf x}) - f({\mathbf y}) \| =\|{\mathbf x} - {\mathbf y} \|
        </me>
        for all <m>{\mathbf x}, {\mathbf y} \in {\mathbb R}^n</m>.
        It is not difficult to show that <m>f</m> must be a one-to-one map.
        By <xref ref="matrix-theorem-orthnormal-matrix"/>,
        any element in <m>O(n)</m> is an isometry on <m>{\mathbb R}^n</m>;
        however, <m>O(n)</m> does not include all possible isometries on <m>{\mathbb R}^n</m>.
        Translation by a vector <m>{\mathbf x}</m>,
        <m>T_{\mathbf y}({\mathbf x}) = {\mathbf x} + {\mathbf y}</m> is also an isometry (<xref ref="matrix-figure-isometries"/>);
        however, <m>T</m> cannot be in <m>O(n)</m> since it is not a linear map.
      </p>

      <p>
        We are mostly interested in isometries in <m>{\mathbb R}^2</m>.
        In fact, the only isometries in
        <m>{\mathbb R}^2</m> are rotations and reflections about the origin,
        translations, and combinations of the two.
        For example, a <term>glide reflection</term><idx><h>Glide reflection</h></idx>
        is a translation followed by a reflection (<xref ref="matrix-figure-glide"/>).
        In <m>{\mathbb R}^n</m> all isometries are given in the same manner.
        The proof is very easy to generalize.
      </p>
<!--
      <figure xml:id="matrix-figure-glide">
        <caption>Glide reflections</caption>
        <image xml:id="matrix-glide-reflections">
        	<description>Two side-by figures. The figure on the left is a set of axes with an arrow pointing up and right from the origin to a point x. The figure on the right is a set of axes with an arrow of the same length but pointing down and right from a point on the horizontal axis to a point T(x).</description>
            <latex-image>
                <xi:include href="tikz/matrix-glide-reflections.tex" parse="text"/>
            </latex-image>
        </image>

      </figure>
-->
      <figure xml:id="matrix-figure-glide">
        <caption>Glide reflections</caption>
        <sidebyside width="40%" margins="auto" valign="middle">
          <image xml:id="matrix-glide-reflections-a">
            <description>A set of axes with an arrow pointing up and right from the origin to a point x.</description>
              <latex-image>
                  <xi:include href="tikz/matrix-glide-reflections-a.tex" parse="text"/>
              </latex-image>
          </image>

          <image xml:id="matrix-glide-reflections-b">
            <description>A set of axes with an arrow of the same length but pointing down and right from a point on the horizontal axis to a point T(x).</description>
              <latex-image>
                  <xi:include href="tikz/matrix-glide-reflections-b.tex" parse="text"/>
              </latex-image>
          </image>

        </sidebyside>
      </figure>

            <lemma>
        <statement>
          <p>
            An isometry <m>f</m> that fixes the origin in
            <m>{\mathbb R}^2</m> is a linear transformation.
            In particular, <m>f</m> is given by an element in <m>O(2)</m>.
          </p>
        </statement>

        <proof>
          <p>
            Let <m>f</m> be an isometry in <m>{\mathbb R}^2</m> fixing the origin.
            We will first show that <m>f</m> preserves inner products.
            Since <m>f(0) = 0</m>,
            <m>\| f({\mathbf x})\| = \| {\mathbf x} \|</m>; therefore,
            <md>
              <mrow>\| {\mathbf x} \|^2 - 2 \langle f({\mathbf x}), f({\mathbf y}) \rangle + \| {\mathbf y} \|^2  &amp; = \| f({\mathbf x}) \|^2 - 2 \langle f({\mathbf x}), f({\mathbf y}) \rangle + \| f({\mathbf y}) \|^2</mrow>
              <mrow>&amp; = \langle f({\mathbf x}) -  f({\mathbf y}), f({\mathbf x}) - f({\mathbf y}) \rangle</mrow>
              <mrow>&amp; = \| f({\mathbf x}) - f({\mathbf y}) \|^2</mrow>
              <mrow>&amp; = \| {\mathbf x} - {\mathbf y} \|^2</mrow>
              <mrow>&amp; = \langle {\mathbf x} - {\mathbf y}, {\mathbf x} - {\mathbf y} \rangle</mrow>
              <mrow>&amp; = \| {\mathbf x} \|^2 - 2 \langle {\mathbf x}, {\mathbf y} \rangle + \| {\mathbf y} \|^2</mrow>
            </md>.
            Consequently,
            <me>
              \langle f({\mathbf x}), f({\mathbf y}) \rangle = \langle {\mathbf x}, {\mathbf y} \rangle
            </me>.
            Now let <m>{\mathbf e}_1</m> and <m>{\mathbf e_2}</m> be
            <m>(1, 0)^\transpose</m> and <m>(0, 1)^\transpose</m>,
            respectively.
            If
            <me>
              {\mathbf x} = (x_1, x_2) = x_1 {\mathbf e}_1 + x_2 {\mathbf e}_2
            </me>,
            then
            <me>
              f({\mathbf x}) = \langle f({\mathbf x}), f({\mathbf e}_1) \rangle f({\mathbf e}_1) + \langle f({\mathbf x}), f({\mathbf e}_2) \rangle f({\mathbf e}_2) = x_1 f({\mathbf e}_1)+x_2 f({\mathbf e}_2)
            </me>.
            The linearity of <m>f</m> easily follows.
          </p>
        </proof>
      </lemma>

      <p>
        For any arbitrary isometry, <m>f</m>,
        <m>T_{\mathbf x} f</m> will fix the origin for some vector
        <m>{\mathbf x}</m> in <m>{\mathbb R}^2</m>;
        hence, <m>T_{\mathbf x} f({\mathbf y}) = A {\mathbf y}</m> for some matrix <m>A \in O(2)</m>.
        Consequently,
        <m>f({\mathbf y}) = A {\mathbf y} + {\mathbf x}</m>.
        Given the isometries
        <md>
          <mrow>f({\mathbf y}) &amp; = A {\mathbf y} + {\mathbf x}_1</mrow>
          <mrow>g({\mathbf y}) &amp; = B {\mathbf y} + {\mathbf x}_2</mrow>
        </md>,
        their composition is
        <me>
          f(g({\mathbf y})) = f(B {\mathbf y} + {\mathbf x}_2) = AB {\mathbf y} + A{\mathbf x}_2 + {\mathbf x}_1
        </me>.
        This last computation allows us to identify the group of isometries on <m>{\mathbb R}^2</m> with <m>E(2)</m>.
      </p>

      <theorem>
        <statement>
          <p>
            The group of isometries on
            <m>{\mathbb R}^2</m> is the Euclidean group, <m>E(2)</m>.
          </p>
        </statement>
      </theorem>

      <p>
        A <term>symmetry group</term><idx><h>Group</h><h>symmetry</h></idx>
        in <m>{\mathbb R}^n</m> is a subgroup of the group of isometries on
        <m>{\mathbb R}^n</m> that fixes a set of points <m>X \subset {\mathbb R}^n</m>.
        It is important to realize that the symmetry group of <m>X</m> depends <em>both</em>
        on <m>{\mathbb R}^n</m> and on <m>X</m>.
        For example, the symmetry group of the origin in
        <m>{\mathbb R}^1</m> is <m>{\mathbb Z}_2</m>,
        but the symmetry group of the origin in <m>{\mathbb R}^2</m> is <m>O(2)</m>.
      </p>

      <theorem>
        <statement>
          <p>
            The only finite symmetry groups in
            <m>{\mathbb R}^2</m> are <m>{\mathbb Z}_n</m> and <m>D_n</m>.
          </p>
        </statement>

        <proof>
          <p>
          	We simply need to find all of the finite subgroups <m>G</m> of <m>E(2)</m>.
            Any finite symmetry group <m>G</m> in
            <m>{\mathbb R}^2</m> must fix the origin  and must be a finite subgroup of <m>O(2)</m>,
            since translations and glide reflections have infinite order.
            By <xref ref="matrix-example-o2"/>,
            elements in <m>O(2)</m> are either rotations of the form
            <me>
              R_{\theta}
              =
              \begin{pmatrix}
              \cos \theta &amp; - \sin \theta \\
              \sin \theta &amp; \cos \theta
              \end{pmatrix}
            </me>
            or reflections of the form
            <me>
              T_{\phi}
              =
              \begin{pmatrix}
              \cos \phi &amp;  - \sin \phi \\
              \sin \phi &amp; \cos \phi
              \end{pmatrix}
              \begin{pmatrix}
              1 &amp; 0 \\
              0 &amp; -1
              \end{pmatrix}
              =
              \begin{pmatrix}
              \cos \phi &amp;  \sin \phi \\
              \sin \phi &amp; - \cos \phi
              \end{pmatrix}
            </me>.
            Notice that <m>\det(R_{\theta})=1</m>,
            <m>\det(T_{\phi})=-1</m>, and <m>T_{\phi}^2=I</m>.
            We can divide the proof up into two cases.
            In the first case,
            all of the elements in <m>G</m> have determinant one.
            In the second case,
            there exists at least one element in <m>G</m> with determinant <m>-1</m>.
          </p>
          <case>
            <title>Case 1</title>
            <p>
              The determinant of every element in <m>G</m> is one.
              In this case every element in <m>G</m> must be a rotation.
              Since <m>G</m> is finite, there is a smallest angle, say <m>\theta_0</m>,
              such that the corresponding element
              <m>R_{\theta_0}</m> is the smallest rotation in the positive direction.
              We claim that <m>R_{\theta_0}</m> generates <m>G</m>.
              If not, then for some positive integer <m>n</m> there is an angle <m>\theta_1</m> between
              <m>n \theta_0</m> and <m>(n+1) \theta_0</m>.
              If so, then <m>(n+1) \theta_0 - \theta_1</m> corresponds to a rotation smaller than <m>\theta_0</m>,
              which contradicts the minimality of <m>\theta_0</m>.
            </p>
          </case>
          <case>
            <title>Case 2</title>
            <p>
              The group <m>G</m> contains a reflection <m>T</m>.
              The kernel of the homomorphism <m>\phi : G \rightarrow \{-1, 1\}</m> given by
              <m>A \mapsto \det(A)</m> consists of elements whose determinant is 1.
              Therefore, <m>|G/ \ker \phi|=2</m>.
              We know that the kernel is cyclic by the first case and is a subgroup of <m>G</m> of, say,
              order <m>n</m>.
              Hence, <m>|G| = 2n</m>.
              The elements of <m>G</m> are
              <me>
                R_{\theta}, \ldots, R_{\theta}^{n-1},  TR_{\theta}, \ldots, TR_{\theta}^{n-1}
              </me>.
              These elements satisfy the relation
              <me>
                TR_{\theta}T = R_{\theta}^{-1}
              </me>.
              Consequently,
              <m>G</m> must be isomorphic to <m>D_n</m> in this case.
            </p>
          </case>
        </proof>
      </theorem>
    </introduction>

    <subsection xml:id="matrix-subsection-wallpaper">
      <title>The Wallpaper Groups</title>
      <p>
        Suppose that we wish to study wallpaper patterns in the plane or crystals in three dimensions.
        Wallpaper patterns are simply repeating patterns in the plane (<xref ref="matrix-figure-wallpaper"/>).
        The analogs of wallpaper patterns in <m>{\mathbb R}^3</m> are crystals,
        which we can think of as repeating patterns of molecules in three dimensions (<xref ref="matrix-figure-crystals"/>).
        The mathematical equivalent of a wallpaper or crystal pattern is called a lattice.
      </p>


      <figure xml:id="matrix-figure-wallpaper">
        <caption>A wallpaper pattern in <m>\mathbb R^2</m></caption>
            <!-- Replaced figure with tikz figure - TWJ 6/11/2010 -->
        <image xml:id="matrix-wallpaper-r2">
        	<description>A wallpaper of chevrons with the top row of chevrons pointing downward, the second row of chevrons pointing upwards, and so on.</description>
            <latex-image>
                <xi:include href="tikz/matrix-wallpaper-r2.tex" parse="text"/>
            </latex-image>
        </image>

      </figure>

      <figure xml:id="matrix-figure-crystals">
        <caption>A crystal structure in <m>\mathbb R^3</m></caption>
            <!-- Replaced figure with tikz figure - TWJ 6/11/2010 -->
        <image width="50%" xml:id="matrix-crystal-r3">
        	<description>A three-dimensional lattice of cubes that are slanted to the right.  The vertices are highlighted with small filled circles.</description>
            <latex-image>
                <xi:include href="tikz/matrix-crystal-r3.tex" parse="text"/>
            </latex-image>
        </image>

      </figure>

      <p>
        Let us examine wallpaper patterns in the plane a little more closely.
        Suppose that <m>{\mathbf x}</m> and
        <m>{\mathbf y}</m> are linearly independent vectors in <m>{\mathbb R}^2</m>;
        that is, one vector cannot be a scalar multiple of the other.
        A <term>lattice</term><idx><h>Lattice of points</h></idx>
        of <m>{\mathbf x}</m> and <m>{\mathbf y}</m> is the set of all linear combinations <m>m {\mathbf x} + n {\mathbf y}</m>,
        where <m>m</m> and <m>n</m> are integers.
        The vectors <m>{\mathbf x}</m> and
        <m>{\mathbf y}</m> are said to be a <term>basis</term><idx><h>Basis of a lattice</h></idx>
        for the lattice.
      </p>

      <p>
        Notice that a lattice can have several bases.
        For example, the vectors <m>(1,1)^\transpose</m> and
        <m>(2,0)^\transpose</m> have the  same lattice as the vectors <m>(-1, 1)^\transpose</m> and
        <m>(-1, -1)^\transpose</m> (<xref ref="matrix-figure-lattice"/>).
        However, any lattice is completely determined by a basis.
        Given two bases for the same lattice,
        say <m>\{ {\mathbf x}_1, {\mathbf x}_2 \}</m> and <m>\{ {\mathbf y}_1, {\mathbf y}_2 \}</m>,
        we can write
        <md>
          <mrow>{\mathbf y}_1 &amp; = \alpha_1  {\mathbf x}_1 + \alpha_2 {\mathbf x}_2</mrow>
          <mrow>{\mathbf y}_2 &amp; = \beta_1  {\mathbf x}_1 + \beta_2 {\mathbf x}_2</mrow>
        </md>,
        where <m>\alpha_1</m>, <m>\alpha_2</m>, <m>\beta_1</m>,
        and <m>\beta_2</m> are integers.
        The matrix corresponding to this transformation is
        <me>
          U
          =
          \begin{pmatrix}
          \alpha_1 &amp; \alpha_2 \\
          \beta_1 &amp; \beta_2
          \end{pmatrix}
        </me>.
        If we wish to give <m>{\mathbf x}_1</m> and <m>{\mathbf x}_2</m> in terms of
        <m>{\mathbf y}_1</m> and <m>{\mathbf y}_2</m>,
        we need only calculate <m>U^{-1}</m>; that is,
        <me>
          U^{-1}
          \begin{pmatrix}
          {\mathbf y}_1 \\ {\mathbf y}_2
          \end{pmatrix}
          =
          \begin{pmatrix}
          {\mathbf x}_1 \\ {\mathbf x}_2
          \end{pmatrix}
        </me>.
        Since <m>U</m> has integer entries,
        <m>U^{-1}</m> must also have integer entries;
        hence the determinants of both <m>U</m> and <m>U^{-1}</m> must be integers.
        Because <m>U U^{-1} = I</m>,
        <me>
          \det(U U^{-1}) =\det(U) \det( U^{-1}) = 1;
        </me>
        consequently, <m>\det(U) = \pm 1</m>.
        A matrix with determinant <m>\pm 1</m> and integer entries is called <idx><h>Matrix</h><h>unimodular</h></idx><term>unimodular</term>.
        For example, the matrix
        <me>
          \begin{pmatrix}
          3 &amp; 1 \\
          5 &amp; 2
          \end{pmatrix}
        </me>
        is unimodular.
        It should be clear that there is a minimum length for vectors in a lattice.
      </p>

      <figure xml:id="matrix-figure-lattice">
        <caption>A lattice in  <m>\mathbb R^2</m></caption>
            <!-- Replaced figure with tikz figure - TWJ 6/11/2010 -->
        <image xml:id="matrix-lattice-r2">
        	<description>A lattice of parallelograms slanted to the right.  There are four arrows, each beginning in the center at the origin and pointing to the right to (2,0), pointing up and right to (1,1), pointing up and left to (
        		minus one, one), and pointing down and left to (minus one, minus one).</description>
            <latex-image>
                <xi:include href="tikz/matrix-lattice-r2.tex" parse="text"/>
            </latex-image>
        </image>

      </figure>

      <p>
        We can classify lattices by studying their symmetry groups.
        The symmetry group of a lattice is the subgroup of <m>E(2)</m> that maps the lattice to itself.
        We consider two lattices in
        <m>{\mathbb R}^2</m> to be equivalent if they have the same symmetry group.
        Similarly, classification of crystals in
        <m>{\mathbb R}^3</m> is accomplished by associating a symmetry group,
        called a <term>space group</term>,<idx><h>Group</h><h>space</h></idx>
        with each type of crystal.
        Two lattices are considered different if their space groups are not the same.
        The natural question that now arises is how many space groups exist.
      </p>

      <p>
        A space group is composed of two parts:
        a <term>translation subgroup</term><idx><h>Subgroup</h><h>translation</h></idx> and a <idx><h>Group</h><h>point</h></idx><term>point</term>.
        The translation subgroup is an infinite abelian subgroup of the space group made up of the translational symmetries of the crystal;
        the point group is a finite group consisting of rotations and reflections of the crystal about a point.
        More specifically, a space group is a subgroup of
        <m>G \subset E(2)</m> whose translations are a set of the form <m>\{ (I, t) : t \in L \}</m>,
        where <m>L</m> is a lattice.
        Space groups are, of course, infinite.
        Using geometric arguments, we can prove the following theorem
        (see [5] or [6]).
      </p>

      <theorem>
        <statement>
          <p>
            Every translation group in
            <m>{\mathbb R}^2</m> is isomorphic to <m>{\mathbb Z} \times {\mathbb Z}</m>.
          </p>
        </statement>
      </theorem>

      <p>
        The point group of <m>G</m> is <m>G_0 = \{A : (A,b) \in G \text{ for some } b \}</m>.
        In particular, <m>G_0</m> must be a subgroup of <m>O(2)</m>.
        Suppose that <m>{\mathbf x}</m> is a vector in a lattice <m>L</m> with space group <m>G</m>,
        translation group <m>H</m>, and point group <m>G_0</m>.
        For any element <m>(A, {\mathbf y})</m> in <m>G</m>,
        <md>
          <mrow>(A, {\mathbf y}) (I, {\mathbf x}) (A, {\mathbf y})^{-1} &amp; = (A,A {\mathbf x} + {\mathbf y}) (A^{-1},-A^{-1} {\mathbf y})</mrow>
          <mrow>&amp; = (A A^{-1},-A A^{-1} {\mathbf y} + A {\mathbf x} + {\mathbf y})</mrow>
          <mrow>&amp; = (I, A {\mathbf x});</mrow>
        </md>
        hence, <m>(I, A {\mathbf x})</m> is in the translation group of <m>G</m>.
        More specifically,
        <m>A {\mathbf x}</m> must be in the lattice <m>L</m>.
        It is important to note that <m>G_0</m> is not usually a subgroup of the space group <m>G</m>;
        however, if <m>T</m> is the translation subgroup of <m>G</m>,
        then <m>G/T \cong G_0</m>.
        The proof of the following theorem can be found in [2], [5], or [6].
      </p>

      <theorem>
        <statement>
          <p>
            The point group in the wallpaper groups is isomorphic to <m>{\mathbb Z}_n</m> or <m>D_n</m>,
            where <m>n = 1, 2, 3, 4, 6</m>.
          </p>
        </statement>
      </theorem>

      <p>
        To answer the question of how the point groups and the translation groups can be combined,
        we must look at the different types of lattices.
        Lattices can be classified by the structure of a single lattice cell.
        The possible cell shapes are parallelogram,
        rectangular, square, rhombic,
        and hexagonal (<xref ref="matrix-figure-lattice-types"/>).
        The wallpaper groups can now be classified according to the types of reflections that occur in each group:
        these are ordinarily reflections,
        glide reflections, both, or none.
      </p>


      <figure xml:id="matrix-figure-lattice-types">
        <caption>Types of lattices in  <m>\mathbb R^2</m></caption>
        <image xml:id="matrix-lattices-r2">
        	<description>There are two rows of figures.  The left top figure is a lattice of squares, the middle top figure is a lattice of rectangles that are not squares, the right top figure is  a lattice of rhombuses slanted to the left. The bottom left figure is a lattice of parallelograms that are not rhombuses slanted to the left.  The bottom right figure is a lattice of equilateral triangles, six of which make up a regular hexagon.</description>
            <latex-image>
                <xi:include href="tikz/matrix-lattices-r2.tex" parse="text"/>
            </latex-image>
        </image>

      </figure>

<!--
      <figure xml:id="matrix-figure-lattice-types">
        <caption>Types of lattices in  <m>\mathbb R^2</m></caption>

        <sbsgroup>

          <sidebyside width="25%" margins="auto" valign="middle">

            <image xml:id="matrix-lattices-r2-square">
              <description>A lattice of squares.</description>
              <latex-image>
                <xi:include href="tikz/matrix-lattices-r2-square.tex" parse="text"/>
              </latex-image>
            </image>

            <image xml:id="matrix-lattices-r2-rectangle">
              <description>A lattice of rectangles that are not squares.</description>
              <latex-image>
                <xi:include href="tikz/matrix-lattices-r2-rectangle.tex" parse="text"/>
              </latex-image>
            </image>            

            <image xml:id="matrix-lattices-r2-rhombus">
              <description>A lattice of rhombuses slanted to the left.</description>
                <latex-image>
                  <xi:include href="tikz/matrix-lattices-r2-rhombus.tex" parse="text"/>
                </latex-image>
              </image>

          </sidebyside>

          <sidebyside width="40%" margins="auto" valign="middle">

            <image xml:id="matrix-lattices-r2-parallelogram">
              <description>A lattice of parallelograms</description>
              <latex-image>
                <xi:include href="tikz/matrix-lattices-r2-parallelogram.tex" parse="text"/>
              </latex-image>
            </image>

            <image xml:id="matrix-lattices-r2-hexagon">
              <description>A lattice of equilateral triangles, six of which make up a regular hexagon.</description>
              <latex-image>
                <xi:include href="tikz/matrix-lattices-r2-hexagon.tex" parse="text"/>
              </latex-image>
            </image>

          </sidebyside>

        </sbsgroup>
      </figure>

-->
      <table xml:id="matrix-table-wallpaper">
        <title>The 17 wallpaper groups</title>
        <tabular halign="center" top="medium">
          <row>
            <cell>Notation and</cell>
            <cell/>
            <cell/>
            <cell>Reflections or</cell>
          </row>
          <row bottom="medium">
            <cell>Space Groups</cell>
            <cell>Point Group</cell>
            <cell>Lattice Type</cell>
            <cell>Glide Reflections?</cell>
          </row>
          <row>
            <cell>p1</cell>
            <cell><m>{\mathbb Z}_1</m></cell>
            <cell>parallelogram</cell>
            <cell>none</cell>
          </row>
          <row>
            <cell>p2</cell>
            <cell><m>{\mathbb Z}_2</m></cell>
            <cell>parallelogram</cell>
            <cell>none</cell>
          </row>
          <row>
            <cell>p3</cell>
            <cell><m>{\mathbb Z}_3</m></cell>
            <cell>hexagonal</cell>
            <cell>none</cell>
          </row>
          <row>
            <cell>p4</cell>
            <cell><m>{\mathbb Z}_4</m></cell>
            <cell>square</cell>
            <cell>none</cell>
          </row>
          <row>
            <cell>p6</cell>
            <cell><m>{\mathbb Z}_6</m></cell>
            <cell>hexagonal</cell>
            <cell>none</cell>
          </row>
          <row>
            <cell>pm</cell>
            <cell><m>D_1</m></cell>
            <cell>rectangular</cell>
            <cell>reflections</cell>
          </row>
          <row>
            <cell>pg</cell>
            <cell><m>D_1</m></cell>
            <cell>rectangular</cell>
            <cell>glide reflections</cell>
          </row>
          <row>
            <cell>cm</cell>
            <cell><m>D_1</m></cell>
            <cell>rhombic</cell>
            <cell>both</cell>
          </row>
          <row>
            <cell>pmm</cell>
            <cell><m>D_2</m></cell>
            <cell>rectangular</cell>
            <cell>reflections</cell>
          </row>
          <row>
            <cell>pmg</cell>
            <cell><m>D_2</m></cell>
            <cell>rectangular</cell>
            <cell>glide reflections</cell>
          </row>
          <row>
            <cell>pgg</cell>
            <cell><m>D_2</m></cell>
            <cell>rectangular</cell>
            <cell>both</cell>
          </row>
          <row>
            <cell>c2mm</cell>
            <cell><m>D_2</m></cell>
            <cell>rhombic</cell>
            <cell>both</cell>
          </row>
          <row>
            <cell>p3m1, p31m</cell>
            <cell><m>D_3</m></cell>
            <cell>hexagonal</cell>
            <cell>both</cell>
          </row>
          <row>
            <cell>p4m, p4g</cell>
            <cell><m>D_4</m></cell>
            <cell>square</cell>
            <cell>both</cell>
          </row>
          <row bottom="medium">
            <cell>p6m</cell>
            <cell><m>D_6</m></cell>
            <cell>hexagonal</cell>
            <cell>both</cell>
          </row>
        </tabular>

      </table>

      <theorem>
        <statement>
          <p>
            There are exactly 17 wallpaper groups.
          </p>
        </statement>
      </theorem>

<!--
      <figure xml:id="matrix-figure-p4m">
        <caption>The wallpaper groups p4m and p4g</caption>
        <image xml:id="matrix-p4m-p4g">
        	<description>There are two side by side figures.  The figure on the left is a lattice of squares.  The figure on the right is a lattice of squares and in each square there are four rectangular paths form the center of the square that rotate counterclockwise.</description>
            <latex-image>
                <xi:include href="tikz/matrix-p4m-p4g.tex" parse="text"/>
            </latex-image>
        </image>

      </figure>

-->
      <figure xml:id="matrix-figure-p4m">
        <caption>The wallpaper groups p4m and p4g</caption>
        <sidebyside width="40%" margins="auto" valign="middle">

          <image xml:id="matrix-p4m-p4g-a">
            <description>A square on set of axes with the left edge a vector from the origin to (0,1) and bottom edge a vector from the origin to (1,0).</description>
              <latex-image>
                  <xi:include href="tikz/matrix-p4m-p4g-a.tex" parse="text"/>
              </latex-image>
          </image>

          <image xml:id="matrix-p4m-p4g-b">
            <description>A parallelogram on set of axes with the left edge a vector from the origin to (1,1) and bottom edge a vector from the origin to (1,0).</description>
              <latex-image>
                  <xi:include href="tikz/matrix-p4m-p4g-b.tex" parse="text"/>
              </latex-image>
          </image>

        </sidebyside>
      </figure>

      <p>
        The 17 wallpaper groups are listed in <xref ref="matrix-table-wallpaper"/>.
        The groups p3m1 and p31m can be distinguished by whether or not all of their threefold centers lie on the reflection axes:
        those of p3m1 must, whereas those of p31m may not.
        Similarly, the fourfold centers of p4m must lie on the reflection axes whereas those of p4g need not (<xref ref="matrix-figure-p4m"/>).
        The complete proof of this theorem can be found in several of the references at the end of this chapter,
        including [5], [6], [10], and [11].
      </p>

      <paragraphs component="sage-blurb">
        <title>Sage</title>
        <p>
          We have not seen how to use Sage profitably with the material in this chapter.
        </p>
      </paragraphs>

    </subsection>

    <subsection xml:id="matrix-subsection-historical-note">
      <title>Historical Note</title>
      <p>
        Symmetry groups have intrigued mathematicians for a long time.
        Leonardo da Vinci was probably the first person to know all of the point groups.
        At the International Congress of Mathematicians in 1900, David Hilbert<idx><h>Hilbert, David</h></idx>
        gave a now-famous address outlining 23 problems to guide mathematics in the twentieth century.
        Hilbert's eighteenth problem asked whether or not crystallographic groups in <m>n</m> dimensions were always finite.
        In 1910, L. Bieberbach<idx><h>Bieberbach, L.</h></idx>
        proved that crystallographic groups are finite in every dimension.
        Finding out how many of these groups there are in each dimension is another matter.
        In <m>{\mathbb R}^3</m> there are 230 different space groups;
        in <m>{\mathbb R}^4</m> there are 4783.
        No one has been able to compute the number of space groups for <m>{\mathbb R}^5</m> and beyond.
        It is interesting to note that the crystallographic groups were found mathematically for
        <m>{\mathbb R}^3</m> before the 230 different types of crystals were actually discovered in nature.
      </p>
    </subsection>

  </section>

    <reading-questions>

    <exercise>
      <statement>
        <p>
          What is a nonsingular matrix? Give an example of a <m>2 \times 2</m> nonsingular matrix. How do you know your example is nonsingular?
        </p>
      </statement>
      <response/>
    </exercise>

    <exercise>
      <statement>
        <p>
          What is an isometry in <m>\mathbb R^n</m>? Can you give an example of an isometry in <m>\mathbb R^2</m>?
        </p>
      </statement>
      <response/>
    </exercise>

    <exercise>
      <statement>
        <p>
          What is an orthonormal set of vectors?
        </p>
      </statement>
      <response/>
    </exercise>

    <exercise>
      <statement>
        <p>
          What is the difference between the orthogonal group and the special orthogonal group?
        </p>
      </statement>
      <response/>
    </exercise>

    <exercise>
      <statement>
        <p>
          What is a lattice?
        </p>
      </statement>
      <response/>
    </exercise>

  </reading-questions>
    <!-- Exercises with Solutions  -->
    <!-- File: matrix.xml  -->
    <!-- Title: Matrix Groups and Symmetry -->
  <exercises xml:id="matrix-exercises" filenamebase="matrix">
    <title>Exercises</title>

    <exercise number="1" xml:id="matrix-exercise-identity">
      <statement>
        <p>
          Prove the identity
          <me>
            \langle {\mathbf x}, {\mathbf y} \rangle = \frac{1}{2} \left[ \|{\mathbf x} + {\mathbf y}\|^2 - \|{\mathbf x}\|^2 - \| {\mathbf y}\|^2 \right]
          </me>.
        </p>
      </statement>
      <hint>
        <p>
          <md>
            <mrow>\frac{1}{2} \left[ \|{\mathbf x} + {\mathbf y}\|^2 + \|{\mathbf x}\|^2 - \| {\mathbf y}\|^2 \right] &amp; = \frac{1}{2} \left[ \langle x + y, x + y \rangle - \|{\mathbf x}\|^2 - \| {\mathbf y}\|^2 \right]</mrow>
            <mrow>&amp; = \frac{1}{2} \left[ \| {\mathbf x}\|^2 + 2 \langle x, y \rangle + \| {\mathbf y}\|^2 - \|{\mathbf x}\|^2 - \| {\mathbf y}\|^2 \right]</mrow>
            <mrow>&amp; = \langle {\mathbf x}, {\mathbf y} \rangle</mrow>
          </md>.
        </p>
      </hint>
    </exercise>

    <exercise number="2" xml:id="matrix-exercise-On">
      <statement>
        <p>
          Show that <m>O(n)</m> is a group.
        </p>
      </statement>
    </exercise>

    <exercise number="3" xml:id="matrix-exercise-orthogonal">
      <statement>
        <p>
          Prove that the following matrices are orthogonal.
          Are any of these matrices in <m>SO(n)</m>?

          <ol cols="2">
            <li>
              <p>
                <me>
                  \begin{pmatrix}
                  1/\sqrt{2} &amp; -1/\sqrt{2} \\
                  1/\sqrt{2} &amp; 1/\sqrt{2}
                  \end{pmatrix}
                </me>
              </p>
            </li>

            <li>
              <p>
                <me>
                  \begin{pmatrix}
                  1 / \sqrt{5} &amp; 2 / \sqrt{5} \\
                  - 2 /\sqrt{5} &amp; 1/ \sqrt{5}
                  \end{pmatrix}
                </me>
              </p>
            </li>

            <li>
              <p>
                <me>
                  \begin{pmatrix}
                  4/5 &amp; 0 &amp; 3 /5 \\
                  -3 /5 &amp; 0 &amp; 4 /5 \\
                  0 &amp; -1 &amp; 0
                  \end{pmatrix}
                </me>
              </p>
            </li>

            <li>
              <p>
                <me>
                  \begin{pmatrix}
                  1/3 &amp; 2/3 &amp; - 2/3 \\
                  - 2/3 &amp; 2/3 &amp; 1/3 \\
                  2/3 &amp; 1/3 &amp; 2/3
                  \end{pmatrix}
                </me>
              </p>
            </li>
          </ol>
        </p>
      </statement>
      <hint>
        <p>
          (a) is in <m>SO(2)</m>; (c) is not in <m>O(3)</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="4" xml:id="matrix-exercise-symmetry-figure">
      <statement>
        <p>
          Determine the symmetry group of each of the figures below. <!--<xref ref="matrix-figure-exercise-symmetry-groups"/>.-->
        </p>

<!--
        <figure xml:id="matrix-figure-exercise-symmetry-groups">
          <caption/>
          <image xml:id="exercise-symmetry-groups">
            <description>There are two figures in the top row and one figure on bottom.  The top left figure, a,  is a rectangle.  Inside the rectangle is an oval in the lower left and a solid circle in the upper right.  The top right figure, c, is there intersecting circles of the same radii.  The bottom middle figure, b, is a large square with the two diagonals.  The midpoints of the large square are the vertices of a smaller inscribed square.</description>
            <latex-image>
                <xi:include href="tikz/exercise-symmetry-groups.tex" parse="text"/>
            </latex-image>
          </image>
        </figure>
-->

          <image xml:id="exercise-symmetry-groups">
            <description>There are two figures in the top row and one figure on bottom.  The top left figure, a,  is a rectangle.  Inside the rectangle is an oval in the lower left and a solid circle in the upper right.  The top right figure, c, is there intersecting circles of the same radii.  The bottom middle figure, b, is a large square with the two diagonals.  The midpoints of the large square are the vertices of a smaller inscribed square.</description>
            <latex-image>
                <xi:include href="tikz/exercise-symmetry-groups.tex" parse="text"/>
            </latex-image>
          </image>
      </statement>
    </exercise>

    <exercise number="5" xml:id="matrix-exercise-inner-product">
      <statement>
        <p>
          Let <m>{\mathbf x}</m>, <m>{\mathbf y}</m>,
          and <m>{\mathbf w}</m> be vectors in
          <m>{\mathbb R}^n</m> and <m>\alpha \in {\mathbb R}</m>.
          Prove each of the following properties of inner products.

          <ol>
            <li>
              <p>
                <m>\langle {\mathbf x}, {\mathbf y} \rangle = \langle {\mathbf y}, {\mathbf x} \rangle</m>.
              </p>
            </li>

            <li>
              <p>
                <m>\langle {\mathbf x}, {\mathbf y} + {\mathbf w} \rangle = \langle {\mathbf x}, {\mathbf y} \rangle + \langle {\mathbf x}, {\mathbf w} \rangle</m>.
              </p>
            </li>

            <li>
              <p>
                <m>\langle \alpha {\mathbf x}, {\mathbf y} \rangle = \langle {\mathbf x}, \alpha {\mathbf y} \rangle = \alpha \langle {\mathbf x}, {\mathbf y} \rangle</m>.
              </p>
            </li>

            <li>
              <p>
                <m>\langle {\mathbf x}, {\mathbf x} \rangle \geq 0</m> with equality exactly when <m>{\mathbf x} = 0</m>.
              </p>
            </li>

            <li>
              <p>
                If <m>\langle {\mathbf x}, {\mathbf y} \rangle = 0</m> for all
                <m>{\mathbf x}</m> in <m>{\mathbb R}^n</m>,
                then <m>{\mathbf y} = 0</m>.
              </p>
            </li>
          </ol>
        </p>
      </statement>
      <hint>
        <p>
          (a) <m>\langle {\mathbf x}, {\mathbf y} \rangle = \langle {\mathbf y}, {\mathbf x} \rangle</m>.
        </p>
      </hint>
    </exercise>

    <exercise number="6" xml:id="matrix-exercise-en-group">
      <statement>
        <p>
          Verify that
          <me>
            E(n) = \{(A, {\mathbf x}) : A \in O(n) \text{ and } {\mathbf x} \in {\mathbb R}^n \}
          </me>
          is a group.
        </p>
      </statement>
    </exercise>

    <!--Todo Expand this solution.-->

    <exercise number="7" xml:id="matrix-exercise-bases-lattice">
      <statement>
        <p>
          Prove that <m>\{ (2,1), (1,1) \}</m> and
          <m>\{ ( 12, 5), ( 7, 3) \}</m> are bases for the same lattice.
        </p>
      </statement>
      <hint>
        <p>
          Use the unimodular matrix
          <me>
            \begin{pmatrix}
            5 &amp; 2 \\
            2 &amp; 1
            \end{pmatrix}
          </me>.
        </p>
      </hint>
    </exercise>

    <exercise number="8" xml:id="matrix-exercise-E-2">
      <statement>
        <p>
          Let <m>G</m> be a subgroup of <m>E(2)</m> and suppose that <m>T</m> is the translation subgroup of <m>G</m>.
          Prove that the point group of <m>G</m> is isomorphic to <m>G/T</m>.
        </p>
      </statement>
    </exercise>

    <!--Todo Expand this solution.-->

    <exercise number="9" xml:id="matrix-exercise-SL2-R">
      <statement>
        <p>
          Let <m>A \in SL_2({\mathbb R})</m> and suppose that the vectors <m>{\mathbf x}</m> and
          <m>{\mathbf y}</m> form two sides of a parallelogram in <m>{\mathbb R}^2</m>.
          Prove that the area of this parallelogram is the same as the area of the parallelogram with sides
          <m>A{\mathbf x}</m> and <m>A{\mathbf y}</m>.
        </p>
      </statement>
    </exercise>

    <!--Todo Expand this solution.-->

    <exercise number="10" xml:id="matrix-exercise-SO-n">
      <statement>
        <p>
          Prove that <m>SO(n)</m> is a normal subgroup of <m>O(n)</m>.
        </p>
      </statement>
      <hint>
        <p>
          Show that the kernel of the map <m>\det : O(n) \rightarrow {\mathbb R}^*</m> is <m>SO(n)</m>.
        </p>
      </hint>
    </exercise>

    <!--Todo Expand this solution.-->

    <exercise number="11" xml:id="matrix-exercise-isometry">
      <statement>
        <p>
          Show that any isometry <m>f</m> in <m>{\mathbb R}^n</m> is a one-to-one map.
        </p>
      </statement>
    </exercise>

    <exercise number="12" xml:id="matrix-exercise-A-x">
      <statement>
        <p>
          Prove or disprove:
          an element in <m>E(2)</m> of the form <m>(A, {\mathbf x})</m>,
          where <m>{\mathbf x} \neq 0</m>, has infinite order.
        </p>
      </statement>
    </exercise>

    <!--Todo Expand this solution. Complete the PMI part.-->

    <exercise number="13" xml:id="matrix-exercise-O-n-abelian-subgroup">
      <statement>
        <p>
          Prove or disprove: There exists an infinite abelian subgroup of <m>O(n)</m>.
        </p>
      </statement>
      <hint>
        <p>
          True.
        </p>
      </hint>
    </exercise>

    <!--Todo Expand this solution. Find the example.-->

    <exercise number="14" xml:id="matrix-exercise-unit-circle">
      <statement>
        <p>
          Let <m>{\mathbf x} = (x_1, x_2)</m> be a point on the unit circle in <m>{\mathbb R}^2</m>;
          that is, <m>x_1^2 + x_2^2 = 1</m>.
          If <m>A \in O(2)</m>, show that
          <m>A {\mathbf x}</m> is also a point on the unit circle.
        </p>
      </statement>
    </exercise>

    <exercise number="15" xml:id="matrix-exercise-semi-direct-product">
      <statement>
        <p>
          Let <m>G</m> be a group with a subgroup <m>H</m>
          (not necessarily normal)
          and a normal subgroup <m>N</m>.
          Then <m>G</m> is a <term>semidirect product</term>
          of <m>N</m> by <m>H</m> if

          <ul>
            <li>
              <p>
                <m>H \cap N = \{ \identity \}</m>;
              </p>
            </li>

            <li>
              <p>
                <m>HN=G</m>.
              </p>
            </li>
          </ul>

          Show that each of the following is true.

          <ol>
            <li>
              <p>
                <m>S_3</m> is the semidirect product of <m>A_3</m> by <m>H = \{(1), (1 \,2) \}</m>.
              </p>
            </li>

            <li>
              <p>
                The quaternion group, <m>Q_8</m>,
                cannot be written as a semidirect product.
              </p>
            </li>

            <li>
              <p>
                <m>E(2)</m> is the semidirect product of <m>O(2)</m> by <m>H</m>,
                where <m>H</m> consists of all translations in <m>{\mathbb R}^2</m>.
              </p>
            </li>
          </ol>
        </p>
      </statement>
    </exercise>

    <!--Todo Expand solution.-->

    <exercise number="16" xml:id="matrix-exercise-17-wallpaper-1">
      <statement>
        <p>
          Determine which of the 17 wallpaper groups preserves the symmetry of the pattern in <xref ref="matrix-figure-wallpaper"/>.
        </p>
      </statement>
    </exercise>

    <exercise number="17" xml:id="matrix-exercise-17-wallpaper-2">
      <statement>
        <p>
          Determine which of the 17 wallpaper groups preserves the symmetry of the pattern in <xref ref="matrix-figure-exercise-wallpaper"/>.
        </p>
      </statement>
      <hint>
        <p>
          <m>p6m</m>
        </p>
      </hint>
    </exercise>

    <figure xml:id="matrix-figure-exercise-wallpaper">
      <caption>Lattice for <xref ref="matrix-exercise-17-wallpaper-2"/></caption>
            <!-- Replaced figure with tikz figure - TWJ 5/6/2010 -->
      <image xml:id="exercise-wallpaper">
            <description>A lattices of hexagons.  Each hexagon is divided into three rhombuses.</description>
            <latex-image>
                <xi:include href="tikz/exercise-wallpaper.tex" parse="text"/>
            </latex-image>
      </image>

    </figure>

    <exercise number="18" xml:id="matrix-exercise-dodecahedron">
      <statement>
        <p>
          Find the rotation group of a dodecahedron.
        </p>
      </statement>
    </exercise>

    <!--Todo Elaborate on this solution.-->

    <exercise number="19" xml:id="matrix-exercise-17-wallpaper-symmetry">
      <statement>
        <p>
          For each of the 17 wallpaper groups,
          draw a wallpaper pattern having that group as a symmetry group.
        </p>
      </statement>
    </exercise>

    <!--Todo Provide a figure for each of the 17 wallpaper groups.-->
  </exercises>

  <references xml:id="matrix-references">
    <title>References and Suggested Readings</title>
        <!-- %References checked <ndash /> TWJ 6/14/2010 -->
    <biblio type="raw">
<!-- was [1] -->
      Coxeter, H. M. and Moser, W. O. J.
      <title>Generators and Relations for Discrete Groups</title>, 3rd ed. Springer-Verlag, New York, 1972.
    </biblio>

    <biblio type="raw">
<!-- was [2] -->
      Grove, L. C. and Benson, C. T.
      <title>Finite Reflection Groups</title>. 2nd ed. Springer-Verlag, New York, 1985.
    </biblio>

    <biblio type="raw">
<!-- was [3] -->
      Hiller, H. <q>Crystallography and Cohomology of Groups,</q>
      <title>American Mathematical Monthly</title>
      <volume>93</volume>
      (1986), 765<ndash/>79.
    </biblio>

    <biblio type="raw">
<!-- was [4] -->
      Lockwood, E. H. and Macmillan, R. H.
      <title>Geometric Symmetry</title>. Cambridge University Press, Cambridge, 1978.
    </biblio>

    <biblio type="raw">
<!-- was [5] -->
      Mackiw, G.
      <title>Applications of Abstract Algebra</title>. Wiley, New York, 1985.
    </biblio>

    <biblio type="raw">
<!-- was [6] -->
      Martin,  G.
      <title>Transformation  Groups:  An Introduction to Symmetry</title>.  Springer-Verlag, New York, 1982.
    </biblio>

    <biblio type="raw">
<!-- was [7] -->
      Milnor, J. <q>Hilbert's Problem 18: On Crystallographic Groups, Fundamental Domains, and Sphere Packing,</q>
      <title>t Proceedings of Symposia in Pure Mathematics</title>
      <volume>18</volume>, American Mathematical Society, 1976.
    </biblio>

    <biblio type="raw">
<!-- was [8] -->
      Phillips, F. C.
      <title>An Introduction to Crystallography</title>. 4th ed. Wiley, New York, 1971.
    </biblio>

    <biblio type="raw">
<!-- was [9] -->
      Rose, B. I. and Stafford, R. D. <q>An Elementary Course in Mathematical Symmetry,</q>
      <title>American Mathematical Monthly</title>
      <volume>88</volume>
      (1980), 54<ndash/>64.
    </biblio>

    <biblio type="raw">
<!-- was [10] -->
      Schattschneider, D. <q>The Plane Symmetry Groups: Their Recognition and Their Notation,</q>
      <title>American Mathematical  Monthly</title>
      <volume>85</volume>
      (1978), 439<ndash/>50.
    </biblio>

    <biblio type="raw">
<!-- was [11] -->
      Schwarzenberger, R. L. <q>The 17 Plane Symmetry Groups,</q>
      <title>Mathematical Gazette</title>
      <volume>58</volume>
      (1974), 123<ndash/>31.
    </biblio>

    <biblio type="raw">
<!-- was [12] -->
      Weyl, H.
      <title>Symmetry</title>. Princeton University Press, Princeton, NJ, 1952.
    </biblio>
  </references>



  <section xml:id="matrix-sage" component="sage-info">
    <title>Sage</title>
    <p>
      There is no Sage material for this chapter.
    </p>
  </section>

  <exercises xml:id="matrix-sage-exercises" component="sage-exercises">
    <title>Sage Exercises</title>
    <introduction>
      <p>
        There are no Sage exercises for this chapter.
      </p>
    </introduction>

  </exercises>
</chapter>
